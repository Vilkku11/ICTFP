function f1(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var DR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Mm={exports:{}},rl={},Im={exports:{}},$={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ys=Symbol.for("react.element"),h1=Symbol.for("react.portal"),d1=Symbol.for("react.fragment"),g1=Symbol.for("react.strict_mode"),p1=Symbol.for("react.profiler"),m1=Symbol.for("react.provider"),_1=Symbol.for("react.context"),v1=Symbol.for("react.forward_ref"),y1=Symbol.for("react.suspense"),E1=Symbol.for("react.memo"),w1=Symbol.for("react.lazy"),id=Symbol.iterator;function T1(t){return t===null||typeof t!="object"?null:(t=id&&t[id]||t["@@iterator"],typeof t=="function"?t:null)}var Rm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Om=Object.assign,km={};function xi(t,e,n){this.props=t,this.context=e,this.refs=km,this.updater=n||Rm}xi.prototype.isReactComponent={};xi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};xi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Nm(){}Nm.prototype=xi.prototype;function af(t,e,n){this.props=t,this.context=e,this.refs=km,this.updater=n||Rm}var lf=af.prototype=new Nm;lf.constructor=af;Om(lf,xi.prototype);lf.isPureReactComponent=!0;var sd=Array.isArray,Fm=Object.prototype.hasOwnProperty,uf={current:null},Dm={key:!0,ref:!0,__self:!0,__source:!0};function Bm(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Fm.call(e,r)&&!Dm.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Ys,type:t,key:s,ref:o,props:i,_owner:uf.current}}function b1(t,e){return{$$typeof:Ys,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ys}function S1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var od=/\/+/g;function Nl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?S1(""+t.key):e.toString(36)}function qo(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Ys:case h1:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Nl(o,0):r,sd(i)?(n="",t!=null&&(n=t.replace(od,"$&/")+"/"),qo(i,e,n,"",function(u){return u})):i!=null&&(cf(i)&&(i=b1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(od,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",sd(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Nl(s,a);o+=qo(s,e,n,l,i)}else if(l=T1(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Nl(s,a++),o+=qo(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yo(t,e,n){if(t==null)return t;var r=[],i=0;return qo(t,r,"","",function(s){return e.call(n,s,i++)}),r}function x1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ge={current:null},Zo={transition:null},A1={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:Zo,ReactCurrentOwner:uf};$.Children={map:yo,forEach:function(t,e,n){yo(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return yo(t,function(){e++}),e},toArray:function(t){return yo(t,function(e){return e})||[]},only:function(t){if(!cf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$.Component=xi;$.Fragment=d1;$.Profiler=p1;$.PureComponent=af;$.StrictMode=g1;$.Suspense=y1;$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A1;$.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Om({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=uf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Fm.call(e,l)&&!Dm.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Ys,type:t.type,key:i,ref:s,props:r,_owner:o}};$.createContext=function(t){return t={$$typeof:_1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:m1,_context:t},t.Consumer=t};$.createElement=Bm;$.createFactory=function(t){var e=Bm.bind(null,t);return e.type=t,e};$.createRef=function(){return{current:null}};$.forwardRef=function(t){return{$$typeof:v1,render:t}};$.isValidElement=cf;$.lazy=function(t){return{$$typeof:w1,_payload:{_status:-1,_result:t},_init:x1}};$.memo=function(t,e){return{$$typeof:E1,type:t,compare:e===void 0?null:e}};$.startTransition=function(t){var e=Zo.transition;Zo.transition={};try{t()}finally{Zo.transition=e}};$.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};$.useCallback=function(t,e){return Ge.current.useCallback(t,e)};$.useContext=function(t){return Ge.current.useContext(t)};$.useDebugValue=function(){};$.useDeferredValue=function(t){return Ge.current.useDeferredValue(t)};$.useEffect=function(t,e){return Ge.current.useEffect(t,e)};$.useId=function(){return Ge.current.useId()};$.useImperativeHandle=function(t,e,n){return Ge.current.useImperativeHandle(t,e,n)};$.useInsertionEffect=function(t,e){return Ge.current.useInsertionEffect(t,e)};$.useLayoutEffect=function(t,e){return Ge.current.useLayoutEffect(t,e)};$.useMemo=function(t,e){return Ge.current.useMemo(t,e)};$.useReducer=function(t,e,n){return Ge.current.useReducer(t,e,n)};$.useRef=function(t){return Ge.current.useRef(t)};$.useState=function(t){return Ge.current.useState(t)};$.useSyncExternalStore=function(t,e,n){return Ge.current.useSyncExternalStore(t,e,n)};$.useTransition=function(){return Ge.current.useTransition()};$.version="18.2.0";Im.exports=$;var N=Im.exports;const ff=Lm(N);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1=N,C1=Symbol.for("react.element"),L1=Symbol.for("react.fragment"),M1=Object.prototype.hasOwnProperty,I1=P1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R1={key:!0,ref:!0,__self:!0,__source:!0};function Um(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)M1.call(e,r)&&!R1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:C1,type:t,key:s,ref:o,props:i,_owner:I1.current}}rl.Fragment=L1;rl.jsx=Um;rl.jsxs=Um;Mm.exports=rl;var z=Mm.exports,zu={},zm={exports:{}},ut={},jm={exports:{}},Vm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,V){var W=D.length;D.push(V);e:for(;0<W;){var ue=W-1>>>1,oe=D[ue];if(0<i(oe,V))D[ue]=V,D[W]=oe,W=ue;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var V=D[0],W=D.pop();if(W!==V){D[0]=W;e:for(var ue=0,oe=D.length,Pr=oe>>>1;ue<Pr;){var bt=2*(ue+1)-1,Ii=D[bt],Zt=bt+1,me=D[Zt];if(0>i(Ii,W))Zt<oe&&0>i(me,Ii)?(D[ue]=me,D[Zt]=W,ue=Zt):(D[ue]=Ii,D[bt]=W,ue=bt);else if(Zt<oe&&0>i(me,W))D[ue]=me,D[Zt]=W,ue=Zt;else break e}}return V}function i(D,V){var W=D.sortIndex-V.sortIndex;return W!==0?W:D.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,f=null,h=3,m=!1,E=!1,w=!1,S=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(D){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=D)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(u)}}function b(D){if(w=!1,v(D),!E)if(n(l)!==null)E=!0,Mi(x);else{var V=n(u);V!==null&&Ar(b,V.startTime-D)}}function x(D,V){E=!1,w&&(w=!1,_(M),M=-1),m=!0;var W=h;try{for(v(V),f=n(l);f!==null&&(!(f.expirationTime>V)||D&&!U());){var ue=f.callback;if(typeof ue=="function"){f.callback=null,h=f.priorityLevel;var oe=ue(f.expirationTime<=V);V=t.unstable_now(),typeof oe=="function"?f.callback=oe:f===n(l)&&r(l),v(V)}else r(l);f=n(l)}if(f!==null)var Pr=!0;else{var bt=n(u);bt!==null&&Ar(b,bt.startTime-V),Pr=!1}return Pr}finally{f=null,h=W,m=!1}}var P=!1,L=null,M=-1,C=5,O=-1;function U(){return!(t.unstable_now()-O<C)}function H(){if(L!==null){var D=t.unstable_now();O=D;var V=!0;try{V=L(!0,D)}finally{V?G():(P=!1,L=null)}}else P=!1}var G;if(typeof p=="function")G=function(){p(H)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,Tt=q.port2;q.port1.onmessage=H,G=function(){Tt.postMessage(null)}}else G=function(){S(H,0)};function Mi(D){L=D,P||(P=!0,G())}function Ar(D,V){M=S(function(){D(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){E||m||(E=!0,Mi(x))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(D){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var W=h;h=V;try{return D()}finally{h=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,V){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var W=h;h=D;try{return V()}finally{h=W}},t.unstable_scheduleCallback=function(D,V,W){var ue=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ue+W:ue):W=ue,D){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=W+oe,D={id:c++,callback:V,priorityLevel:D,startTime:W,expirationTime:oe,sortIndex:-1},W>ue?(D.sortIndex=W,e(u,D),n(l)===null&&D===n(u)&&(w?(_(M),M=-1):w=!0,Ar(b,W-ue))):(D.sortIndex=oe,e(l,D),E||m||(E=!0,Mi(x))),D},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(D){var V=h;return function(){var W=h;h=V;try{return D.apply(this,arguments)}finally{h=W}}}})(Vm);jm.exports=Vm;var O1=jm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gm=N,at=O1;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hm=new Set,ys={};function Er(t,e){ui(t,e),ui(t+"Capture",e)}function ui(t,e){for(ys[t]=e,t=0;t<e.length;t++)Hm.add(e[t])}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ju=Object.prototype.hasOwnProperty,k1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ad={},ld={};function N1(t){return ju.call(ld,t)?!0:ju.call(ad,t)?!1:k1.test(t)?ld[t]=!0:(ad[t]=!0,!1)}function F1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function D1(t,e,n,r){if(e===null||typeof e>"u"||F1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function He(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ie={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ie[t]=new He(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ie[e]=new He(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ie[t]=new He(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ie[t]=new He(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ie[t]=new He(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ie[t]=new He(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ie[t]=new He(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ie[t]=new He(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ie[t]=new He(t,5,!1,t.toLowerCase(),null,!1,!1)});var hf=/[\-:]([a-z])/g;function df(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(hf,df);Ie[e]=new He(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(hf,df);Ie[e]=new He(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(hf,df);Ie[e]=new He(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ie[t]=new He(t,1,!1,t.toLowerCase(),null,!1,!1)});Ie.xlinkHref=new He("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ie[t]=new He(t,1,!1,t.toLowerCase(),null,!0,!0)});function gf(t,e,n,r){var i=Ie.hasOwnProperty(e)?Ie[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(D1(e,n,i,r)&&(n=null),r||i===null?N1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var mn=Gm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Eo=Symbol.for("react.element"),Ur=Symbol.for("react.portal"),zr=Symbol.for("react.fragment"),pf=Symbol.for("react.strict_mode"),Vu=Symbol.for("react.profiler"),Wm=Symbol.for("react.provider"),Ym=Symbol.for("react.context"),mf=Symbol.for("react.forward_ref"),Gu=Symbol.for("react.suspense"),Hu=Symbol.for("react.suspense_list"),_f=Symbol.for("react.memo"),An=Symbol.for("react.lazy"),Xm=Symbol.for("react.offscreen"),ud=Symbol.iterator;function Ui(t){return t===null||typeof t!="object"?null:(t=ud&&t[ud]||t["@@iterator"],typeof t=="function"?t:null)}var he=Object.assign,Fl;function es(t){if(Fl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Fl=e&&e[1]||""}return`
`+Fl+t}var Dl=!1;function Bl(t,e){if(!t||Dl)return"";Dl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Dl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?es(t):""}function B1(t){switch(t.tag){case 5:return es(t.type);case 16:return es("Lazy");case 13:return es("Suspense");case 19:return es("SuspenseList");case 0:case 2:case 15:return t=Bl(t.type,!1),t;case 11:return t=Bl(t.type.render,!1),t;case 1:return t=Bl(t.type,!0),t;default:return""}}function Wu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zr:return"Fragment";case Ur:return"Portal";case Vu:return"Profiler";case pf:return"StrictMode";case Gu:return"Suspense";case Hu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ym:return(t.displayName||"Context")+".Consumer";case Wm:return(t._context.displayName||"Context")+".Provider";case mf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _f:return e=t.displayName||null,e!==null?e:Wu(t.type)||"Memo";case An:e=t._payload,t=t._init;try{return Wu(t(e))}catch{}}return null}function U1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wu(e);case 8:return e===pf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function $m(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function z1(t){var e=$m(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wo(t){t._valueTracker||(t._valueTracker=z1(t))}function qm(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=$m(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function pa(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yu(t,e){var n=e.checked;return he({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function cd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Hn(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zm(t,e){e=e.checked,e!=null&&gf(t,"checked",e,!1)}function Xu(t,e){Zm(t,e);var n=Hn(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?$u(t,e.type,n):e.hasOwnProperty("defaultValue")&&$u(t,e.type,Hn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function fd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function $u(t,e,n){(e!=="number"||pa(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ts=Array.isArray;function Jr(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Hn(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function qu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return he({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function hd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(R(92));if(ts(n)){if(1<n.length)throw Error(R(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Hn(n)}}function Km(t,e){var n=Hn(e.value),r=Hn(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function dd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Qm(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Qm(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var To,Jm=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(To=To||document.createElement("div"),To.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=To.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Es(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var os={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},j1=["Webkit","ms","Moz","O"];Object.keys(os).forEach(function(t){j1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),os[e]=os[t]})});function e0(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||os.hasOwnProperty(t)&&os[t]?(""+e).trim():e+"px"}function t0(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=e0(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var V1=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ku(t,e){if(e){if(V1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Qu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ju=null;function vf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ec=null,ei=null,ti=null;function gd(t){if(t=qs(t)){if(typeof ec!="function")throw Error(R(280));var e=t.stateNode;e&&(e=ll(e),ec(t.stateNode,t.type,e))}}function n0(t){ei?ti?ti.push(t):ti=[t]:ei=t}function r0(){if(ei){var t=ei,e=ti;if(ti=ei=null,gd(t),e)for(t=0;t<e.length;t++)gd(e[t])}}function i0(t,e){return t(e)}function s0(){}var Ul=!1;function o0(t,e,n){if(Ul)return t(e,n);Ul=!0;try{return i0(t,e,n)}finally{Ul=!1,(ei!==null||ti!==null)&&(s0(),r0())}}function ws(t,e){var n=t.stateNode;if(n===null)return null;var r=ll(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(R(231,e,typeof n));return n}var tc=!1;if(un)try{var zi={};Object.defineProperty(zi,"passive",{get:function(){tc=!0}}),window.addEventListener("test",zi,zi),window.removeEventListener("test",zi,zi)}catch{tc=!1}function G1(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var as=!1,ma=null,_a=!1,nc=null,H1={onError:function(t){as=!0,ma=t}};function W1(t,e,n,r,i,s,o,a,l){as=!1,ma=null,G1.apply(H1,arguments)}function Y1(t,e,n,r,i,s,o,a,l){if(W1.apply(this,arguments),as){if(as){var u=ma;as=!1,ma=null}else throw Error(R(198));_a||(_a=!0,nc=u)}}function wr(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function a0(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function pd(t){if(wr(t)!==t)throw Error(R(188))}function X1(t){var e=t.alternate;if(!e){if(e=wr(t),e===null)throw Error(R(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return pd(i),t;if(s===r)return pd(i),e;s=s.sibling}throw Error(R(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(n.alternate!==r)throw Error(R(190))}if(n.tag!==3)throw Error(R(188));return n.stateNode.current===n?t:e}function l0(t){return t=X1(t),t!==null?u0(t):null}function u0(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=u0(t);if(e!==null)return e;t=t.sibling}return null}var c0=at.unstable_scheduleCallback,md=at.unstable_cancelCallback,$1=at.unstable_shouldYield,q1=at.unstable_requestPaint,pe=at.unstable_now,Z1=at.unstable_getCurrentPriorityLevel,yf=at.unstable_ImmediatePriority,f0=at.unstable_UserBlockingPriority,va=at.unstable_NormalPriority,K1=at.unstable_LowPriority,h0=at.unstable_IdlePriority,il=null,Yt=null;function Q1(t){if(Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(il,t,void 0,(t.current.flags&128)===128)}catch{}}var Mt=Math.clz32?Math.clz32:tE,J1=Math.log,eE=Math.LN2;function tE(t){return t>>>=0,t===0?32:31-(J1(t)/eE|0)|0}var bo=64,So=4194304;function ns(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ya(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ns(a):(s&=o,s!==0&&(r=ns(s)))}else o=n&~i,o!==0?r=ns(o):s!==0&&(r=ns(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mt(e),i=1<<n,r|=t[n],e&=~i;return r}function nE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Mt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=nE(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function rc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function d0(){var t=bo;return bo<<=1,!(bo&4194240)&&(bo=64),t}function zl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Xs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mt(e),t[e]=n}function iE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Mt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Ef(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var J=0;function g0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var p0,wf,m0,_0,v0,ic=!1,xo=[],kn=null,Nn=null,Fn=null,Ts=new Map,bs=new Map,Cn=[],sE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _d(t,e){switch(t){case"focusin":case"focusout":kn=null;break;case"dragenter":case"dragleave":Nn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Ts.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bs.delete(e.pointerId)}}function ji(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=qs(e),e!==null&&wf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function oE(t,e,n,r,i){switch(e){case"focusin":return kn=ji(kn,t,e,n,r,i),!0;case"dragenter":return Nn=ji(Nn,t,e,n,r,i),!0;case"mouseover":return Fn=ji(Fn,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ts.set(s,ji(Ts.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,bs.set(s,ji(bs.get(s)||null,t,e,n,r,i)),!0}return!1}function y0(t){var e=sr(t.target);if(e!==null){var n=wr(e);if(n!==null){if(e=n.tag,e===13){if(e=a0(n),e!==null){t.blockedOn=e,v0(t.priority,function(){m0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ko(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ju=r,n.target.dispatchEvent(r),Ju=null}else return e=qs(n),e!==null&&wf(e),t.blockedOn=n,!1;e.shift()}return!0}function vd(t,e,n){Ko(t)&&n.delete(e)}function aE(){ic=!1,kn!==null&&Ko(kn)&&(kn=null),Nn!==null&&Ko(Nn)&&(Nn=null),Fn!==null&&Ko(Fn)&&(Fn=null),Ts.forEach(vd),bs.forEach(vd)}function Vi(t,e){t.blockedOn===e&&(t.blockedOn=null,ic||(ic=!0,at.unstable_scheduleCallback(at.unstable_NormalPriority,aE)))}function Ss(t){function e(i){return Vi(i,t)}if(0<xo.length){Vi(xo[0],t);for(var n=1;n<xo.length;n++){var r=xo[n];r.blockedOn===t&&(r.blockedOn=null)}}for(kn!==null&&Vi(kn,t),Nn!==null&&Vi(Nn,t),Fn!==null&&Vi(Fn,t),Ts.forEach(e),bs.forEach(e),n=0;n<Cn.length;n++)r=Cn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Cn.length&&(n=Cn[0],n.blockedOn===null);)y0(n),n.blockedOn===null&&Cn.shift()}var ni=mn.ReactCurrentBatchConfig,Ea=!0;function lE(t,e,n,r){var i=J,s=ni.transition;ni.transition=null;try{J=1,Tf(t,e,n,r)}finally{J=i,ni.transition=s}}function uE(t,e,n,r){var i=J,s=ni.transition;ni.transition=null;try{J=4,Tf(t,e,n,r)}finally{J=i,ni.transition=s}}function Tf(t,e,n,r){if(Ea){var i=sc(t,e,n,r);if(i===null)Zl(t,e,r,wa,n),_d(t,r);else if(oE(i,t,e,n,r))r.stopPropagation();else if(_d(t,r),e&4&&-1<sE.indexOf(t)){for(;i!==null;){var s=qs(i);if(s!==null&&p0(s),s=sc(t,e,n,r),s===null&&Zl(t,e,r,wa,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Zl(t,e,r,null,n)}}var wa=null;function sc(t,e,n,r){if(wa=null,t=vf(r),t=sr(t),t!==null)if(e=wr(t),e===null)t=null;else if(n=e.tag,n===13){if(t=a0(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return wa=t,null}function E0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z1()){case yf:return 1;case f0:return 4;case va:case K1:return 16;case h0:return 536870912;default:return 16}default:return 16}}var Mn=null,bf=null,Qo=null;function w0(){if(Qo)return Qo;var t,e=bf,n=e.length,r,i="value"in Mn?Mn.value:Mn.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Qo=i.slice(t,1<r?1-r:void 0)}function Jo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ao(){return!0}function yd(){return!1}function ct(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ao:yd,this.isPropagationStopped=yd,this}return he(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ao)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ao)},persist:function(){},isPersistent:Ao}),e}var Ai={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sf=ct(Ai),$s=he({},Ai,{view:0,detail:0}),cE=ct($s),jl,Vl,Gi,sl=he({},$s,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Gi&&(Gi&&t.type==="mousemove"?(jl=t.screenX-Gi.screenX,Vl=t.screenY-Gi.screenY):Vl=jl=0,Gi=t),jl)},movementY:function(t){return"movementY"in t?t.movementY:Vl}}),Ed=ct(sl),fE=he({},sl,{dataTransfer:0}),hE=ct(fE),dE=he({},$s,{relatedTarget:0}),Gl=ct(dE),gE=he({},Ai,{animationName:0,elapsedTime:0,pseudoElement:0}),pE=ct(gE),mE=he({},Ai,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_E=ct(mE),vE=he({},Ai,{data:0}),wd=ct(vE),yE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=wE[t])?!!e[t]:!1}function xf(){return TE}var bE=he({},$s,{key:function(t){if(t.key){var e=yE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Jo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?EE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xf,charCode:function(t){return t.type==="keypress"?Jo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Jo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SE=ct(bE),xE=he({},sl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=ct(xE),AE=he({},$s,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xf}),PE=ct(AE),CE=he({},Ai,{propertyName:0,elapsedTime:0,pseudoElement:0}),LE=ct(CE),ME=he({},sl,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),IE=ct(ME),RE=[9,13,27,32],Af=un&&"CompositionEvent"in window,ls=null;un&&"documentMode"in document&&(ls=document.documentMode);var OE=un&&"TextEvent"in window&&!ls,T0=un&&(!Af||ls&&8<ls&&11>=ls),bd=String.fromCharCode(32),Sd=!1;function b0(t,e){switch(t){case"keyup":return RE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function S0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jr=!1;function kE(t,e){switch(t){case"compositionend":return S0(e);case"keypress":return e.which!==32?null:(Sd=!0,bd);case"textInput":return t=e.data,t===bd&&Sd?null:t;default:return null}}function NE(t,e){if(jr)return t==="compositionend"||!Af&&b0(t,e)?(t=w0(),Qo=bf=Mn=null,jr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return T0&&e.locale!=="ko"?null:e.data;default:return null}}var FE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FE[t.type]:e==="textarea"}function x0(t,e,n,r){n0(r),e=Ta(e,"onChange"),0<e.length&&(n=new Sf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var us=null,xs=null;function DE(t){F0(t,0)}function ol(t){var e=Hr(t);if(qm(e))return t}function BE(t,e){if(t==="change")return e}var A0=!1;if(un){var Hl;if(un){var Wl="oninput"in document;if(!Wl){var Ad=document.createElement("div");Ad.setAttribute("oninput","return;"),Wl=typeof Ad.oninput=="function"}Hl=Wl}else Hl=!1;A0=Hl&&(!document.documentMode||9<document.documentMode)}function Pd(){us&&(us.detachEvent("onpropertychange",P0),xs=us=null)}function P0(t){if(t.propertyName==="value"&&ol(xs)){var e=[];x0(e,xs,t,vf(t)),o0(DE,e)}}function UE(t,e,n){t==="focusin"?(Pd(),us=e,xs=n,us.attachEvent("onpropertychange",P0)):t==="focusout"&&Pd()}function zE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ol(xs)}function jE(t,e){if(t==="click")return ol(e)}function VE(t,e){if(t==="input"||t==="change")return ol(e)}function GE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ot=typeof Object.is=="function"?Object.is:GE;function As(t,e){if(Ot(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!ju.call(e,i)||!Ot(t[i],e[i]))return!1}return!0}function Cd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ld(t,e){var n=Cd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Cd(n)}}function C0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?C0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function L0(){for(var t=window,e=pa();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=pa(t.document)}return e}function Pf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HE(t){var e=L0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&C0(n.ownerDocument.documentElement,n)){if(r!==null&&Pf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Ld(n,s);var o=Ld(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var WE=un&&"documentMode"in document&&11>=document.documentMode,Vr=null,oc=null,cs=null,ac=!1;function Md(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ac||Vr==null||Vr!==pa(r)||(r=Vr,"selectionStart"in r&&Pf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),cs&&As(cs,r)||(cs=r,r=Ta(oc,"onSelect"),0<r.length&&(e=new Sf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vr)))}function Po(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Gr={animationend:Po("Animation","AnimationEnd"),animationiteration:Po("Animation","AnimationIteration"),animationstart:Po("Animation","AnimationStart"),transitionend:Po("Transition","TransitionEnd")},Yl={},M0={};un&&(M0=document.createElement("div").style,"AnimationEvent"in window||(delete Gr.animationend.animation,delete Gr.animationiteration.animation,delete Gr.animationstart.animation),"TransitionEvent"in window||delete Gr.transitionend.transition);function al(t){if(Yl[t])return Yl[t];if(!Gr[t])return t;var e=Gr[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in M0)return Yl[t]=e[n];return t}var I0=al("animationend"),R0=al("animationiteration"),O0=al("animationstart"),k0=al("transitionend"),N0=new Map,Id="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xn(t,e){N0.set(t,e),Er(e,[t])}for(var Xl=0;Xl<Id.length;Xl++){var $l=Id[Xl],YE=$l.toLowerCase(),XE=$l[0].toUpperCase()+$l.slice(1);Xn(YE,"on"+XE)}Xn(I0,"onAnimationEnd");Xn(R0,"onAnimationIteration");Xn(O0,"onAnimationStart");Xn("dblclick","onDoubleClick");Xn("focusin","onFocus");Xn("focusout","onBlur");Xn(k0,"onTransitionEnd");ui("onMouseEnter",["mouseout","mouseover"]);ui("onMouseLeave",["mouseout","mouseover"]);ui("onPointerEnter",["pointerout","pointerover"]);ui("onPointerLeave",["pointerout","pointerover"]);Er("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Er("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Er("onBeforeInput",["compositionend","keypress","textInput","paste"]);Er("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Er("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Er("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$E=new Set("cancel close invalid load scroll toggle".split(" ").concat(rs));function Rd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Y1(r,e,void 0,t),t.currentTarget=null}function F0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Rd(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Rd(i,a,u),s=l}}}if(_a)throw t=nc,_a=!1,nc=null,t}function ie(t,e){var n=e[hc];n===void 0&&(n=e[hc]=new Set);var r=t+"__bubble";n.has(r)||(D0(e,t,2,!1),n.add(r))}function ql(t,e,n){var r=0;e&&(r|=4),D0(n,t,r,e)}var Co="_reactListening"+Math.random().toString(36).slice(2);function Ps(t){if(!t[Co]){t[Co]=!0,Hm.forEach(function(n){n!=="selectionchange"&&($E.has(n)||ql(n,!1,t),ql(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Co]||(e[Co]=!0,ql("selectionchange",!1,e))}}function D0(t,e,n,r){switch(E0(e)){case 1:var i=lE;break;case 4:i=uE;break;default:i=Tf}n=i.bind(null,e,n,t),i=void 0,!tc||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Zl(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=sr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}o0(function(){var u=s,c=vf(n),f=[];e:{var h=N0.get(t);if(h!==void 0){var m=Sf,E=t;switch(t){case"keypress":if(Jo(n)===0)break e;case"keydown":case"keyup":m=SE;break;case"focusin":E="focus",m=Gl;break;case"focusout":E="blur",m=Gl;break;case"beforeblur":case"afterblur":m=Gl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Ed;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=hE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=PE;break;case I0:case R0:case O0:m=pE;break;case k0:m=LE;break;case"scroll":m=cE;break;case"wheel":m=IE;break;case"copy":case"cut":case"paste":m=_E;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Td}var w=(e&4)!==0,S=!w&&t==="scroll",_=w?h!==null?h+"Capture":null:h;w=[];for(var p=u,v;p!==null;){v=p;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,_!==null&&(b=ws(p,_),b!=null&&w.push(Cs(p,b,v)))),S)break;p=p.return}0<w.length&&(h=new m(h,E,null,n,c),f.push({event:h,listeners:w}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",h&&n!==Ju&&(E=n.relatedTarget||n.fromElement)&&(sr(E)||E[cn]))break e;if((m||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,m?(E=n.relatedTarget||n.toElement,m=u,E=E?sr(E):null,E!==null&&(S=wr(E),E!==S||E.tag!==5&&E.tag!==6)&&(E=null)):(m=null,E=u),m!==E)){if(w=Ed,b="onMouseLeave",_="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(w=Td,b="onPointerLeave",_="onPointerEnter",p="pointer"),S=m==null?h:Hr(m),v=E==null?h:Hr(E),h=new w(b,p+"leave",m,n,c),h.target=S,h.relatedTarget=v,b=null,sr(c)===u&&(w=new w(_,p+"enter",E,n,c),w.target=v,w.relatedTarget=S,b=w),S=b,m&&E)t:{for(w=m,_=E,p=0,v=w;v;v=Lr(v))p++;for(v=0,b=_;b;b=Lr(b))v++;for(;0<p-v;)w=Lr(w),p--;for(;0<v-p;)_=Lr(_),v--;for(;p--;){if(w===_||_!==null&&w===_.alternate)break t;w=Lr(w),_=Lr(_)}w=null}else w=null;m!==null&&Od(f,h,m,w,!1),E!==null&&S!==null&&Od(f,S,E,w,!0)}}e:{if(h=u?Hr(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var x=BE;else if(xd(h))if(A0)x=VE;else{x=zE;var P=UE}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=jE);if(x&&(x=x(t,u))){x0(f,x,n,c);break e}P&&P(t,h,u),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&$u(h,"number",h.value)}switch(P=u?Hr(u):window,t){case"focusin":(xd(P)||P.contentEditable==="true")&&(Vr=P,oc=u,cs=null);break;case"focusout":cs=oc=Vr=null;break;case"mousedown":ac=!0;break;case"contextmenu":case"mouseup":case"dragend":ac=!1,Md(f,n,c);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":Md(f,n,c)}var L;if(Af)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else jr?b0(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(T0&&n.locale!=="ko"&&(jr||M!=="onCompositionStart"?M==="onCompositionEnd"&&jr&&(L=w0()):(Mn=c,bf="value"in Mn?Mn.value:Mn.textContent,jr=!0)),P=Ta(u,M),0<P.length&&(M=new wd(M,t,null,n,c),f.push({event:M,listeners:P}),L?M.data=L:(L=S0(n),L!==null&&(M.data=L)))),(L=OE?kE(t,n):NE(t,n))&&(u=Ta(u,"onBeforeInput"),0<u.length&&(c=new wd("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:u}),c.data=L))}F0(f,e)})}function Cs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ta(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ws(t,n),s!=null&&r.unshift(Cs(t,s,i)),s=ws(t,e),s!=null&&r.push(Cs(t,s,i))),t=t.return}return r}function Lr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Od(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=ws(n,s),l!=null&&o.unshift(Cs(n,l,a))):i||(l=ws(n,s),l!=null&&o.push(Cs(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var qE=/\r\n?/g,ZE=/\u0000|\uFFFD/g;function kd(t){return(typeof t=="string"?t:""+t).replace(qE,`
`).replace(ZE,"")}function Lo(t,e,n){if(e=kd(e),kd(t)!==e&&n)throw Error(R(425))}function ba(){}var lc=null,uc=null;function cc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var fc=typeof setTimeout=="function"?setTimeout:void 0,KE=typeof clearTimeout=="function"?clearTimeout:void 0,Nd=typeof Promise=="function"?Promise:void 0,QE=typeof queueMicrotask=="function"?queueMicrotask:typeof Nd<"u"?function(t){return Nd.resolve(null).then(t).catch(JE)}:fc;function JE(t){setTimeout(function(){throw t})}function Kl(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ss(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ss(e)}function Dn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Fd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pi=Math.random().toString(36).slice(2),Vt="__reactFiber$"+Pi,Ls="__reactProps$"+Pi,cn="__reactContainer$"+Pi,hc="__reactEvents$"+Pi,ew="__reactListeners$"+Pi,tw="__reactHandles$"+Pi;function sr(t){var e=t[Vt];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cn]||n[Vt]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Fd(t);t!==null;){if(n=t[Vt])return n;t=Fd(t)}return e}t=n,n=t.parentNode}return null}function qs(t){return t=t[Vt]||t[cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function ll(t){return t[Ls]||null}var dc=[],Wr=-1;function $n(t){return{current:t}}function se(t){0>Wr||(t.current=dc[Wr],dc[Wr]=null,Wr--)}function ne(t,e){Wr++,dc[Wr]=t.current,t.current=e}var Wn={},Be=$n(Wn),$e=$n(!1),hr=Wn;function ci(t,e){var n=t.type.contextTypes;if(!n)return Wn;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function qe(t){return t=t.childContextTypes,t!=null}function Sa(){se($e),se(Be)}function Dd(t,e,n){if(Be.current!==Wn)throw Error(R(168));ne(Be,e),ne($e,n)}function B0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(R(108,U1(t)||"Unknown",i));return he({},n,r)}function xa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Wn,hr=Be.current,ne(Be,t),ne($e,$e.current),!0}function Bd(t,e,n){var r=t.stateNode;if(!r)throw Error(R(169));n?(t=B0(t,e,hr),r.__reactInternalMemoizedMergedChildContext=t,se($e),se(Be),ne(Be,t)):se($e),ne($e,n)}var nn=null,ul=!1,Ql=!1;function U0(t){nn===null?nn=[t]:nn.push(t)}function nw(t){ul=!0,U0(t)}function qn(){if(!Ql&&nn!==null){Ql=!0;var t=0,e=J;try{var n=nn;for(J=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nn=null,ul=!1}catch(i){throw nn!==null&&(nn=nn.slice(t+1)),c0(yf,qn),i}finally{J=e,Ql=!1}}return null}var Yr=[],Xr=0,Aa=null,Pa=0,pt=[],mt=0,dr=null,on=1,an="";function nr(t,e){Yr[Xr++]=Pa,Yr[Xr++]=Aa,Aa=t,Pa=e}function z0(t,e,n){pt[mt++]=on,pt[mt++]=an,pt[mt++]=dr,dr=t;var r=on;t=an;var i=32-Mt(r)-1;r&=~(1<<i),n+=1;var s=32-Mt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,on=1<<32-Mt(e)+i|n<<i|r,an=s+t}else on=1<<s|n<<i|r,an=t}function Cf(t){t.return!==null&&(nr(t,1),z0(t,1,0))}function Lf(t){for(;t===Aa;)Aa=Yr[--Xr],Yr[Xr]=null,Pa=Yr[--Xr],Yr[Xr]=null;for(;t===dr;)dr=pt[--mt],pt[mt]=null,an=pt[--mt],pt[mt]=null,on=pt[--mt],pt[mt]=null}var st=null,rt=null,le=!1,Ct=null;function j0(t,e){var n=_t(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ud(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,st=t,rt=Dn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,st=t,rt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=dr!==null?{id:on,overflow:an}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=_t(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,st=t,rt=null,!0):!1;default:return!1}}function gc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function pc(t){if(le){var e=rt;if(e){var n=e;if(!Ud(t,e)){if(gc(t))throw Error(R(418));e=Dn(n.nextSibling);var r=st;e&&Ud(t,e)?j0(r,n):(t.flags=t.flags&-4097|2,le=!1,st=t)}}else{if(gc(t))throw Error(R(418));t.flags=t.flags&-4097|2,le=!1,st=t}}}function zd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;st=t}function Mo(t){if(t!==st)return!1;if(!le)return zd(t),le=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!cc(t.type,t.memoizedProps)),e&&(e=rt)){if(gc(t))throw V0(),Error(R(418));for(;e;)j0(t,e),e=Dn(e.nextSibling)}if(zd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){rt=Dn(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}rt=null}}else rt=st?Dn(t.stateNode.nextSibling):null;return!0}function V0(){for(var t=rt;t;)t=Dn(t.nextSibling)}function fi(){rt=st=null,le=!1}function Mf(t){Ct===null?Ct=[t]:Ct.push(t)}var rw=mn.ReactCurrentBatchConfig;function At(t,e){if(t&&t.defaultProps){e=he({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Ca=$n(null),La=null,$r=null,If=null;function Rf(){If=$r=La=null}function Of(t){var e=Ca.current;se(Ca),t._currentValue=e}function mc(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ri(t,e){La=t,If=$r=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xe=!0),t.firstContext=null)}function Et(t){var e=t._currentValue;if(If!==t)if(t={context:t,memoizedValue:e,next:null},$r===null){if(La===null)throw Error(R(308));$r=t,La.dependencies={lanes:0,firstContext:t}}else $r=$r.next=t;return e}var or=null;function kf(t){or===null?or=[t]:or.push(t)}function G0(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,kf(e)):(n.next=i.next,i.next=n),e.interleaved=n,fn(t,r)}function fn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Pn=!1;function Nf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ln(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Bn(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Z&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,fn(t,n)}return i=r.interleaved,i===null?(e.next=e,kf(r)):(e.next=i.next,i.next=e),r.interleaved=e,fn(t,n)}function ea(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ef(t,n)}}function jd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Ma(t,e,n,r){var i=t.updateQueue;Pn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,m=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,w=a;switch(h=e,m=n,w.tag){case 1:if(E=w.payload,typeof E=="function"){f=E.call(m,f,h);break e}f=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=w.payload,h=typeof E=="function"?E.call(m,f,h):E,h==null)break e;f=he({},f,h);break e;case 2:Pn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else m={eventTime:m,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=m,l=f):c=c.next=m,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=f),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);pr|=o,t.lanes=o,t.memoizedState=f}}function Vd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(R(191,i));i.call(r)}}}var W0=new Gm.Component().refs;function _c(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:he({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cl={isMounted:function(t){return(t=t._reactInternals)?wr(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ve(),i=zn(t),s=ln(r,i);s.payload=e,n!=null&&(s.callback=n),e=Bn(t,s,i),e!==null&&(It(e,t,i,r),ea(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ve(),i=zn(t),s=ln(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Bn(t,s,i),e!==null&&(It(e,t,i,r),ea(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ve(),r=zn(t),i=ln(n,r);i.tag=2,e!=null&&(i.callback=e),e=Bn(t,i,r),e!==null&&(It(e,t,r,n),ea(e,t,r))}};function Gd(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!As(n,r)||!As(i,s):!0}function Y0(t,e,n){var r=!1,i=Wn,s=e.contextType;return typeof s=="object"&&s!==null?s=Et(s):(i=qe(e)?hr:Be.current,r=e.contextTypes,s=(r=r!=null)?ci(t,i):Wn),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cl,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Hd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cl.enqueueReplaceState(e,e.state,null)}function vc(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=W0,Nf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Et(s):(s=qe(e)?hr:Be.current,i.context=ci(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(_c(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&cl.enqueueReplaceState(i,i.state,null),Ma(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Hi(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(R(309));var r=n.stateNode}if(!r)throw Error(R(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===W0&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!n._owner)throw Error(R(290,t))}return t}function Io(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Wd(t){var e=t._init;return e(t._payload)}function X0(t){function e(_,p){if(t){var v=_.deletions;v===null?(_.deletions=[p],_.flags|=16):v.push(p)}}function n(_,p){if(!t)return null;for(;p!==null;)e(_,p),p=p.sibling;return null}function r(_,p){for(_=new Map;p!==null;)p.key!==null?_.set(p.key,p):_.set(p.index,p),p=p.sibling;return _}function i(_,p){return _=jn(_,p),_.index=0,_.sibling=null,_}function s(_,p,v){return _.index=v,t?(v=_.alternate,v!==null?(v=v.index,v<p?(_.flags|=2,p):v):(_.flags|=2,p)):(_.flags|=1048576,p)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,p,v,b){return p===null||p.tag!==6?(p=su(v,_.mode,b),p.return=_,p):(p=i(p,v),p.return=_,p)}function l(_,p,v,b){var x=v.type;return x===zr?c(_,p,v.props.children,b,v.key):p!==null&&(p.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===An&&Wd(x)===p.type)?(b=i(p,v.props),b.ref=Hi(_,p,v),b.return=_,b):(b=oa(v.type,v.key,v.props,null,_.mode,b),b.ref=Hi(_,p,v),b.return=_,b)}function u(_,p,v,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=ou(v,_.mode,b),p.return=_,p):(p=i(p,v.children||[]),p.return=_,p)}function c(_,p,v,b,x){return p===null||p.tag!==7?(p=cr(v,_.mode,b,x),p.return=_,p):(p=i(p,v),p.return=_,p)}function f(_,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=su(""+p,_.mode,v),p.return=_,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Eo:return v=oa(p.type,p.key,p.props,null,_.mode,v),v.ref=Hi(_,null,p),v.return=_,v;case Ur:return p=ou(p,_.mode,v),p.return=_,p;case An:var b=p._init;return f(_,b(p._payload),v)}if(ts(p)||Ui(p))return p=cr(p,_.mode,v,null),p.return=_,p;Io(_,p)}return null}function h(_,p,v,b){var x=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return x!==null?null:a(_,p,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Eo:return v.key===x?l(_,p,v,b):null;case Ur:return v.key===x?u(_,p,v,b):null;case An:return x=v._init,h(_,p,x(v._payload),b)}if(ts(v)||Ui(v))return x!==null?null:c(_,p,v,b,null);Io(_,v)}return null}function m(_,p,v,b,x){if(typeof b=="string"&&b!==""||typeof b=="number")return _=_.get(v)||null,a(p,_,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Eo:return _=_.get(b.key===null?v:b.key)||null,l(p,_,b,x);case Ur:return _=_.get(b.key===null?v:b.key)||null,u(p,_,b,x);case An:var P=b._init;return m(_,p,v,P(b._payload),x)}if(ts(b)||Ui(b))return _=_.get(v)||null,c(p,_,b,x,null);Io(p,b)}return null}function E(_,p,v,b){for(var x=null,P=null,L=p,M=p=0,C=null;L!==null&&M<v.length;M++){L.index>M?(C=L,L=null):C=L.sibling;var O=h(_,L,v[M],b);if(O===null){L===null&&(L=C);break}t&&L&&O.alternate===null&&e(_,L),p=s(O,p,M),P===null?x=O:P.sibling=O,P=O,L=C}if(M===v.length)return n(_,L),le&&nr(_,M),x;if(L===null){for(;M<v.length;M++)L=f(_,v[M],b),L!==null&&(p=s(L,p,M),P===null?x=L:P.sibling=L,P=L);return le&&nr(_,M),x}for(L=r(_,L);M<v.length;M++)C=m(L,_,M,v[M],b),C!==null&&(t&&C.alternate!==null&&L.delete(C.key===null?M:C.key),p=s(C,p,M),P===null?x=C:P.sibling=C,P=C);return t&&L.forEach(function(U){return e(_,U)}),le&&nr(_,M),x}function w(_,p,v,b){var x=Ui(v);if(typeof x!="function")throw Error(R(150));if(v=x.call(v),v==null)throw Error(R(151));for(var P=x=null,L=p,M=p=0,C=null,O=v.next();L!==null&&!O.done;M++,O=v.next()){L.index>M?(C=L,L=null):C=L.sibling;var U=h(_,L,O.value,b);if(U===null){L===null&&(L=C);break}t&&L&&U.alternate===null&&e(_,L),p=s(U,p,M),P===null?x=U:P.sibling=U,P=U,L=C}if(O.done)return n(_,L),le&&nr(_,M),x;if(L===null){for(;!O.done;M++,O=v.next())O=f(_,O.value,b),O!==null&&(p=s(O,p,M),P===null?x=O:P.sibling=O,P=O);return le&&nr(_,M),x}for(L=r(_,L);!O.done;M++,O=v.next())O=m(L,_,M,O.value,b),O!==null&&(t&&O.alternate!==null&&L.delete(O.key===null?M:O.key),p=s(O,p,M),P===null?x=O:P.sibling=O,P=O);return t&&L.forEach(function(H){return e(_,H)}),le&&nr(_,M),x}function S(_,p,v,b){if(typeof v=="object"&&v!==null&&v.type===zr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Eo:e:{for(var x=v.key,P=p;P!==null;){if(P.key===x){if(x=v.type,x===zr){if(P.tag===7){n(_,P.sibling),p=i(P,v.props.children),p.return=_,_=p;break e}}else if(P.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===An&&Wd(x)===P.type){n(_,P.sibling),p=i(P,v.props),p.ref=Hi(_,P,v),p.return=_,_=p;break e}n(_,P);break}else e(_,P);P=P.sibling}v.type===zr?(p=cr(v.props.children,_.mode,b,v.key),p.return=_,_=p):(b=oa(v.type,v.key,v.props,null,_.mode,b),b.ref=Hi(_,p,v),b.return=_,_=b)}return o(_);case Ur:e:{for(P=v.key;p!==null;){if(p.key===P)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(_,p.sibling),p=i(p,v.children||[]),p.return=_,_=p;break e}else{n(_,p);break}else e(_,p);p=p.sibling}p=ou(v,_.mode,b),p.return=_,_=p}return o(_);case An:return P=v._init,S(_,p,P(v._payload),b)}if(ts(v))return E(_,p,v,b);if(Ui(v))return w(_,p,v,b);Io(_,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(_,p.sibling),p=i(p,v),p.return=_,_=p):(n(_,p),p=su(v,_.mode,b),p.return=_,_=p),o(_)):n(_,p)}return S}var hi=X0(!0),$0=X0(!1),Zs={},Xt=$n(Zs),Ms=$n(Zs),Is=$n(Zs);function ar(t){if(t===Zs)throw Error(R(174));return t}function Ff(t,e){switch(ne(Is,e),ne(Ms,t),ne(Xt,Zs),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Zu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Zu(e,t)}se(Xt),ne(Xt,e)}function di(){se(Xt),se(Ms),se(Is)}function q0(t){ar(Is.current);var e=ar(Xt.current),n=Zu(e,t.type);e!==n&&(ne(Ms,t),ne(Xt,n))}function Df(t){Ms.current===t&&(se(Xt),se(Ms))}var ce=$n(0);function Ia(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Jl=[];function Bf(){for(var t=0;t<Jl.length;t++)Jl[t]._workInProgressVersionPrimary=null;Jl.length=0}var ta=mn.ReactCurrentDispatcher,eu=mn.ReactCurrentBatchConfig,gr=0,fe=null,we=null,xe=null,Ra=!1,fs=!1,Rs=0,iw=0;function Re(){throw Error(R(321))}function Uf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ot(t[n],e[n]))return!1;return!0}function zf(t,e,n,r,i,s){if(gr=s,fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ta.current=t===null||t.memoizedState===null?lw:uw,t=n(r,i),fs){s=0;do{if(fs=!1,Rs=0,25<=s)throw Error(R(301));s+=1,xe=we=null,e.updateQueue=null,ta.current=cw,t=n(r,i)}while(fs)}if(ta.current=Oa,e=we!==null&&we.next!==null,gr=0,xe=we=fe=null,Ra=!1,e)throw Error(R(300));return t}function jf(){var t=Rs!==0;return Rs=0,t}function jt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xe===null?fe.memoizedState=xe=t:xe=xe.next=t,xe}function wt(){if(we===null){var t=fe.alternate;t=t!==null?t.memoizedState:null}else t=we.next;var e=xe===null?fe.memoizedState:xe.next;if(e!==null)xe=e,we=t;else{if(t===null)throw Error(R(310));we=t,t={memoizedState:we.memoizedState,baseState:we.baseState,baseQueue:we.baseQueue,queue:we.queue,next:null},xe===null?fe.memoizedState=xe=t:xe=xe.next=t}return xe}function Os(t,e){return typeof e=="function"?e(t):e}function tu(t){var e=wt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=we,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((gr&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,fe.lanes|=c,pr|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ot(r,e.memoizedState)||(Xe=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,fe.lanes|=s,pr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function nu(t){var e=wt(),n=e.queue;if(n===null)throw Error(R(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ot(s,e.memoizedState)||(Xe=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Z0(){}function K0(t,e){var n=fe,r=wt(),i=e(),s=!Ot(r.memoizedState,i);if(s&&(r.memoizedState=i,Xe=!0),r=r.queue,Vf(e_.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||xe!==null&&xe.memoizedState.tag&1){if(n.flags|=2048,ks(9,J0.bind(null,n,r,i,e),void 0,null),Ae===null)throw Error(R(349));gr&30||Q0(n,e,i)}return i}function Q0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function J0(t,e,n,r){e.value=n,e.getSnapshot=r,t_(e)&&n_(t)}function e_(t,e,n){return n(function(){t_(e)&&n_(t)})}function t_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ot(t,n)}catch{return!0}}function n_(t){var e=fn(t,1);e!==null&&It(e,t,1,-1)}function Yd(t){var e=jt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Os,lastRenderedState:t},e.queue=t,t=t.dispatch=aw.bind(null,fe,t),[e.memoizedState,t]}function ks(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=fe.updateQueue,e===null?(e={lastEffect:null,stores:null},fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function r_(){return wt().memoizedState}function na(t,e,n,r){var i=jt();fe.flags|=t,i.memoizedState=ks(1|e,n,void 0,r===void 0?null:r)}function fl(t,e,n,r){var i=wt();r=r===void 0?null:r;var s=void 0;if(we!==null){var o=we.memoizedState;if(s=o.destroy,r!==null&&Uf(r,o.deps)){i.memoizedState=ks(e,n,s,r);return}}fe.flags|=t,i.memoizedState=ks(1|e,n,s,r)}function Xd(t,e){return na(8390656,8,t,e)}function Vf(t,e){return fl(2048,8,t,e)}function i_(t,e){return fl(4,2,t,e)}function s_(t,e){return fl(4,4,t,e)}function o_(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function a_(t,e,n){return n=n!=null?n.concat([t]):null,fl(4,4,o_.bind(null,e,t),n)}function Gf(){}function l_(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function u_(t,e){var n=wt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function c_(t,e,n){return gr&21?(Ot(n,e)||(n=d0(),fe.lanes|=n,pr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xe=!0),t.memoizedState=n)}function sw(t,e){var n=J;J=n!==0&&4>n?n:4,t(!0);var r=eu.transition;eu.transition={};try{t(!1),e()}finally{J=n,eu.transition=r}}function f_(){return wt().memoizedState}function ow(t,e,n){var r=zn(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},h_(t))d_(e,n);else if(n=G0(t,e,n,r),n!==null){var i=Ve();It(n,t,r,i),g_(n,e,r)}}function aw(t,e,n){var r=zn(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(h_(t))d_(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ot(a,o)){var l=e.interleaved;l===null?(i.next=i,kf(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=G0(t,e,i,r),n!==null&&(i=Ve(),It(n,t,r,i),g_(n,e,r))}}function h_(t){var e=t.alternate;return t===fe||e!==null&&e===fe}function d_(t,e){fs=Ra=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function g_(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ef(t,n)}}var Oa={readContext:Et,useCallback:Re,useContext:Re,useEffect:Re,useImperativeHandle:Re,useInsertionEffect:Re,useLayoutEffect:Re,useMemo:Re,useReducer:Re,useRef:Re,useState:Re,useDebugValue:Re,useDeferredValue:Re,useTransition:Re,useMutableSource:Re,useSyncExternalStore:Re,useId:Re,unstable_isNewReconciler:!1},lw={readContext:Et,useCallback:function(t,e){return jt().memoizedState=[t,e===void 0?null:e],t},useContext:Et,useEffect:Xd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,na(4194308,4,o_.bind(null,e,t),n)},useLayoutEffect:function(t,e){return na(4194308,4,t,e)},useInsertionEffect:function(t,e){return na(4,2,t,e)},useMemo:function(t,e){var n=jt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=jt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=ow.bind(null,fe,t),[r.memoizedState,t]},useRef:function(t){var e=jt();return t={current:t},e.memoizedState=t},useState:Yd,useDebugValue:Gf,useDeferredValue:function(t){return jt().memoizedState=t},useTransition:function(){var t=Yd(!1),e=t[0];return t=sw.bind(null,t[1]),jt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=fe,i=jt();if(le){if(n===void 0)throw Error(R(407));n=n()}else{if(n=e(),Ae===null)throw Error(R(349));gr&30||Q0(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Xd(e_.bind(null,r,s,t),[t]),r.flags|=2048,ks(9,J0.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=jt(),e=Ae.identifierPrefix;if(le){var n=an,r=on;n=(r&~(1<<32-Mt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Rs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=iw++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},uw={readContext:Et,useCallback:l_,useContext:Et,useEffect:Vf,useImperativeHandle:a_,useInsertionEffect:i_,useLayoutEffect:s_,useMemo:u_,useReducer:tu,useRef:r_,useState:function(){return tu(Os)},useDebugValue:Gf,useDeferredValue:function(t){var e=wt();return c_(e,we.memoizedState,t)},useTransition:function(){var t=tu(Os)[0],e=wt().memoizedState;return[t,e]},useMutableSource:Z0,useSyncExternalStore:K0,useId:f_,unstable_isNewReconciler:!1},cw={readContext:Et,useCallback:l_,useContext:Et,useEffect:Vf,useImperativeHandle:a_,useInsertionEffect:i_,useLayoutEffect:s_,useMemo:u_,useReducer:nu,useRef:r_,useState:function(){return nu(Os)},useDebugValue:Gf,useDeferredValue:function(t){var e=wt();return we===null?e.memoizedState=t:c_(e,we.memoizedState,t)},useTransition:function(){var t=nu(Os)[0],e=wt().memoizedState;return[t,e]},useMutableSource:Z0,useSyncExternalStore:K0,useId:f_,unstable_isNewReconciler:!1};function gi(t,e){try{var n="",r=e;do n+=B1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function ru(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function yc(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var fw=typeof WeakMap=="function"?WeakMap:Map;function p_(t,e,n){n=ln(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Na||(Na=!0,Lc=r),yc(t,e)},n}function m_(t,e,n){n=ln(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){yc(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){yc(t,e),typeof r!="function"&&(Un===null?Un=new Set([this]):Un.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function $d(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new fw;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=xw.bind(null,t,e,n),e.then(t,t))}function qd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zd(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ln(-1,1),e.tag=2,Bn(n,e,1))),n.lanes|=1),t)}var hw=mn.ReactCurrentOwner,Xe=!1;function ze(t,e,n,r){e.child=t===null?$0(e,null,n,r):hi(e,t.child,n,r)}function Kd(t,e,n,r,i){n=n.render;var s=e.ref;return ri(e,i),r=zf(t,e,n,r,s,i),n=jf(),t!==null&&!Xe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hn(t,e,i)):(le&&n&&Cf(e),e.flags|=1,ze(t,e,r,i),e.child)}function Qd(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Kf(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,__(t,e,s,r,i)):(t=oa(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:As,n(o,r)&&t.ref===e.ref)return hn(t,e,i)}return e.flags|=1,t=jn(s,r),t.ref=e.ref,t.return=e,e.child=t}function __(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(As(s,r)&&t.ref===e.ref)if(Xe=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Xe=!0);else return e.lanes=t.lanes,hn(t,e,i)}return Ec(t,e,n,r,i)}function v_(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ne(Zr,et),et|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ne(Zr,et),et|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ne(Zr,et),et|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ne(Zr,et),et|=r;return ze(t,e,i,n),e.child}function y_(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ec(t,e,n,r,i){var s=qe(n)?hr:Be.current;return s=ci(e,s),ri(e,i),n=zf(t,e,n,r,s,i),r=jf(),t!==null&&!Xe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,hn(t,e,i)):(le&&r&&Cf(e),e.flags|=1,ze(t,e,n,i),e.child)}function Jd(t,e,n,r,i){if(qe(n)){var s=!0;xa(e)}else s=!1;if(ri(e,i),e.stateNode===null)ra(t,e),Y0(e,n,r),vc(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Et(u):(u=qe(n)?hr:Be.current,u=ci(e,u));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Hd(e,o,r,u),Pn=!1;var h=e.memoizedState;o.state=h,Ma(e,r,o,i),l=e.memoizedState,a!==r||h!==l||$e.current||Pn?(typeof c=="function"&&(_c(e,n,c,r),l=e.memoizedState),(a=Pn||Gd(e,n,a,r,h,l,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,H0(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:At(e.type,a),o.props=u,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Et(l):(l=qe(n)?hr:Be.current,l=ci(e,l));var m=n.getDerivedStateFromProps;(c=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&Hd(e,o,r,l),Pn=!1,h=e.memoizedState,o.state=h,Ma(e,r,o,i);var E=e.memoizedState;a!==f||h!==E||$e.current||Pn?(typeof m=="function"&&(_c(e,n,m,r),E=e.memoizedState),(u=Pn||Gd(e,n,u,r,h,E,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return wc(t,e,n,r,s,i)}function wc(t,e,n,r,i,s){y_(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Bd(e,n,!1),hn(t,e,s);r=e.stateNode,hw.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=hi(e,t.child,null,s),e.child=hi(e,null,a,s)):ze(t,e,a,s),e.memoizedState=r.state,i&&Bd(e,n,!0),e.child}function E_(t){var e=t.stateNode;e.pendingContext?Dd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Dd(t,e.context,!1),Ff(t,e.containerInfo)}function eg(t,e,n,r,i){return fi(),Mf(i),e.flags|=256,ze(t,e,n,r),e.child}var Tc={dehydrated:null,treeContext:null,retryLane:0};function bc(t){return{baseLanes:t,cachePool:null,transitions:null}}function w_(t,e,n){var r=e.pendingProps,i=ce.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ne(ce,i&1),t===null)return pc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=gl(o,r,0,null),t=cr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=bc(n),e.memoizedState=Tc,t):Hf(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return dw(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=jn(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=jn(a,s):(s=cr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?bc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Tc,r}return s=t.child,t=s.sibling,r=jn(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hf(t,e){return e=gl({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ro(t,e,n,r){return r!==null&&Mf(r),hi(e,t.child,null,n),t=Hf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dw(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=ru(Error(R(422))),Ro(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=gl({mode:"visible",children:r.children},i,0,null),s=cr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&hi(e,t.child,null,o),e.child.memoizedState=bc(o),e.memoizedState=Tc,s);if(!(e.mode&1))return Ro(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(R(419)),r=ru(s,r,void 0),Ro(t,e,o,r)}if(a=(o&t.childLanes)!==0,Xe||a){if(r=Ae,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fn(t,i),It(r,t,i,-1))}return Zf(),r=ru(Error(R(421))),Ro(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=Aw.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,rt=Dn(i.nextSibling),st=e,le=!0,Ct=null,t!==null&&(pt[mt++]=on,pt[mt++]=an,pt[mt++]=dr,on=t.id,an=t.overflow,dr=e),e=Hf(e,r.children),e.flags|=4096,e)}function tg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),mc(t.return,e,n)}function iu(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function T_(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(ze(t,e,r.children,n),r=ce.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&tg(t,n,e);else if(t.tag===19)tg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ne(ce,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ia(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),iu(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ia(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}iu(e,!0,n,null,s);break;case"together":iu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ra(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function hn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),pr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,n=jn(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=jn(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function gw(t,e,n){switch(e.tag){case 3:E_(e),fi();break;case 5:q0(e);break;case 1:qe(e.type)&&xa(e);break;case 4:Ff(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ne(Ca,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ne(ce,ce.current&1),e.flags|=128,null):n&e.child.childLanes?w_(t,e,n):(ne(ce,ce.current&1),t=hn(t,e,n),t!==null?t.sibling:null);ne(ce,ce.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return T_(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ne(ce,ce.current),r)break;return null;case 22:case 23:return e.lanes=0,v_(t,e,n)}return hn(t,e,n)}var b_,Sc,S_,x_;b_=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sc=function(){};S_=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ar(Xt.current);var s=null;switch(n){case"input":i=Yu(t,i),r=Yu(t,r),s=[];break;case"select":i=he({},i,{value:void 0}),r=he({},r,{value:void 0}),s=[];break;case"textarea":i=qu(t,i),r=qu(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ba)}Ku(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ys.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ys.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ie("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};x_=function(t,e,n,r){n!==r&&(e.flags|=4)};function Wi(t,e){if(!le)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Oe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function pw(t,e,n){var r=e.pendingProps;switch(Lf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oe(e),null;case 1:return qe(e.type)&&Sa(),Oe(e),null;case 3:return r=e.stateNode,di(),se($e),se(Be),Bf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mo(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ct!==null&&(Rc(Ct),Ct=null))),Sc(t,e),Oe(e),null;case 5:Df(e);var i=ar(Is.current);if(n=e.type,t!==null&&e.stateNode!=null)S_(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(R(166));return Oe(e),null}if(t=ar(Xt.current),Mo(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Vt]=e,r[Ls]=s,t=(e.mode&1)!==0,n){case"dialog":ie("cancel",r),ie("close",r);break;case"iframe":case"object":case"embed":ie("load",r);break;case"video":case"audio":for(i=0;i<rs.length;i++)ie(rs[i],r);break;case"source":ie("error",r);break;case"img":case"image":case"link":ie("error",r),ie("load",r);break;case"details":ie("toggle",r);break;case"input":cd(r,s),ie("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ie("invalid",r);break;case"textarea":hd(r,s),ie("invalid",r)}Ku(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Lo(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Lo(r.textContent,a,t),i=["children",""+a]):ys.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ie("scroll",r)}switch(n){case"input":wo(r),fd(r,s,!0);break;case"textarea":wo(r),dd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ba)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Qm(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Vt]=e,t[Ls]=r,b_(t,e,!1,!1),e.stateNode=t;e:{switch(o=Qu(n,r),n){case"dialog":ie("cancel",t),ie("close",t),i=r;break;case"iframe":case"object":case"embed":ie("load",t),i=r;break;case"video":case"audio":for(i=0;i<rs.length;i++)ie(rs[i],t);i=r;break;case"source":ie("error",t),i=r;break;case"img":case"image":case"link":ie("error",t),ie("load",t),i=r;break;case"details":ie("toggle",t),i=r;break;case"input":cd(t,r),i=Yu(t,r),ie("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=he({},r,{value:void 0}),ie("invalid",t);break;case"textarea":hd(t,r),i=qu(t,r),ie("invalid",t);break;default:i=r}Ku(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?t0(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jm(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Es(t,l):typeof l=="number"&&Es(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ys.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ie("scroll",t):l!=null&&gf(t,s,l,o))}switch(n){case"input":wo(t),fd(t,r,!1);break;case"textarea":wo(t),dd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Hn(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Jr(t,!!r.multiple,s,!1):r.defaultValue!=null&&Jr(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=ba)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oe(e),null;case 6:if(t&&e.stateNode!=null)x_(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(R(166));if(n=ar(Is.current),ar(Xt.current),Mo(e)){if(r=e.stateNode,n=e.memoizedProps,r[Vt]=e,(s=r.nodeValue!==n)&&(t=st,t!==null))switch(t.tag){case 3:Lo(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lo(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Vt]=e,e.stateNode=r}return Oe(e),null;case 13:if(se(ce),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(le&&rt!==null&&e.mode&1&&!(e.flags&128))V0(),fi(),e.flags|=98560,s=!1;else if(s=Mo(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[Vt]=e}else fi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oe(e),s=!1}else Ct!==null&&(Rc(Ct),Ct=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ce.current&1?Te===0&&(Te=3):Zf())),e.updateQueue!==null&&(e.flags|=4),Oe(e),null);case 4:return di(),Sc(t,e),t===null&&Ps(e.stateNode.containerInfo),Oe(e),null;case 10:return Of(e.type._context),Oe(e),null;case 17:return qe(e.type)&&Sa(),Oe(e),null;case 19:if(se(ce),s=e.memoizedState,s===null)return Oe(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Wi(s,!1);else{if(Te!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ia(t),o!==null){for(e.flags|=128,Wi(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ne(ce,ce.current&1|2),e.child}t=t.sibling}s.tail!==null&&pe()>pi&&(e.flags|=128,r=!0,Wi(s,!1),e.lanes=4194304)}else{if(!r)if(t=Ia(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!le)return Oe(e),null}else 2*pe()-s.renderingStartTime>pi&&n!==1073741824&&(e.flags|=128,r=!0,Wi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pe(),e.sibling=null,n=ce.current,ne(ce,r?n&1|2:n&1),e):(Oe(e),null);case 22:case 23:return qf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?et&1073741824&&(Oe(e),e.subtreeFlags&6&&(e.flags|=8192)):Oe(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function mw(t,e){switch(Lf(e),e.tag){case 1:return qe(e.type)&&Sa(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return di(),se($e),se(Be),Bf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Df(e),null;case 13:if(se(ce),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));fi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return se(ce),null;case 4:return di(),null;case 10:return Of(e.type._context),null;case 22:case 23:return qf(),null;case 24:return null;default:return null}}var Oo=!1,Fe=!1,_w=typeof WeakSet=="function"?WeakSet:Set,B=null;function qr(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ge(t,e,r)}else n.current=null}function xc(t,e,n){try{n()}catch(r){ge(t,e,r)}}var ng=!1;function vw(t,e){if(lc=Ea,t=L0(),Pf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,f=t,h=null;t:for(;;){for(var m;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===t)break t;if(h===n&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(uc={focusedElem:t,selectionRange:n},Ea=!1,B=e;B!==null;)if(e=B,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,B=t;else for(;B!==null;){e=B;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var w=E.memoizedProps,S=E.memoizedState,_=e.stateNode,p=_.getSnapshotBeforeUpdate(e.elementType===e.type?w:At(e.type,w),S);_.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(b){ge(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}return E=ng,ng=!1,E}function hs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&xc(e,n,s)}i=i.next}while(i!==r)}}function hl(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ac(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function A_(t){var e=t.alternate;e!==null&&(t.alternate=null,A_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Vt],delete e[Ls],delete e[hc],delete e[ew],delete e[tw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function P_(t){return t.tag===5||t.tag===3||t.tag===4}function rg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||P_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ba));else if(r!==4&&(t=t.child,t!==null))for(Pc(t,e,n),t=t.sibling;t!==null;)Pc(t,e,n),t=t.sibling}function Cc(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Cc(t,e,n),t=t.sibling;t!==null;)Cc(t,e,n),t=t.sibling}var Le=null,Pt=!1;function En(t,e,n){for(n=n.child;n!==null;)C_(t,e,n),n=n.sibling}function C_(t,e,n){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(il,n)}catch{}switch(n.tag){case 5:Fe||qr(n,e);case 6:var r=Le,i=Pt;Le=null,En(t,e,n),Le=r,Pt=i,Le!==null&&(Pt?(t=Le,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Le.removeChild(n.stateNode));break;case 18:Le!==null&&(Pt?(t=Le,n=n.stateNode,t.nodeType===8?Kl(t.parentNode,n):t.nodeType===1&&Kl(t,n),Ss(t)):Kl(Le,n.stateNode));break;case 4:r=Le,i=Pt,Le=n.stateNode.containerInfo,Pt=!0,En(t,e,n),Le=r,Pt=i;break;case 0:case 11:case 14:case 15:if(!Fe&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&xc(n,e,o),i=i.next}while(i!==r)}En(t,e,n);break;case 1:if(!Fe&&(qr(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ge(n,e,a)}En(t,e,n);break;case 21:En(t,e,n);break;case 22:n.mode&1?(Fe=(r=Fe)||n.memoizedState!==null,En(t,e,n),Fe=r):En(t,e,n);break;default:En(t,e,n)}}function ig(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new _w),e.forEach(function(r){var i=Pw.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function xt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,Pt=!1;break e;case 3:Le=a.stateNode.containerInfo,Pt=!0;break e;case 4:Le=a.stateNode.containerInfo,Pt=!0;break e}a=a.return}if(Le===null)throw Error(R(160));C_(s,o,i),Le=null,Pt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){ge(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)L_(e,t),e=e.sibling}function L_(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(xt(e,t),Dt(t),r&4){try{hs(3,t,t.return),hl(3,t)}catch(w){ge(t,t.return,w)}try{hs(5,t,t.return)}catch(w){ge(t,t.return,w)}}break;case 1:xt(e,t),Dt(t),r&512&&n!==null&&qr(n,n.return);break;case 5:if(xt(e,t),Dt(t),r&512&&n!==null&&qr(n,n.return),t.flags&32){var i=t.stateNode;try{Es(i,"")}catch(w){ge(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Zm(i,s),Qu(a,o);var u=Qu(a,s);for(o=0;o<l.length;o+=2){var c=l[o],f=l[o+1];c==="style"?t0(i,f):c==="dangerouslySetInnerHTML"?Jm(i,f):c==="children"?Es(i,f):gf(i,c,f,u)}switch(a){case"input":Xu(i,s);break;case"textarea":Km(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Jr(i,!!s.multiple,m,!1):h!==!!s.multiple&&(s.defaultValue!=null?Jr(i,!!s.multiple,s.defaultValue,!0):Jr(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ls]=s}catch(w){ge(t,t.return,w)}}break;case 6:if(xt(e,t),Dt(t),r&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){ge(t,t.return,w)}}break;case 3:if(xt(e,t),Dt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ss(e.containerInfo)}catch(w){ge(t,t.return,w)}break;case 4:xt(e,t),Dt(t);break;case 13:xt(e,t),Dt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Xf=pe())),r&4&&ig(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Fe=(u=Fe)||c,xt(e,t),Fe=u):xt(e,t),Dt(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(B=t,c=t.child;c!==null;){for(f=B=c;B!==null;){switch(h=B,m=h.child,h.tag){case 0:case 11:case 14:case 15:hs(4,h,h.return);break;case 1:qr(h,h.return);var E=h.stateNode;if(typeof E.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(w){ge(r,n,w)}}break;case 5:qr(h,h.return);break;case 22:if(h.memoizedState!==null){og(f);continue}}m!==null?(m.return=h,B=m):og(f)}c=c.sibling}e:for(c=null,f=t;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=e0("display",o))}catch(w){ge(t,t.return,w)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(w){ge(t,t.return,w)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:xt(e,t),Dt(t),r&4&&ig(t);break;case 21:break;default:xt(e,t),Dt(t)}}function Dt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(P_(n)){var r=n;break e}n=n.return}throw Error(R(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Es(i,""),r.flags&=-33);var s=rg(t);Cc(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=rg(t);Pc(t,a,o);break;default:throw Error(R(161))}}catch(l){ge(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yw(t,e,n){B=t,M_(t)}function M_(t,e,n){for(var r=(t.mode&1)!==0;B!==null;){var i=B,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Oo;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Fe;a=Oo;var u=Fe;if(Oo=o,(Fe=l)&&!u)for(B=i;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?ag(i):l!==null?(l.return=o,B=l):ag(i);for(;s!==null;)B=s,M_(s),s=s.sibling;B=i,Oo=a,Fe=u}sg(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,B=s):sg(t)}}function sg(t){for(;B!==null;){var e=B;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fe||hl(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Fe)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:At(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Vd(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Vd(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&Ss(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Fe||e.flags&512&&Ac(e)}catch(h){ge(e,e.return,h)}}if(e===t){B=null;break}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}}function og(t){for(;B!==null;){var e=B;if(e===t){B=null;break}var n=e.sibling;if(n!==null){n.return=e.return,B=n;break}B=e.return}}function ag(t){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{hl(4,e)}catch(l){ge(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ge(e,i,l)}}var s=e.return;try{Ac(e)}catch(l){ge(e,s,l)}break;case 5:var o=e.return;try{Ac(e)}catch(l){ge(e,o,l)}}}catch(l){ge(e,e.return,l)}if(e===t){B=null;break}var a=e.sibling;if(a!==null){a.return=e.return,B=a;break}B=e.return}}var Ew=Math.ceil,ka=mn.ReactCurrentDispatcher,Wf=mn.ReactCurrentOwner,vt=mn.ReactCurrentBatchConfig,Z=0,Ae=null,ye=null,Me=0,et=0,Zr=$n(0),Te=0,Ns=null,pr=0,dl=0,Yf=0,ds=null,Ye=null,Xf=0,pi=1/0,tn=null,Na=!1,Lc=null,Un=null,ko=!1,In=null,Fa=0,gs=0,Mc=null,ia=-1,sa=0;function Ve(){return Z&6?pe():ia!==-1?ia:ia=pe()}function zn(t){return t.mode&1?Z&2&&Me!==0?Me&-Me:rw.transition!==null?(sa===0&&(sa=d0()),sa):(t=J,t!==0||(t=window.event,t=t===void 0?16:E0(t.type)),t):1}function It(t,e,n,r){if(50<gs)throw gs=0,Mc=null,Error(R(185));Xs(t,n,r),(!(Z&2)||t!==Ae)&&(t===Ae&&(!(Z&2)&&(dl|=n),Te===4&&Ln(t,Me)),Ze(t,r),n===1&&Z===0&&!(e.mode&1)&&(pi=pe()+500,ul&&qn()))}function Ze(t,e){var n=t.callbackNode;rE(t,e);var r=ya(t,t===Ae?Me:0);if(r===0)n!==null&&md(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&md(n),e===1)t.tag===0?nw(lg.bind(null,t)):U0(lg.bind(null,t)),QE(function(){!(Z&6)&&qn()}),n=null;else{switch(g0(r)){case 1:n=yf;break;case 4:n=f0;break;case 16:n=va;break;case 536870912:n=h0;break;default:n=va}n=B_(n,I_.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function I_(t,e){if(ia=-1,sa=0,Z&6)throw Error(R(327));var n=t.callbackNode;if(ii()&&t.callbackNode!==n)return null;var r=ya(t,t===Ae?Me:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Da(t,r);else{e=r;var i=Z;Z|=2;var s=O_();(Ae!==t||Me!==e)&&(tn=null,pi=pe()+500,ur(t,e));do try{bw();break}catch(a){R_(t,a)}while(1);Rf(),ka.current=s,Z=i,ye!==null?e=0:(Ae=null,Me=0,e=Te)}if(e!==0){if(e===2&&(i=rc(t),i!==0&&(r=i,e=Ic(t,i))),e===1)throw n=Ns,ur(t,0),Ln(t,r),Ze(t,pe()),n;if(e===6)Ln(t,r);else{if(i=t.current.alternate,!(r&30)&&!ww(i)&&(e=Da(t,r),e===2&&(s=rc(t),s!==0&&(r=s,e=Ic(t,s))),e===1))throw n=Ns,ur(t,0),Ln(t,r),Ze(t,pe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(R(345));case 2:rr(t,Ye,tn);break;case 3:if(Ln(t,r),(r&130023424)===r&&(e=Xf+500-pe(),10<e)){if(ya(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ve(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=fc(rr.bind(null,t,Ye,tn),e);break}rr(t,Ye,tn);break;case 4:if(Ln(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Mt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ew(r/1960))-r,10<r){t.timeoutHandle=fc(rr.bind(null,t,Ye,tn),r);break}rr(t,Ye,tn);break;case 5:rr(t,Ye,tn);break;default:throw Error(R(329))}}}return Ze(t,pe()),t.callbackNode===n?I_.bind(null,t):null}function Ic(t,e){var n=ds;return t.current.memoizedState.isDehydrated&&(ur(t,e).flags|=256),t=Da(t,e),t!==2&&(e=Ye,Ye=n,e!==null&&Rc(e)),t}function Rc(t){Ye===null?Ye=t:Ye.push.apply(Ye,t)}function ww(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ot(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ln(t,e){for(e&=~Yf,e&=~dl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mt(e),r=1<<n;t[n]=-1,e&=~r}}function lg(t){if(Z&6)throw Error(R(327));ii();var e=ya(t,0);if(!(e&1))return Ze(t,pe()),null;var n=Da(t,e);if(t.tag!==0&&n===2){var r=rc(t);r!==0&&(e=r,n=Ic(t,r))}if(n===1)throw n=Ns,ur(t,0),Ln(t,e),Ze(t,pe()),n;if(n===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rr(t,Ye,tn),Ze(t,pe()),null}function $f(t,e){var n=Z;Z|=1;try{return t(e)}finally{Z=n,Z===0&&(pi=pe()+500,ul&&qn())}}function mr(t){In!==null&&In.tag===0&&!(Z&6)&&ii();var e=Z;Z|=1;var n=vt.transition,r=J;try{if(vt.transition=null,J=1,t)return t()}finally{J=r,vt.transition=n,Z=e,!(Z&6)&&qn()}}function qf(){et=Zr.current,se(Zr)}function ur(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,KE(n)),ye!==null)for(n=ye.return;n!==null;){var r=n;switch(Lf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sa();break;case 3:di(),se($e),se(Be),Bf();break;case 5:Df(r);break;case 4:di();break;case 13:se(ce);break;case 19:se(ce);break;case 10:Of(r.type._context);break;case 22:case 23:qf()}n=n.return}if(Ae=t,ye=t=jn(t.current,null),Me=et=e,Te=0,Ns=null,Yf=dl=pr=0,Ye=ds=null,or!==null){for(e=0;e<or.length;e++)if(n=or[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}or=null}return t}function R_(t,e){do{var n=ye;try{if(Rf(),ta.current=Oa,Ra){for(var r=fe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Ra=!1}if(gr=0,xe=we=fe=null,fs=!1,Rs=0,Wf.current=null,n===null||n.return===null){Te=1,Ns=e,ye=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Me,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=qd(o);if(m!==null){m.flags&=-257,Zd(m,o,a,s,e),m.mode&1&&$d(s,u,e),e=m,l=u;var E=e.updateQueue;if(E===null){var w=new Set;w.add(l),e.updateQueue=w}else E.add(l);break e}else{if(!(e&1)){$d(s,u,e),Zf();break e}l=Error(R(426))}}else if(le&&a.mode&1){var S=qd(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Zd(S,o,a,s,e),Mf(gi(l,a));break e}}s=l=gi(l,a),Te!==4&&(Te=2),ds===null?ds=[s]:ds.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var _=p_(s,l,e);jd(s,_);break e;case 1:a=l;var p=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Un===null||!Un.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=m_(s,a,e);jd(s,b);break e}}s=s.return}while(s!==null)}N_(n)}catch(x){e=x,ye===n&&n!==null&&(ye=n=n.return);continue}break}while(1)}function O_(){var t=ka.current;return ka.current=Oa,t===null?Oa:t}function Zf(){(Te===0||Te===3||Te===2)&&(Te=4),Ae===null||!(pr&268435455)&&!(dl&268435455)||Ln(Ae,Me)}function Da(t,e){var n=Z;Z|=2;var r=O_();(Ae!==t||Me!==e)&&(tn=null,ur(t,e));do try{Tw();break}catch(i){R_(t,i)}while(1);if(Rf(),Z=n,ka.current=r,ye!==null)throw Error(R(261));return Ae=null,Me=0,Te}function Tw(){for(;ye!==null;)k_(ye)}function bw(){for(;ye!==null&&!$1();)k_(ye)}function k_(t){var e=D_(t.alternate,t,et);t.memoizedProps=t.pendingProps,e===null?N_(t):ye=e,Wf.current=null}function N_(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=mw(n,e),n!==null){n.flags&=32767,ye=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Te=6,ye=null;return}}else if(n=pw(n,e,et),n!==null){ye=n;return}if(e=e.sibling,e!==null){ye=e;return}ye=e=t}while(e!==null);Te===0&&(Te=5)}function rr(t,e,n){var r=J,i=vt.transition;try{vt.transition=null,J=1,Sw(t,e,n,r)}finally{vt.transition=i,J=r}return null}function Sw(t,e,n,r){do ii();while(In!==null);if(Z&6)throw Error(R(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(iE(t,s),t===Ae&&(ye=Ae=null,Me=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ko||(ko=!0,B_(va,function(){return ii(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=vt.transition,vt.transition=null;var o=J;J=1;var a=Z;Z|=4,Wf.current=null,vw(t,n),L_(n,t),HE(uc),Ea=!!lc,uc=lc=null,t.current=n,yw(n),q1(),Z=a,J=o,vt.transition=s}else t.current=n;if(ko&&(ko=!1,In=t,Fa=i),s=t.pendingLanes,s===0&&(Un=null),Q1(n.stateNode),Ze(t,pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Na)throw Na=!1,t=Lc,Lc=null,t;return Fa&1&&t.tag!==0&&ii(),s=t.pendingLanes,s&1?t===Mc?gs++:(gs=0,Mc=t):gs=0,qn(),null}function ii(){if(In!==null){var t=g0(Fa),e=vt.transition,n=J;try{if(vt.transition=null,J=16>t?16:t,In===null)var r=!1;else{if(t=In,In=null,Fa=0,Z&6)throw Error(R(331));var i=Z;for(Z|=4,B=t.current;B!==null;){var s=B,o=s.child;if(B.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(B=u;B!==null;){var c=B;switch(c.tag){case 0:case 11:case 15:hs(8,c,s)}var f=c.child;if(f!==null)f.return=c,B=f;else for(;B!==null;){c=B;var h=c.sibling,m=c.return;if(A_(c),c===u){B=null;break}if(h!==null){h.return=m,B=h;break}B=m}}}var E=s.alternate;if(E!==null){var w=E.child;if(w!==null){E.child=null;do{var S=w.sibling;w.sibling=null,w=S}while(w!==null)}}B=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,B=o;else e:for(;B!==null;){if(s=B,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hs(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,B=_;break e}B=s.return}}var p=t.current;for(B=p;B!==null;){o=B;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,B=v;else e:for(o=p;B!==null;){if(a=B,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hl(9,a)}}catch(x){ge(a,a.return,x)}if(a===o){B=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,B=b;break e}B=a.return}}if(Z=i,qn(),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(il,t)}catch{}r=!0}return r}finally{J=n,vt.transition=e}}return!1}function ug(t,e,n){e=gi(n,e),e=p_(t,e,1),t=Bn(t,e,1),e=Ve(),t!==null&&(Xs(t,1,e),Ze(t,e))}function ge(t,e,n){if(t.tag===3)ug(t,t,n);else for(;e!==null;){if(e.tag===3){ug(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Un===null||!Un.has(r))){t=gi(n,t),t=m_(e,t,1),e=Bn(e,t,1),t=Ve(),e!==null&&(Xs(e,1,t),Ze(e,t));break}}e=e.return}}function xw(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ve(),t.pingedLanes|=t.suspendedLanes&n,Ae===t&&(Me&n)===n&&(Te===4||Te===3&&(Me&130023424)===Me&&500>pe()-Xf?ur(t,0):Yf|=n),Ze(t,e)}function F_(t,e){e===0&&(t.mode&1?(e=So,So<<=1,!(So&130023424)&&(So=4194304)):e=1);var n=Ve();t=fn(t,e),t!==null&&(Xs(t,e,n),Ze(t,n))}function Aw(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),F_(t,n)}function Pw(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(R(314))}r!==null&&r.delete(e),F_(t,n)}var D_;D_=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$e.current)Xe=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xe=!1,gw(t,e,n);Xe=!!(t.flags&131072)}else Xe=!1,le&&e.flags&1048576&&z0(e,Pa,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ra(t,e),t=e.pendingProps;var i=ci(e,Be.current);ri(e,n),i=zf(null,e,r,t,i,n);var s=jf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,qe(r)?(s=!0,xa(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Nf(e),i.updater=cl,e.stateNode=i,i._reactInternals=e,vc(e,r,t,n),e=wc(null,e,r,!0,s,n)):(e.tag=0,le&&s&&Cf(e),ze(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(ra(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Lw(r),t=At(r,t),i){case 0:e=Ec(null,e,r,t,n);break e;case 1:e=Jd(null,e,r,t,n);break e;case 11:e=Kd(null,e,r,t,n);break e;case 14:e=Qd(null,e,r,At(r.type,t),n);break e}throw Error(R(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:At(r,i),Ec(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:At(r,i),Jd(t,e,r,i,n);case 3:e:{if(E_(e),t===null)throw Error(R(387));r=e.pendingProps,s=e.memoizedState,i=s.element,H0(t,e),Ma(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=gi(Error(R(423)),e),e=eg(t,e,r,n,i);break e}else if(r!==i){i=gi(Error(R(424)),e),e=eg(t,e,r,n,i);break e}else for(rt=Dn(e.stateNode.containerInfo.firstChild),st=e,le=!0,Ct=null,n=$0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fi(),r===i){e=hn(t,e,n);break e}ze(t,e,r,n)}e=e.child}return e;case 5:return q0(e),t===null&&pc(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,cc(r,i)?o=null:s!==null&&cc(r,s)&&(e.flags|=32),y_(t,e),ze(t,e,o,n),e.child;case 6:return t===null&&pc(e),null;case 13:return w_(t,e,n);case 4:return Ff(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hi(e,null,r,n):ze(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:At(r,i),Kd(t,e,r,i,n);case 7:return ze(t,e,e.pendingProps,n),e.child;case 8:return ze(t,e,e.pendingProps.children,n),e.child;case 12:return ze(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ne(Ca,r._currentValue),r._currentValue=o,s!==null)if(Ot(s.value,o)){if(s.children===i.children&&!$e.current){e=hn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ln(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),mc(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),mc(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ze(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ri(e,n),i=Et(i),r=r(i),e.flags|=1,ze(t,e,r,n),e.child;case 14:return r=e.type,i=At(r,e.pendingProps),i=At(r.type,i),Qd(t,e,r,i,n);case 15:return __(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:At(r,i),ra(t,e),e.tag=1,qe(r)?(t=!0,xa(e)):t=!1,ri(e,n),Y0(e,r,i),vc(e,r,i,n),wc(null,e,r,!0,t,n);case 19:return T_(t,e,n);case 22:return v_(t,e,n)}throw Error(R(156,e.tag))};function B_(t,e){return c0(t,e)}function Cw(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _t(t,e,n,r){return new Cw(t,e,n,r)}function Kf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Lw(t){if(typeof t=="function")return Kf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===mf)return 11;if(t===_f)return 14}return 2}function jn(t,e){var n=t.alternate;return n===null?(n=_t(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function oa(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Kf(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zr:return cr(n.children,i,s,e);case pf:o=8,i|=8;break;case Vu:return t=_t(12,n,e,i|2),t.elementType=Vu,t.lanes=s,t;case Gu:return t=_t(13,n,e,i),t.elementType=Gu,t.lanes=s,t;case Hu:return t=_t(19,n,e,i),t.elementType=Hu,t.lanes=s,t;case Xm:return gl(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Wm:o=10;break e;case Ym:o=9;break e;case mf:o=11;break e;case _f:o=14;break e;case An:o=16,r=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=_t(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function cr(t,e,n,r){return t=_t(7,t,r,e),t.lanes=n,t}function gl(t,e,n,r){return t=_t(22,t,r,e),t.elementType=Xm,t.lanes=n,t.stateNode={isHidden:!1},t}function su(t,e,n){return t=_t(6,t,null,e),t.lanes=n,t}function ou(t,e,n){return e=_t(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Mw(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zl(0),this.expirationTimes=zl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zl(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Qf(t,e,n,r,i,s,o,a,l){return t=new Mw(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=_t(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nf(s),t}function Iw(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ur,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function U_(t){if(!t)return Wn;t=t._reactInternals;e:{if(wr(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(qe(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var n=t.type;if(qe(n))return B0(t,n,e)}return e}function z_(t,e,n,r,i,s,o,a,l){return t=Qf(n,r,!0,t,i,s,o,a,l),t.context=U_(null),n=t.current,r=Ve(),i=zn(n),s=ln(r,i),s.callback=e??null,Bn(n,s,i),t.current.lanes=i,Xs(t,i,r),Ze(t,r),t}function pl(t,e,n,r){var i=e.current,s=Ve(),o=zn(i);return n=U_(n),e.context===null?e.context=n:e.pendingContext=n,e=ln(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Bn(i,e,o),t!==null&&(It(t,i,o,s),ea(t,i,o)),o}function Ba(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jf(t,e){cg(t,e),(t=t.alternate)&&cg(t,e)}function Rw(){return null}var j_=typeof reportError=="function"?reportError:function(t){console.error(t)};function eh(t){this._internalRoot=t}ml.prototype.render=eh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));pl(t,e,null,null)};ml.prototype.unmount=eh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;mr(function(){pl(null,t,null,null)}),e[cn]=null}};function ml(t){this._internalRoot=t}ml.prototype.unstable_scheduleHydration=function(t){if(t){var e=_0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Cn.length&&e!==0&&e<Cn[n].priority;n++);Cn.splice(n,0,t),n===0&&y0(t)}};function th(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _l(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function fg(){}function Ow(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Ba(o);s.call(u)}}var o=z_(e,r,t,0,null,!1,!1,"",fg);return t._reactRootContainer=o,t[cn]=o.current,Ps(t.nodeType===8?t.parentNode:t),mr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Ba(l);a.call(u)}}var l=Qf(t,0,!1,null,null,!1,!1,"",fg);return t._reactRootContainer=l,t[cn]=l.current,Ps(t.nodeType===8?t.parentNode:t),mr(function(){pl(e,l,n,r)}),l}function vl(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Ba(o);a.call(l)}}pl(e,o,t,i)}else o=Ow(n,e,t,i,r);return Ba(o)}p0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ns(e.pendingLanes);n!==0&&(Ef(e,n|1),Ze(e,pe()),!(Z&6)&&(pi=pe()+500,qn()))}break;case 13:mr(function(){var r=fn(t,1);if(r!==null){var i=Ve();It(r,t,1,i)}}),Jf(t,1)}};wf=function(t){if(t.tag===13){var e=fn(t,134217728);if(e!==null){var n=Ve();It(e,t,134217728,n)}Jf(t,134217728)}};m0=function(t){if(t.tag===13){var e=zn(t),n=fn(t,e);if(n!==null){var r=Ve();It(n,t,e,r)}Jf(t,e)}};_0=function(){return J};v0=function(t,e){var n=J;try{return J=t,e()}finally{J=n}};ec=function(t,e,n){switch(e){case"input":if(Xu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=ll(r);if(!i)throw Error(R(90));qm(r),Xu(r,i)}}}break;case"textarea":Km(t,n);break;case"select":e=n.value,e!=null&&Jr(t,!!n.multiple,e,!1)}};i0=$f;s0=mr;var kw={usingClientEntryPoint:!1,Events:[qs,Hr,ll,n0,r0,$f]},Yi={findFiberByHostInstance:sr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Nw={bundleType:Yi.bundleType,version:Yi.version,rendererPackageName:Yi.rendererPackageName,rendererConfig:Yi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=l0(t),t===null?null:t.stateNode},findFiberByHostInstance:Yi.findFiberByHostInstance||Rw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var No=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!No.isDisabled&&No.supportsFiber)try{il=No.inject(Nw),Yt=No}catch{}}ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kw;ut.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!th(e))throw Error(R(200));return Iw(t,e,null,n)};ut.createRoot=function(t,e){if(!th(t))throw Error(R(299));var n=!1,r="",i=j_;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Qf(t,1,!1,null,null,n,!1,r,i),t[cn]=e.current,Ps(t.nodeType===8?t.parentNode:t),new eh(e)};ut.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=l0(e),t=t===null?null:t.stateNode,t};ut.flushSync=function(t){return mr(t)};ut.hydrate=function(t,e,n){if(!_l(e))throw Error(R(200));return vl(null,t,e,!0,n)};ut.hydrateRoot=function(t,e,n){if(!th(t))throw Error(R(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=j_;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=z_(e,null,t,1,n??null,i,!1,s,o),t[cn]=e.current,Ps(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new ml(e)};ut.render=function(t,e,n){if(!_l(e))throw Error(R(200));return vl(null,t,e,!1,n)};ut.unmountComponentAtNode=function(t){if(!_l(t))throw Error(R(40));return t._reactRootContainer?(mr(function(){vl(null,null,t,!1,function(){t._reactRootContainer=null,t[cn]=null})}),!0):!1};ut.unstable_batchedUpdates=$f;ut.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_l(n))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return vl(t,e,n,!1,r)};ut.version="18.2.0-next-9e3b772b8-20220608";function V_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V_)}catch(t){console.error(t)}}V_(),zm.exports=ut;var nh=zm.exports,hg=nh;zu.createRoot=hg.createRoot,zu.hydrateRoot=hg.hydrateRoot;function Fs(t){"@babel/helpers - typeof";return Fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fs(t)}function Fw(t,e){if(Fs(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Fs(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dw(t){var e=Fw(t,"string");return Fs(e)==="symbol"?e:String(e)}function d(t,e,n){return e=Dw(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ua(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const rh=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),dg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);dg&&parseFloat(dg[1]);const Bw="3.4.14";function dn(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const aa=typeof process!="object"||String(process)!=="[object process]"||process.browser,Uw=typeof window<"u"&&typeof window.orientation<"u",gg=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);gg&&parseFloat(gg[1]);class zw{constructor(e,n){d(this,"name",void 0),d(this,"workerThread",void 0),d(this,"isRunning",!0),d(this,"result",void 0),d(this,"_resolve",()=>{}),d(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){dn(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){dn(this.isRunning),this.isRunning=!1,this._reject(e)}}let au=class{terminate(){}};const lu=new Map;function jw(t){dn(t.source&&!t.url||!t.source&&t.url);let e=lu.get(t.source||t.url);return e||(t.url&&(e=Vw(t.url),lu.set(t.url,e)),t.source&&(e=G_(t.source),lu.set(t.source,e))),dn(e),e}function Vw(t){if(!t.startsWith("http"))return t;const e=Gw(t);return G_(e)}function G_(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Gw(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function H_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(pg(t))r.add(t);else if(pg(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)H_(t[i],e,r)}}return n===void 0?Array.from(r):[]}function pg(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const uu=()=>{};class Oc{static isSupported(){return typeof Worker<"u"&&aa||typeof au<"u"&&!aa}constructor(e){d(this,"name",void 0),d(this,"source",void 0),d(this,"url",void 0),d(this,"terminated",!1),d(this,"worker",void 0),d(this,"onMessage",void 0),d(this,"onError",void 0),d(this,"_loadableURL","");const{name:n,source:r,url:i}=e;dn(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=uu,this.onError=s=>console.log(s),this.worker=aa?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=uu,this.onError=uu,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||H_(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=jw({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new au(r,{eval:!1})}else if(this.source)e=new au(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Hw{static isSupported(){return Oc.isSupported()}constructor(e){d(this,"name","unnamed"),d(this,"source",void 0),d(this,"url",void 0),d(this,"maxConcurrency",1),d(this,"maxMobileConcurrency",1),d(this,"onDebug",()=>{}),d(this,"reuseWorkers",!0),d(this,"props",{}),d(this,"jobQueue",[]),d(this,"idleQueue",[]),d(this,"count",0),d(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,o,a)=>s.done(a),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,o)=>s.error(o);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new zw(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Oc({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Uw?this.maxMobileConcurrency:this.maxConcurrency}}const Ww={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class rn{static isSupported(){return Oc.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rn._workerFarm=rn._workerFarm||new rn({}),rn._workerFarm.setProps(e),rn._workerFarm}constructor(e){d(this,"props",void 0),d(this,"workerPools",new Map),this.props={...Ww},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new Hw({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}d(rn,"_workerFarm",void 0);const Yw="latest";function Xw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=Yw);const o=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(r)}return dn(i),i}function $w(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bw;dn(t,"no worker provided");const n=t.version;return!(!e||!n)}function qw(t,e){return!rn.isSupported()||!aa&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function Zw(t,e,n,r,i){const s=t.id,o=Xw(t,n),l=rn.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const u=await l.startJob("process-on-worker",Kw.bind(null,i));return u.postMessage("process",{input:e,options:n,context:r}),await(await u.result).result}async function Kw(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function Qw(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function Jw(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),i=r.reduce((a,l)=>a+l.byteLength,0),s=new Uint8Array(i);let o=0;for(const a of r)s.set(a,o),o+=a.byteLength;return s.buffer}async function eT(t){const e=[];for await(const n of t)e.push(n);return Jw(...e)}let tT="";const mg={};function nT(t){for(const e in mg)if(t.startsWith(e)){const n=mg[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(tT).concat(t)),t}function rT(t){return t&&typeof t=="object"&&t.isBuffer}function W_(t){if(rT(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Y_(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function iT(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const sT=t=>typeof t=="boolean",ps=t=>typeof t=="function",Ks=t=>t!==null&&typeof t=="object",_g=t=>Ks(t)&&t.constructor==={}.constructor,oT=t=>t&&typeof t[Symbol.iterator]=="function",aT=t=>t&&typeof t[Symbol.asyncIterator]=="function",Tr=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,br=t=>typeof Blob<"u"&&t instanceof Blob,lT=t=>t&&typeof t=="object"&&t.isBuffer,uT=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Ks(t)&&ps(t.tee)&&ps(t.cancel)&&ps(t.getReader),cT=t=>Ks(t)&&ps(t.read)&&ps(t.pipe)&&sT(t.readable),X_=t=>uT(t)||cT(t),fT=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,hT=/^([-\w.]+\/[-\w.+]+)/;function dT(t){const e=hT.exec(t);return e?e[1]:t}function vg(t){const e=fT.exec(t);return e?e[1]:""}const $_=/\?.*/;function gT(t){const e=t.match($_);return e&&e[0]}function ih(t){return t.replace($_,"")}function yl(t){return Tr(t)?t.url:br(t)?t.name||"":typeof t=="string"?t:""}function sh(t){if(Tr(t)){const e=t,n=e.headers.get("content-type")||"",r=ih(e.url);return dT(n)||vg(r)}return br(t)?t.type||"":typeof t=="string"?vg(t):""}function pT(t){return Tr(t)?t.headers["content-length"]||-1:br(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function q_(t){if(Tr(t))return t;const e={},n=pT(t);n>=0&&(e["content-length"]=String(n));const r=yl(t),i=sh(t);i&&(e["content-type"]=i);const s=await vT(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function mT(t){if(!t.ok){const e=await _T(t);throw new Error(e)}}async function _T(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function vT(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=yT(n);return"data:base64,".concat(r)}return null}function yT(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function yg(t,e){if(typeof t=="string"){t=nT(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await q_(t)}function ET(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Qs(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||ET()}const Fo=globalThis.window||globalThis.self||globalThis.global,Xi=globalThis.process||{},Z_=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Qs();function wT(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let TT=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=wT(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function bT(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function ST(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function cu(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let za;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(za||(za={}));const xT=10;function Eg(t){return typeof t!="string"?t:(t=t.toUpperCase(),za[t]||za.WHITE)}function AT(t,e,n){if(!Qs&&typeof t=="string"){if(e){const r=Eg(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=Eg(n);t="\x1B[".concat(r+xT,"m").concat(t,"\x1B[49m")}}return t}function PT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function ja(t,e){if(!t)throw new Error(e||"Assertion failed")}function Mr(){let t;if(Qs()&&Fo.performance){var e,n;t=Fo==null||(e=Fo.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Xi){var r;const i=Xi==null||(r=Xi.hrtime)===null||r===void 0?void 0:r.call(Xi);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Ir={debug:Qs()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},CT={enabled:!0,level:0};function dt(){}const wg={},Tg={once:!0};let oh=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=Z_,this._startTs=Mr(),this._deltaTs=Mr(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new TT("__probe-".concat(this.id,"__"),CT),this.timeStamp("".concat(this.id," started")),PT(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Mr()-this._startTs).toPrecision(10))}getDelta(){return Number((Mr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){ja(e,n)}warn(e){return this._getLogFunction(0,e,Ir.warn,arguments,Tg)}error(e){return this._getLogFunction(0,e,Ir.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ir.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ir.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Ir.debug||Ir.info,arguments,Tg)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||dt,r&&[r],{tag:RT(n)}):dt}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?Qs()?IT({image:i,message:s,scale:o}):MT():dt}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||dt)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=bg({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||dt)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=K_(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=bg({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,ja(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Mr();const o=s.tag||s.message;if(s.once&&o)if(!wg[o])wg[o]=Mr();else return dt;return n=LT(this.id,s.message,s),r.bind(console,n,...s.args)}return dt}};oh.VERSION=Z_;function K_(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return ja(Number.isFinite(e)&&e>=0),e}function bg(t){const{logLevel:e,message:n}=t;t.logLevel=K_(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return ja(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function LT(t,e,n){if(typeof e=="string"){const r=n.time?ST(bT(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=AT(e,n.color,n.background)}return e}function MT(t){return console.warn("removed"),dt}function IT(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=cu(s,n,r);console.log(...o)},s.src=e,dt}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...cu(e,n,r)),dt;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...cu(s,n,r)),s.src=e.toDataURL(),dt}return dt}function RT(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Sg=new oh({id:"loaders.gl"});class OT{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class kT{constructor(){d(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const Q_={fetch:null,mimeType:void 0,nothrow:!1,log:new kT,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:rh,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},NT={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function J_(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const ev=()=>{const t=J_();return t.globalOptions=t.globalOptions||{...Q_},t.globalOptions};function FT(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],DT(t,n),UT(e,t,r)}function DT(t,e){xg(t,null,Q_,NT,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};xg(r,n.id,i,s,e)}}function xg(t,e,n,r,i){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const l=!e&&Ks(t[a]),u=a==="baseUri"&&!e,c=a==="workerUrl"&&e;if(!(a in n)&&!u&&!c){if(a in r)Sg.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(r[a],"'"))();else if(!l){const f=BT(a,i);Sg.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(f))()}}}}function BT(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function UT(t,e,n){const i={...t.options||{}};return zT(i,n),i.log===null&&(i.log=new OT),Ag(i,ev()),Ag(i,e),i}function Ag(t,e){for(const n in e)if(n in e){const r=e[n];_g(r)&&_g(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function zT(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function ah(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function lh(t){var e,n;Ua(t,"null loader"),Ua(ah(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const tv=()=>{const t=J_();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function jT(t){const e=tv();t=Array.isArray(t)?t:[t];for(const n of t){const r=lh(n);e.find(i=>r===i)||e.unshift(r)}}function VT(){return tv()}const GT=new oh({id:"loaders.gl"}),HT=/\.([^.]+)$/;async function WT(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!nv(t))return null;let i=Pg(t,e,{...n,nothrow:!0},r);if(i)return i;if(br(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Pg(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(rv(t));return i}function Pg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!nv(t))return null;if(e&&!Array.isArray(e))return lh(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...VT()),XT(i);const s=YT(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(rv(t));return s}function YT(t,e,n,r){const i=yl(t),s=sh(t),o=ih(i)||(r==null?void 0:r.url);let a=null,l="";if(n!=null&&n.mimeType&&(a=fu(e,n==null?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||$T(e,o),l=l||(a?"matched url ".concat(o):""),a=a||fu(e,s),l=l||(a?"matched MIME type ".concat(s):""),a=a||ZT(e,t),l=l||(a?"matched initial data ".concat(iv(t)):""),a=a||fu(e,n==null?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(s):""),l){var u;GT.log(1,"selectLoader selected ".concat((u=a)===null||u===void 0?void 0:u.name,": ").concat(l,"."))}return a}function nv(t){return!(t instanceof Response&&t.status===204)}function rv(t){const e=yl(t),n=sh(t);let r="No valid loader found (";r+=e?"".concat(Y_(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?iv(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function XT(t){for(const e of t)lh(e)}function $T(t,e){const n=e&&HT.exec(e),r=n&&n[1];return r?qT(t,r):null}function qT(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function fu(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function ZT(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(KT(e,n))return n}else if(ArrayBuffer.isView(e)){if(Cg(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Cg(e,0,n))return n;return null}function KT(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function Cg(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>QT(t,e,n,i))}function QT(t,e,n,r){if(r instanceof ArrayBuffer)return Qw(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=kc(t,e,r.length);return r===i;default:return!1}}function iv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?kc(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?kc(t,0,e):""}function kc(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const JT=256*1024;function*eb(t,e){const n=(e==null?void 0:e.chunkSize)||JT;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const tb=256*1024;function nb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=tb}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}()}const rb=1024*1024;async function*ib(t,e){const n=(e==null?void 0:e.chunkSize)||rb;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function Lg(t,e){return rh?sb(t,e):ob(t)}async function*sb(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield W_(o)}}catch{n.releaseLock()}}async function*ob(t,e){for await(const n of t)yield W_(n)}function ab(t,e){if(typeof t=="string")return eb(t,e);if(t instanceof ArrayBuffer)return nb(t,e);if(br(t))return ib(t,e);if(X_(t))return Lg(t,e);if(Tr(t))return Lg(t.body,e);throw new Error("makeIterator")}const sv="Cannot convert supplied data type";function lb(t,e,n){if(e.text&&typeof t=="string")return t;if(lT(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(sv)}async function ub(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return lb(t,e);if(br(t)&&(t=await q_(t)),Tr(t)){const i=t;return await mT(i),e.binary?await i.arrayBuffer():await i.text()}if(X_(t)&&(t=ab(t,n)),oT(t)||aT(t))return eT(t);throw new Error(sv)}function ov(t,e){const n=ev(),r=t||n;return typeof r.fetch=="function"?r.fetch:Ks(r.fetch)?i=>yg(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:yg}function cb(t,e,n){if(n)return n;const r={fetch:ov(e,t),...t};if(r.url){const i=ih(r.url);r.baseUrl=i,r.queryString=gT(r.url),r.filename=Y_(i),r.baseUrl=iT(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function fb(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function uh(t,e,n,r){dn(!r||typeof r=="object"),e&&!Array.isArray(e)&&!ah(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=yl(t),o=fb(e,r),a=await WT(t,o,n);return a?(n=FT(n,a,o,i),r=cb({url:i,parse:uh,loaders:o},n,r||null),await hb(a,t,n,r)):null}async function hb(t,e,n,r){if($w(t),Tr(e)){const i=e,{ok:s,redirected:o,status:a,statusText:l,type:u,url:c}=i,f=Object.fromEntries(i.headers.entries());r.response={headers:f,ok:s,redirected:o,status:a,statusText:l,type:u,url:c}}if(e=await ub(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(qw(t,n))return await Zw(t,e,n,r,uh);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw dn(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Va(t,e,n,r){!Array.isArray(e)&&!ah(e)&&(n=e,e=void 0);const i=ov(n);let s=t;return typeof t=="string"&&(s=await i(t)),br(t)&&(s=await i(t)),await uh(s,e,n)}const db="3.4.14",{_parseImageNode:gb}=globalThis,Nc=typeof Image<"u",Fc=typeof ImageBitmap<"u",pb=!!gb,Dc=rh?!0:pb;function mb(t){switch(t){case"auto":return Fc||Nc||Dc;case"imagebitmap":return Fc;case"image":return Nc;case"data":return Dc;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function _b(){if(Fc)return"imagebitmap";if(Nc)return"image";if(Dc)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function vb(t){const e=Eb(t);if(!e)throw new Error("Not an image");return e}function yb(t){switch(vb(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Eb(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const wb=/^data:image\/svg\+xml/,Tb=/\.svg((\?|#).*)?$/;function ch(t){return t&&(wb.test(t)||Tb.test(t))}function bb(t,e){if(ch(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return av(t,e)}function av(t,e){if(ch(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function lv(t,e,n){const r=bb(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Sb(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Sb(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const xb={};let Mg=!0;async function Ab(t,e,n){let r;ch(n)?r=await lv(t,e,n):r=av(t,n);const i=e&&e.imagebitmap;return await Pb(r,i)}async function Pb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Cb(e)||!Mg)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Mg=!1}return await createImageBitmap(t)}function Cb(t){for(const e in t||xb)return!1;return!0}function Lb(t){return!Ob(t,"ftyp",4)||!(t[8]&96)?null:Mb(t)}function Mb(t){switch(Ib(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Ib(t,e,n){return String.fromCharCode(...t.slice(e,n))}function Rb(t){return[...t].map(e=>e.charCodeAt(0))}function Ob(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Rb(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Gt=!1,ms=!0;function uv(t){const e=Js(t);return Nb(e)||Bb(e)||Fb(e)||Db(e)||kb(e)}function kb(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=Lb(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function Nb(t){const e=Js(t);return e.byteLength>=24&&e.getUint32(0,Gt)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Gt),height:e.getUint32(20,Gt)}:null}function Fb(t){const e=Js(t);return e.byteLength>=10&&e.getUint32(0,Gt)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,ms),height:e.getUint16(8,ms)}:null}function Db(t){const e=Js(t);return e.byteLength>=14&&e.getUint16(0,Gt)===16973&&e.getUint32(2,ms)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,ms),height:e.getUint32(22,ms)}:null}function Bb(t){const e=Js(t);if(!(e.byteLength>=3&&e.getUint16(0,Gt)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=Ub();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,Gt);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Gt),width:e.getUint16(s+7,Gt)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,Gt)}return null}function Ub(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Js(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function zb(t,e){const{mimeType:n}=uv(t)||{},r=globalThis._parseImageNode;return Ua(r),await r(t,n)}async function jb(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=Vb(i);let a;switch(o){case"imagebitmap":a=await Ab(t,e,s);break;case"image":a=await lv(t,e,s);break;case"data":a=await zb(t);break;default:Ua(!1)}return i==="data"&&(a=yb(a)),a}function Vb(t){switch(t){case"auto":case"data":return _b();default:return mb(t),t}}const Gb=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Hb=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Wb={image:{type:"auto",decode:!0}},Yb={id:"image",module:"images",name:"Images",version:db,mimeTypes:Hb,extensions:Gb,parse:jb,tests:[t=>!!uv(new DataView(t))],options:Wb};function cv(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function _n(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||cv()}const la={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Do=la.window||la.self||la.global,$i=la.process||{},fv=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";_n();const hu=globalThis;function hv(t){if(!t&&!_n())return"Node";if(cv(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":hu.chrome?"Chrome":hu.safari?"Safari":hu.mozInnerScreenX?"Firefox":"Unknown"}function Xb(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class $b{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";d(this,"storage",void 0),d(this,"id",void 0),d(this,"config",void 0),this.storage=Xb(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function qb(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Zb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function du(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Ga;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ga||(Ga={}));function Ig(t){return typeof t=="string"?Ga[t.toUpperCase()]||Ga.WHITE:t}function Kb(t,e,n){return!_n&&typeof t=="string"&&(e&&(e=Ig(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=Ig(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Qb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Ha(t,e){if(!t)throw new Error(e||"Assertion failed")}function Rr(){let t;if(_n&&"performance"in Do){var e,n;t=Do==null||(e=Do.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in $i){var r;const i=$i==null||(r=$i.hrtime)===null||r===void 0?void 0:r.call($i);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Or={debug:_n&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Jb={enabled:!0,level:0};function gt(){}const Rg={},Og={once:!0};class fh{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};d(this,"id",void 0),d(this,"VERSION",fv),d(this,"_startTs",Rr()),d(this,"_deltaTs",Rr()),d(this,"_storage",void 0),d(this,"userData",{}),d(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new $b("__probe-".concat(this.id,"__"),Jb),this.timeStamp("".concat(this.id," started")),Qb(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Rr()-this._startTs).toPrecision(10))}getDelta(){return Number((Rr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Ha(e,n)}warn(e){return this._getLogFunction(0,e,Or.warn,arguments,Og)}error(e){return this._getLogFunction(0,e,Or.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Or.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Or.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Or.debug||Or.info,arguments,Og)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||gt,r&&[r],{tag:rS(n)}):gt}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:o=1}=e;return this._shouldLog(n||r)?_n?nS({image:i,message:s,scale:o}):tS():gt}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||gt)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=kg({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||gt)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=dv(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=kg({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Ha(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Rr();const o=s.tag||s.message;if(s.once)if(!Rg[o])Rg[o]=Rr();else return gt;return n=eS(this.id,s.message,s),r.bind(console,n,...s.args)}return gt}}d(fh,"VERSION",fv);function dv(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Ha(Number.isFinite(e)&&e>=0),e}function kg(t){const{logLevel:e,message:n}=t;t.logLevel=dv(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Ha(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function eS(t,e,n){if(typeof e=="string"){const r=n.time?Zb(qb(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Kb(e,n.color,n.background)}return e}function tS(t){return console.warn("removed"),gt}function nS(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=du(s,n,r);console.log(...o)},s.src=e,gt}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...du(e,n,r)),gt;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...du(s,n,r)),s.src=e.toDataURL(),gt}return gt}function rS(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const K=new fh({id:"deck"});let Bc={};function iS(t){Bc=t}function Ne(t,e,n,r){K.level>0&&Bc[t]&&Bc[t].call(null,e,n,r)}function sS(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const oS={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:sS,parseTextSync:JSON.parse};function aS(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(K.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:K,_registerLoggers:iS},jT([oS,[Yb,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const lS=aS(),Q={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Q,"IDENTITY",{get:()=>(K.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Ht={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Wa={common:0,meters:1,pixels:2},Ng={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},j=new fh({id:"luma.gl"});function je(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const uS="Invalid WebGLRenderingContext",cS="Requires WebGL2";function El(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function X(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function fS(t){return X(t)?t:null}function wl(t){return je(El(t),uS),t}function De(t){return je(X(t),cS),t}const is={};function hS(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function dS(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function gS(t,e){is[t]=!0,e!==void 0&&hS(e)}function pS(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(is[r]=!0);while(r!==0);for(r in is)if(is[r])return delete is[r],parseInt(r,10);return 0}}const eo=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};eo.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};eo.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const Sr=function(e){const n=this;this.gl=e,pS(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const l=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return l.buffer;case 34338:return l.enabled;case 34339:return l.size;case 34340:return l.stride;case 34341:return l.type;case 34922:return l.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,l,u,c){const f=n.currentVertexArrayObject;f.maxAttrib=Math.max(f.maxAttrib,s);const h=f.attribs[s];return h.buffer=n.currentArrayBuffer,h.size=o,h.type=a,h.normalized=l,h.stride=u,h.offset=c,h.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{dS("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};Sr.prototype.VERTEX_ARRAY_BINDING_OES=34229;Sr.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new eo(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};Sr.prototype.createVertexArrayOES=function(){const e=new eo(this);return this.vertexArrayObjects.push(e),e};Sr.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};Sr.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof eo&&e.hasBeenBound&&e.ext===this)};Sr.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){gS(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let l=0;l<=a;l++){const u=s.attribs[l],c=i?i.attribs[l]:null;if((!i||u.enabled!==c.enabled)&&(u.enabled?r.enableVertexAttribArray.call(n,l):r.disableVertexAttribArray.call(n,l)),u.enabled){let f=!1;(!i||u.buffer!==c.buffer)&&(o!==u.buffer&&(r.bindBuffer.call(n,34962,u.buffer),o=u.buffer),f=!0),(f||u.cached!==c.cached)&&r.vertexAttribPointer.call(n,l,u.size,u.type,u.normalized,u.stride,u.offset)}}this.currentArrayBuffer!==o&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function mS(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new Sr(this)),this.__OESVertexArrayObject))}}const Fg="OES_element_index",Dg="WEBGL_draw_buffers",_S="EXT_disjoint_timer_query",vS="EXT_disjoint_timer_query_webgl2",yS="EXT_texture_filter_anisotropic",Bg="WEBGL_debug_renderer_info",ES=35723,wS=4352,TS=36795,bS=34047,SS=37445,xS=37446,te=t=>X(t)?void 0:0,AS={3074:t=>X(t)?void 0:36064,[ES]:t=>X(t)?void 0:wS,35977:te,32937:te,[TS]:(t,e)=>{const n=X(t)?t.getExtension(vS):t.getExtension(_S);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[SS]:(t,e)=>{const n=t.getExtension(Bg);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[xS]:(t,e)=>{const n=t.getExtension(Bg);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[bS]:(t,e)=>{const n=t.luma.extensions[yS];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:te,35071:te,37447:te,36063:(t,e)=>{if(!X(t)){const n=t.getExtension(Dg);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:te,35374:te,35377:te,34852:t=>{if(!X(t)){const e=t.getExtension(Dg);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(Fg)?2147483647:65535,33001:t=>t.getExtension(Fg)?16777216:65535,33e3:t=>16777216,37157:te,35373:te,35657:te,36183:te,37137:te,34045:te,35978:te,35979:te,35968:te,35376:te,35375:te,35659:te,37154:te,35371:te,35658:te,35076:te,35077:te,35380:te};function PS(t,e,n){const r=AS[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const CS="OES_vertex_array_object",gv="ANGLE_instanced_arrays",LS="WEBGL_draw_buffers",MS="EXT_disjoint_timer_query",IS="EXT_texture_filter_anisotropic",RS="VertexArray requires WebGL2 or OES_vertex_array_object extension";function OS(t,e){return{webgl2:X(t),ext:t.getExtension(e)}}const pv={[CS]:{meta:{suffix:"OES"},createVertexArray:()=>{je(!1,RS)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[gv]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){je(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[LS]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{je(!1)}},[MS]:{meta:{suffix:"EXT"},createQuery:()=>{je(!1)},deleteQuery:()=>{je(!1)},beginQuery:()=>{je(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},gu={readBuffer:(t,e,n)=>{X(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=OS(t,gv);let o;switch(r){case 35069:o=i?void 0:!1;break;case 35070:o=!i&&!s?0:void 0;break}return o!==void 0?o:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!X(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!X(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[IS];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:PS,hint(t,e,n,r){return e(n,r)}};function kS(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(mS(t),NS(t),DS(t,pv),FS(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=kS;function NS(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function FS(t,e){let{target:n,target2:r}=e;Object.keys(gu).forEach(i=>{if(typeof gu[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},o=gu[i].bind(null,t,s);n[i]=o,r[i]=o}})}function DS(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&BS(t,{extension:n,target:t.luma,target2:t})}function BS(t,e){let{extension:n,target:r,target2:i}=e;const s=pv[n];je(s);const{meta:o={}}=s,{suffix:a=""}=o,l=t.getExtension(n);for(const u of Object.keys(s)){const c="".concat(u).concat(a);let f=null;u==="meta"||typeof t[u]=="function"||(l&&typeof l[c]=="function"?f=function(){return l[c](...arguments)}:typeof s[u]=="function"&&(f=s[u].bind(r))),f&&(r[u]=f,i[u]=f)}}const hh={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},wn=(t,e,n)=>e?t.enable(n):t.disable(n),Ug=(t,e,n)=>t.hint(n,e),Ke=(t,e,n)=>t.pixelStorei(n,e),US=(t,e)=>{const n=X(t)?36009:36160;return t.bindFramebuffer(n,e)},zS=(t,e)=>t.bindFramebuffer(36008,e);function qi(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const jS={3042:wn,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:wn,2885:(t,e)=>t.cullFace(e),2929:wn,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:wn,35723:Ug,36006:US,2886:(t,e)=>t.frontFace(e),33170:Ug,2849:(t,e)=>t.lineWidth(e),32823:wn,32824:"polygonOffset",10752:"polygonOffset",35977:wn,32938:"sampleCoverage",32939:"sampleCoverage",3089:wn,3088:(t,e)=>t.scissor(...e),2960:wn,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Ke,3317:Ke,37440:Ke,37441:Ke,37443:Ke,3330:Ke,3332:Ke,3331:Ke,36010:zS,3314:Ke,32878:Ke,3316:Ke,3315:Ke,32877:Ke,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=qi(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=qi(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=qi(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=qi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=qi(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function de(t,e,n){return e[t]!==void 0?e[t]:n[t]}const VS={blendEquation:(t,e,n)=>t.blendEquationSeparate(de(32777,e,n),de(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(de(32969,e,n),de(32968,e,n),de(32971,e,n),de(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(de(32824,e,n),de(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(de(32938,e,n),de(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,de(2962,e,n),de(2967,e,n),de(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,de(34816,e,n),de(36003,e,n),de(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,de(2964,e,n),de(2965,e,n),de(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,de(34817,e,n),de(34818,e,n),de(34819,e,n))},zg={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},Bt=(t,e)=>t.isEnabled(e),jg={3042:Bt,2884:Bt,2929:Bt,3024:Bt,32823:Bt,32926:Bt,32928:Bt,3089:Bt,2960:Bt,35977:Bt};function mv(t){for(const e in t)return!1;return!0}function GS(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function Vg(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function HS(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:l,oldValue:u}=n(t.state._updateCache,...o);return l&&r(...o),u},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function WS(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class YS{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?$S(e):Object.assign({},hh),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){je(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];gn(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){je(s!==void 0);const o=e[s],a=this.cache[s];GS(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function _v(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(je(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new YS(t,{copyState:r}),WS(t);for(const s in zg){const o=zg[s];HS(t,s,o)}Vg(t,"getParameter"),Vg(t,"isEnabled")}return t.state.enable=n,t}function XS(t){t.state||_v(t,{copyState:!1}),t.state.push()}function Gg(t){je(t.state),t.state.pop()}function gn(t,e){if(je(El(t),"setParameters requires a WebGL context"),mv(e))return;const n={};for(const i in e){const s=Number(i),o=jS[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=VS[i];s(t,e,r)}}function $S(t,e){if(e=e||hh,typeof e=="number"){const i=e,s=jg[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=jg[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function qS(t){gn(t,hh)}function Rt(t,e,n){if(mv(e))return n(t);const{nocatch:r=!0}=e;XS(t),gn(t,e);let i;if(r)i=n(t),Gg(t);else try{i=n(t)}finally{Gg(t)}return i}function mi(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function pu(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=mi(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return KS(e,r,i,s,n)}function ZS(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function KS(t,e,n,r,i){const s=Hg(t[0],e,n);let o=Wg(t[1],e,r,i),a=Hg(t[0]+1,e,n);const l=a===n-1?a:a-1;a=Wg(t[1]+1,e,r,i);let u;return i?(a=a===0?a:a+1,u=o,o=a):u=a===r-1?a:a-1,{x:s,y:o,width:Math.max(l-s+1,1),height:Math.max(u-o+1,1)}}function Hg(t,e,n){return Math.min(Math.round(t*e),n-1)}function Wg(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const dh=_n(),QS=dh&&typeof document<"u",vv={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function yv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};je(dh,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},vv,t);const{width:e,height:n}=t;function r(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=r;let i;const{canvas:s}=t,o=nx({canvas:s,width:e,height:n,onError:r});return i=tx(o,t),i?(i=gh(i,t),rx(i),i):null}function gh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||ix(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},vv,e);const{manageState:n,debug:r}=e;return n&&_v(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return j.log(1,...s)()}}),dh&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),j.level=Math.max(j.level,1)):j.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function JS(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function ex(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=ZS(e.useDevicePixels);sx(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function tx(t,e){const{onError:n}=e;let r=null;const i=l=>r=l.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function nx(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(QS&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function rx(t){const e=X(t)?"WebGL2":"WebGL1",n=JS(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";j.info(1,"".concat(e).concat(i," context ").concat(r))()}function ix(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function sx(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(j.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);t.canvas.width=a,t.canvas.height=l,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==l)&&(j.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*o),t.canvas.height=Math.floor(i*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function Yg(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Xg{constructor(e,n){d(this,"name",void 0),d(this,"type",void 0),d(this,"sampleSize",1),d(this,"time",void 0),d(this,"count",void 0),d(this,"samples",void 0),d(this,"lastTiming",void 0),d(this,"lastSampleTime",void 0),d(this,"lastSampleCount",void 0),d(this,"_count",0),d(this,"_time",0),d(this,"_samples",0),d(this,"_startTime",0),d(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Yg(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Yg()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ph{constructor(e){d(this,"id",void 0),d(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof Xg?this.stats[n]=e:this.stats[n]=new Xg(n,r)),this.stats[n]}}const _s="8.5.21",ox="set luma.log.level=1 (or higher) to trace rendering";class ax{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new ph({id:e})),this.stats.get(e)}}const lr=new ax;if(globalThis.luma&&globalThis.luma.VERSION!==_s)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(_s));globalThis.luma||(_n()&&j.log(1,"luma.gl ".concat(_s," - ").concat(ox))(),globalThis.luma=globalThis.luma||{VERSION:_s,version:_s,log:j,stats:lr,globals:{modules:{},nodeIO:{}}});function lx(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function ux(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function k(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function mu(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return k(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Vn(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const _u={};function Yn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";_u[t]=_u[t]||1;const e=_u[t]++;return"".concat(t,"-").concat(e)}function $g(t){return k(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function _i(t){let e=!0;for(const n in t){e=!1;break}return e}function Ev(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(o=>{s.methodName||(s[o]=()=>{throw j.removed("Calling removed method ".concat(e,".").concat(o,": "),i)(),new Error(o)})})}const kr="Resource subclass must define virtual methods";let vn=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wl(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Yn(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=mu(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=X(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const a=i.webgl1,l="webgl2"in i?i.webgl2:i.webgl1;return s?l:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=X(this.gl),o={},a=n||Object.keys(i);for(const l of a){const u=i[l];if(u&&(!("webgl2"in u)||s)&&(!("extension"in u)||this.gl.getExtension(u.extension))){const f=r?Vn(this.gl,l):l;o[f]=this.getParameter(l,e),r&&u.type==="GLenum"&&(o[f]=Vn(this.gl,o[f]))}}return o}setParameter(e,n){e=mu(this.gl,e),k(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=X(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=mu(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return Ev(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(kr)}_deleteHandle(){throw new Error(kr)}_bindHandle(e){throw new Error(kr)}_getOptsFromHandle(){throw new Error(kr)}_getParameter(e,n){throw new Error(kr)}_setParameter(e,n){throw new Error(kr)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=lr.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];lr.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=lr.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=lr.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const cx="Failed to deduce GL constant from typed array";function Uc(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(cx)}}function Ds(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function fx(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const o=n*i;s=s||new Uint8Array(o);for(let a=0;a<r/2;++a){const l=a*o,u=(r-a-1)*o;s.set(e.subarray(l,l+o)),e.copyWithin(l,u,u+o),e.set(s,u)}}function hx(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),o=new Uint8Array(i*s*4);for(let a=0;a<s;a++)for(let l=0;l<i;l++)for(let u=0;u<4;u++)o[(a*i+l)*4+u]=e[(a*2*n+l*2)*4+u];return{data:o,width:i,height:s}}function zc(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const u=r[a]?"".concat(t,".").concat(r[a]):"N/A";j.removed("".concat(t,".").concat(a),u)()}for(const a in i)if(a in e){const l=i[a];j.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))()}let o=null;for(const a in s)if(a in e){const l=s[a];j.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(l))(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]}return o||e}const dx={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},gx={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class nt{static getBytesPerElement(e){return Ds(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return k(e.size),Ds(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new nt(dx,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return nt.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return nt.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=zc("Accessor",e,gx),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const qg=10,wv={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},px={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:wv},mx={removedProps:wv};class ee extends vn{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/nt.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/nt.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=zc("Buffer",e,px),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=zc("Buffer",e,mx),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new nt(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;k(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),i!==0||s!==void 0?(De(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(o,r,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:o}=this;return De(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,r,i,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};De(this.gl);const s=Ds(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=r;let l,u;e?(u=e.length,l=u-a):(l=Math.min(o,i||o),u=a+l);const c=Math.min(o,l);return i=i||c,k(i<=c),e=e||new s(u),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(k(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(qg,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;k(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,qg),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=Uc(e);return k(s),this.setAccessor(new nt(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;k(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Ds(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new nt(this.accessor,{type:Uc(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return j.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return j.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return j.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return j.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new nt(this.accessor,e),this}}const mh={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},Tv={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},bv={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function _x(t,e){const n=mh[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=X(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function vx(t,e){const n=mh[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const yx=[9729,9728],Zg=globalThis.WebGLBuffer||function(){};class _r extends vn{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&_x(e,r),s=s&&(!i||vx(e,r))),s}constructor(e,n){const{id:r=Yn("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(p=>this.initialize(Object.assign({},e,{pixels:p,data:p}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:o=0,recreate:a=!1,parameters:l={},pixelStore:u={},textureUnit:c=void 0}=e;n||(n=i);let{width:f,height:h,dataFormat:m,type:E,compressed:w=!1,mipmaps:S=!0}=e;const{depth:_=0}=e;return{width:f,height:h,compressed:w,dataFormat:m,type:E}=this._deduceParameters({format:s,type:E,dataFormat:m,compressed:w,data:n,width:f,height:h}),this.width=f,this.height=h,this.depth=_,this.format=s,this.type=E,this.dataFormat=m,this.border=o,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),S&&this._isNPOT()&&(j.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),S=!1,this._updateForNPOT(l)),this.mipmaps=S,this.setImageData({data:n,width:f,height:h,depth:_,format:s,type:E,dataFormat:m,border:o,mipmaps:S,parameters:u,compressed:w}),S&&this.generateMipmap(),this.setParameters(l),a&&(this.data=n),r&&(this._video={video:n,parameters:l,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(j.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Rt(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:l={}}=e;let{data:u=null,type:c=this.type,width:f=this.width,height:h=this.height,dataFormat:m=this.dataFormat,compressed:E=!1}=e;u||(u=r),{type:c,dataFormat:m,compressed:E,width:f,height:h}=this._deduceParameters({format:s,type:c,dataFormat:m,compressed:E,data:u,width:f,height:h});const{gl:w}=this;w.bindTexture(this.target,this.handle);let S=null;({data:u,dataType:S}=this._getDataType({data:u,compressed:E}));let _,p=0;if(Rt(this.gl,l,()=>{switch(S){case"null":w.texImage2D(n,i,s,f,h,o,m,c,u);break;case"typed-array":w.texImage2D(n,i,s,f,h,o,m,c,u,a);break;case"buffer":_=De(w),_.bindBuffer(35052,u.handle||u),_.texImage2D(n,i,s,f,h,o,m,c,a),_.bindBuffer(35052,null);break;case"browser-object":X(w)?w.texImage2D(n,i,s,f,h,o,m,c,u):w.texImage2D(n,i,s,m,c,u);break;case"compressed":for(const[v,b]of u.entries())w.compressedTexImage2D(n,v,b.format,b.width,b.height,o,b.data),p+=b.levelSize;break;default:k(!1,"Unknown image data type")}}),S==="compressed")this._trackAllocatedMemory(p,"Texture");else if(u&&u.byteLength)this._trackAllocatedMemory(u.byteLength,"Texture");else{const v=Tv[this.dataFormat]||4,b=bv[this.type]||1;this._trackAllocatedMemory(this.width*this.height*v*b,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:u=0,format:c=this.format,type:f=this.type,dataFormat:h=this.dataFormat,compressed:m=!1,offset:E=0,border:w=this.border,parameters:S={}}=e;if({type:f,dataFormat:h,compressed:m,width:a,height:l}=this._deduceParameters({format:c,type:f,dataFormat:h,compressed:m,data:i,width:a,height:l}),k(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const _=i;i=_.data,a=_.shape[0],l=_.shape[1]}i instanceof ee&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Rt(this.gl,S,()=>{if(m)this.gl.compressedTexSubImage2D(n,u,s,o,a,l,c,i);else if(i===null)this.gl.texSubImage2D(n,u,s,o,a,l,h,f,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,u,s,o,a,l,h,f,i,E);else if(i instanceof Zg){const _=De(this.gl);_.bindBuffer(35052,i),_.texSubImage2D(n,u,s,o,a,l,h,f,E),_.bindBuffer(35052,null)}else X(this.gl)?De(this.gl).texSubImage2D(n,u,s,o,a,l,h,f,i):this.gl.texSubImage2D(n,u,s,o,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return j.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ee?{data:n.handle,dataType:"buffer"}:n instanceof Zg?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:o,type:a,compressed:l}=e;const u=mh[n];return o=o||u&&u.dataFormat,a=a||u&&u.types[0],l=l||u&&u.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:o,type:a,compressed:l,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},k(i,"Could not deduced texture size"),k(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),k(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:k(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return X(this.gl)||!this.width||!this.height?!1:!$g(this.width)||!$g(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:yx.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let Ex="";function wx(t,e){return k(typeof t=="string"),t=Ex+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class lt extends _r{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return _r.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wl(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:wx(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const jc=[34069,34070,34071,34072,34073,34074];class Sv extends _r{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};wl(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:o=0,format:a=6408,type:l=5121}=e;const{gl:u}=this,c=i||s,f=await Promise.all(jc.map(h=>{const m=c[h];return Promise.all(Array.isArray(m)?m:[m])}));this.bind(),jc.forEach((h,m)=>{f[m].length>1&&this.opts.mipmaps!==!1&&j.warn("".concat(this.id," has mipmap and multiple LODs."))(),f[m].forEach((E,w)=>{n&&r?u.texImage2D(h,w,a,n,r,o,a,l,E):u.texImage2D(h,w,a,a,l,E)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:o,border:a=0,format:l=6408,type:u=5121}=e,{gl:c}=this,f=s||o;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},e,{face:n,data:h,pixels:h}))):this.width||this.height?c.texImage2D(n,0,l,r,i,a,l,u,f):c.texImage2D(n,0,l,l,u,f),this}}Sv.FACES=jc;class Tx extends _r{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};De(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:o=1,border:a=0,format:l,type:u=5121,offset:c=0,data:f,parameters:h={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Rt(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,f),f instanceof ee&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,n,r,i,s,o,a,l,u,c))}),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const m=Tv[this.dataFormat]||4,E=bv[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*m*E,"Texture")}return this.loaded=!0,this}}const Jn="EXT_color_buffer_float",Kg={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:Jn,bpp:2},33327:{gl2:Jn,bpp:4},34842:{gl2:Jn,bpp:8},33326:{gl2:Jn,bpp:4},33328:{gl2:Jn,bpp:8},34836:{gl2:Jn,bpp:16},35898:{gl2:Jn,bpp:4}};function bx(t,e,n){const r=n[e];if(!r)return!1;const i=X(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class Kr extends vn{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||bx(e,n,Kg)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return k(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&X(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Kg[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Sx=256,xx=1024,Ax=16384,Qg=6144,Jg=6145,ep=6146,tp=34041,xv="clear: bad arguments";function _h(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=Ax,n!==!0&&(s.clearColor=n)),r&&(o|=Sx,r!==!0&&(s.clearDepth=r)),i&&(o|=xx,r!==!0&&(s.clearStencil=r)),k(o!==0,xv),Rt(t,s,()=>{t.clear(o)})}function Px(t){let{framebuffer:e=null,buffer:n=Qg,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};De(t),Rt(t,{framebuffer:e},()=>{switch(n){case Qg:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case Jg:t.clearBufferfv(Jg,0,[i]);break;case ep:t.clearBufferiv(ep,0,[i]);break;case tp:const[s,o]=i;t.clearBufferfi(tp,0,s,o);break;default:k(!1,xv)}})}function Cx(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return k(!1),0}}function Tl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:l,sourceType:u}=e;const{framebuffer:c,deleteFramebuffer:f}=Av(t);k(c);const{gl:h,handle:m,attachments:E}=c;a=a||c.width,l=l||c.height,s===36064&&m===null&&(s=1028),k(E[s]),u=u||E[s].type,o=Mx(o,u,i,a,l),u=u||Uc(o);const w=h.bindFramebuffer(36160,m);return h.readPixels(n,r,a,l,i,u,o),h.bindFramebuffer(36160,w||null),f&&c.delete(),o}function np(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Tl(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=hx({data:r,width:i,height:s}));fx({data:r,width:i,height:s});const o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d"),l=a.createImageData(i,s);return l.data.set(r),a.putImageData(l,0,0),o.toDataURL()}function Lx(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:l,targetZ:u,width:c,height:f}=n;const{framebuffer:h,deleteFramebuffer:m}=Av(t);k(h);const{gl:E,handle:w}=h,S=typeof a<"u"||typeof l<"u"||typeof u<"u";a=a||0,l=l||0,u=u||0;const _=E.bindFramebuffer(36160,w);k(e);let p=null;if(e instanceof _r&&(p=e,c=Number.isFinite(c)?c:p.width,f=Number.isFinite(f)?f:p.height,p.bind(0),e=p.target),!S)E.copyTexImage2D(e,s,o,r,i,c,f,0);else switch(e){case 3553:case 34067:E.copyTexSubImage2D(e,s,a,l,r,i,c,f);break;case 35866:case 32879:De(E).copyTexSubImage3D(e,s,a,l,u,r,i,c,f);break}return p&&p.unbind(),E.bindFramebuffer(36160,_||null),m&&h.delete(),p}function Av(t){return t instanceof be?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:zx(t),deleteFramebuffer:!0}}function Mx(t,e,n,r,i){if(t)return t;e=e||5121;const s=Ds(e,{clamped:!1}),o=Cx(n);return new s(r*i*o)}const ae={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Ix(t){const e=new lt(t,{format:6408,type:5126,dataFormat:6408}),n=new be(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Pv={[ae.WEBGL2]:[!1,!0],[ae.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ae.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ae.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ae.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ae.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ae.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ae.FLOAT_BLEND]:["EXT_float_blend"],[ae.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ae.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ae.TEXTURE_FLOAT]:["OES_texture_float",!0],[ae.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ae.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ae.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ae.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ae.COLOR_ATTACHMENT_RGBA32F]:[Ix,"EXT_color_buffer_float"],[ae.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ae.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ae.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ae.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ae.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ae.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Rx=2;function Ox(t,e){return Cv(t,e)}function Cv(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Lv(t,n))}function kx(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Pv)t.luma.caps[e]===void 0&&(t.luma.caps[e]=Lv(t,e));return t.luma.caps}function Lv(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=Nx(t,e)),t.luma.caps[e]||j.log(Rx,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function Nx(t,e){const n=Pv[e];k(n,e);let r;const i=X(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:k(!1);return r}const rp="Multiple render targets not supported";class be extends vn{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new be(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=De(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=De(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:o=!0,stencil:a=!1,check:l=!0,readBuffer:u=void 0,drawBuffers:c=void 0}=e;if(k(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const f in i){const h=i[f];(Array.isArray(h)?h[0]:h).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,o,a,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:u,drawBuffers:c}),i&&l&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,l=a.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),a.bindFramebuffer(36160,l||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return k(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&j.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(o=>{i[o]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in i){k(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),l=i[a];let u=l;if(!u)this._unattach(a);else if(u instanceof Kr)this._attachRenderbuffer({attachment:a,renderbuffer:u});else if(Array.isArray(l)){const[c,f=0,h=0]=l;u=c,this._attachTexture({attachment:a,texture:c,layer:f,level:h})}else this._attachTexture({attachment:a,texture:u,layer:0,level:0});r&&u&&u.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Dx(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&_h(this.gl,{color:n,depth:r,stencil:i}),s.forEach((a,l)=>{Px(this.gl,{drawBuffer:l,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return j.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return j.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return j.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return j.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return j.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return j.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:o}=e;const a=De(this.gl),l=a.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,r,i,s,o),a.bindFramebuffer(36008,l),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=Vn(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const o=n?Vn(this.gl,s):s;i[o]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),o=e?Vn(this.gl,s):s;r[o]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(np(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>j.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=np(this,{targetMaxHeight:100});return j.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let o=null;return e&&(o=o||{},o[36064]=new lt(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),n&&r?(o=o||{},o[33306]=new Kr(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new Kr(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(o[36096])):r&&k(!1),o}_unattach(e){const n=this.attachments[e];n&&(n instanceof Kr?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:o}=this;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:De(o).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const l=Fx(i);o.framebufferTexture2D(36160,n,l,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:k(!1,"Illegal texture type")}o.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=fS(this.gl);n?n.readBuffer(e):k(e===36064||e===1029,rp),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=De(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):k(e.length===1&&(e[0]===36064||e[0]===1029),rp)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=kx(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function Fx(t){return t<34069?t+34069:t}function Dx(t){return(be.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Bx=[36049,36048,33296,33298,33299,33300,33301,33302,33303];be.ATTACHMENT_PARAMETERS=Bx;function Ux(t,e){k(t instanceof lt||t instanceof Sv||t instanceof Tx);const n=t.constructor,{gl:r,width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c}=t,f=Object.assign({width:i,height:s,format:o,type:a,dataFormat:l,border:u,mipmaps:c},e);return new n(r,f)}function zx(t,e){const{gl:n,width:r,height:i,id:s}=t;return new be(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{36064:t}}))}function ua(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const jx=35632,Vx=35633;function Gx(t){switch(t){case jx:return"fragment";case Vx:return"vertex";default:return"unknown type"}}function Hx(t,e,n,r){const i=t.split(/\r?\n/),s={},o={},a=r||ua(e)||"(unnamed)",l="".concat(Gx(n)," shader ").concat(a);for(let c=0;c<i.length;c++){const f=i[c];if(f.length<=1)continue;const h=f.split(":"),m=h[0],E=parseInt(h[2],10);if(isNaN(E))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));m!=="WARNING"?s[E]=f:o[E]=f}const u=Wx(e);return{shaderName:l,errors:ip(s,u),warnings:ip(o,u)}}function ip(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],o=s.split(":",3),a=o[0],l=parseInt(o[1],10)||0,u=s.substring(o.join(":").length+1).trim();n+=Mv("^^^ ".concat(a,": ").concat(u,`

`),l)}}return n}function Wx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,o)=>{const a=String(o+e),l=a.length;return Mv(a,i-l)+n+s})}function Mv(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function Iv(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Yx="Shader: GLSL source code must be a JavaScript string";class Bs extends vn{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return k(!1),"unknown"}}constructor(e,n){wl(e),k(typeof n.source=="string",Yx);const r=ua(n.source,null)||n.id||Yn("unnamed ".concat(Bs.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=ua(n,null);r&&(this.id=Yn(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Bs.getTypeName(this.shaderType),":").concat(this.id)}getName(){return ua(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:o}=Hx(r,this.source,this.shaderType,this.id);throw j.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),j.warn("GLSL compilation warnings in ".concat(i,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class vu extends Bs{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class yu extends Bs{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Xx={5126:re.bind(null,"uniform1fv",Qe,1,ke),35664:re.bind(null,"uniform2fv",Qe,2,ke),35665:re.bind(null,"uniform3fv",Qe,3,ke),35666:re.bind(null,"uniform4fv",Qe,4,ke),5124:re.bind(null,"uniform1iv",Tn,1,ke),35667:re.bind(null,"uniform2iv",Tn,2,ke),35668:re.bind(null,"uniform3iv",Tn,3,ke),35669:re.bind(null,"uniform4iv",Tn,4,ke),35670:re.bind(null,"uniform1iv",Tn,1,ke),35671:re.bind(null,"uniform2iv",Tn,2,ke),35672:re.bind(null,"uniform3iv",Tn,3,ke),35673:re.bind(null,"uniform4iv",Tn,4,ke),35674:re.bind(null,"uniformMatrix2fv",Qe,4,en),35675:re.bind(null,"uniformMatrix3fv",Qe,9,en),35676:re.bind(null,"uniformMatrix4fv",Qe,16,en),35678:Ce,35680:Ce,5125:re.bind(null,"uniform1uiv",Bo,1,ke),36294:re.bind(null,"uniform2uiv",Bo,2,ke),36295:re.bind(null,"uniform3uiv",Bo,3,ke),36296:re.bind(null,"uniform4uiv",Bo,4,ke),35685:re.bind(null,"uniformMatrix2x3fv",Qe,6,en),35686:re.bind(null,"uniformMatrix2x4fv",Qe,8,en),35687:re.bind(null,"uniformMatrix3x2fv",Qe,6,en),35688:re.bind(null,"uniformMatrix3x4fv",Qe,12,en),35689:re.bind(null,"uniformMatrix4x2fv",Qe,8,en),35690:re.bind(null,"uniformMatrix4x3fv",Qe,12,en),35678:Ce,35680:Ce,35679:Ce,35682:Ce,36289:Ce,36292:Ce,36293:Ce,36298:Ce,36299:Ce,36300:Ce,36303:Ce,36306:Ce,36307:Ce,36308:Ce,36311:Ce},$x={},qx={},Zx={},sp=[0];function vh(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(sp[0]=t,t=sp);const i=t.length;if(i%e&&j.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let o=0;o<i;o++)s[o]=t[o];return s}function Qe(t,e){return vh(t,e,Float32Array,$x)}function Tn(t,e){return vh(t,e,Int32Array,qx)}function Bo(t,e){return vh(t,e,Uint32Array,Zx)}function op(t,e,n){const r=Xx[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function Kx(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Qx(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!Jx(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function Jx(t){return Array.isArray(t)||ArrayBuffer.isView(t)?tA(t):isFinite(t)||t===!0||t===!1||t instanceof _r||t instanceof Kr?!0:t instanceof be?!!t.texture:!1}function eA(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function tA(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ce(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function re(t,e,n,r){let i=null,s=null;return(o,a,l)=>{const u=e(l,n),c=u.length;let f=!1;if(i===null)i=new Float32Array(c),s=c,f=!0;else{k(s===c,"Uniform length cannot change.");for(let h=0;h<c;++h)if(u[h]!==i[h]){f=!0;break}}return f&&(r(o,t,a,u),i.set(u)),f}}function ke(t,e,n,r){t[e](n,r)}function en(t,e,n,r){t[e](n,!1,r)}const nA=5120,rA=5121,iA=5122,sA=5123,ap=0,Uo=1,oA=2,aA=3,zo=4,lA=5,uA=6,Ee=5126,cA=35664,fA=35665,hA=35666,Zi=5124,dA=35667,gA=35668,pA=35669,Ki=5125,mA=36294,_A=36295,vA=36296,yA=35670,EA=35671,wA=35672,TA=35673,bA=35674,SA=35675,xA=35676,AA=35685,PA=35686,CA=35687,LA=35688,MA=35689,IA=35690,Vc={[Ee]:[Ee,1,"float"],[cA]:[Ee,2,"vec2"],[fA]:[Ee,3,"vec3"],[hA]:[Ee,4,"vec4"],[Zi]:[Zi,1,"int"],[dA]:[Zi,2,"ivec2"],[gA]:[Zi,3,"ivec3"],[pA]:[Zi,4,"ivec4"],[Ki]:[Ki,1,"uint"],[mA]:[Ki,2,"uvec2"],[_A]:[Ki,3,"uvec3"],[vA]:[Ki,4,"uvec4"],[yA]:[Ee,1,"bool"],[EA]:[Ee,2,"bvec2"],[wA]:[Ee,3,"bvec3"],[TA]:[Ee,4,"bvec4"],[bA]:[Ee,8,"mat2"],[AA]:[Ee,8,"mat2x3"],[PA]:[Ee,8,"mat2x4"],[SA]:[Ee,12,"mat3"],[CA]:[Ee,12,"mat3x2"],[LA]:[Ee,12,"mat3x4"],[xA]:[Ee,16,"mat4"],[MA]:[Ee,16,"mat4x2"],[IA]:[Ee,16,"mat4x3"]};function RA(t){switch(t){case ap:return ap;case Uo:return Uo;case aA:return Uo;case oA:return Uo;case zo:return zo;case lA:return zo;case uA:return zo;default:return k(!1),0}}function lp(t){const e=Vc[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function Rv(t,e){switch(t){case nA:case rA:case iA:case sA:t=Ee;break}for(const n in Vc){const[r,i,s]=Vc[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class OA{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,i),l=n.getAttribLocation(e.handle,s);l>=0&&this._addAttribute(l,s,o,a)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!X(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,o,a)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:o}=lp(r),a={type:s,size:i*o};this._inferProperties(e,n,a);const l={location:e,name:n,accessor:new nt(a)};this.attributeInfos.push(l),this.attributeInfosByLocation[e]=l,this.attributeInfosByName[l.name]=l}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:o}=lp(r),a=new nt({type:s,size:i*o}),l={location:e,name:n,accessor:a};this.varyingInfos.push(l),this.varyingInfosByName[l.name]=l}}const up=4,kA=35981,NA=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Ov extends vn{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",NA),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:o=kA}=e;return this.hash=n||"",this.vs=typeof r=="string"?new vu(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new yu(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,k(this.vs instanceof vu),k(this.fs instanceof yu),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(De(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new OA(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:o,end:a,isIndexed:l=!1,indexType:u=5123,instanceCount:c=0,isInstanced:f=c>0,vertexArray:h=null,transformFeedback:m,framebuffer:E,parameters:w={},uniforms:S,samplers:_}=e;if((S||_)&&(j.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(S||{})),j.priority>=n){const p=E?E.id:"default",v="mode=".concat(Vn(this.gl,r)," verts=").concat(i," ")+"instances=".concat(c," indexType=").concat(Vn(this.gl,u)," ")+"isInstanced=".concat(f," isIndexed=").concat(l," ")+"Framebuffer=".concat(p);j.log(n,v)()}return k(h),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||f&&c===0?!1:(h.bindForDraw(i,c,()=>{if(E!==void 0&&(w=Object.assign({},w,{framebuffer:E})),m){const p=RA(r);m.begin(p)}this._bindTextures(),Rt(this.gl,w,()=>{l&&f?this.gl2.drawElementsInstanced(r,i,u,s,c):l&&X(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(r,o,a,i,u,s):l?this.gl.drawElements(r,i,u,s):f?this.gl2.drawArraysInstanced(r,s,i,c):this.gl.drawArrays(r,s,i)}),m&&m.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};j.priority>=2&&Qx(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,o=!1;if(s instanceof be&&(s=s.texture),s instanceof _r)if(o=this.uniforms[n]!==r,o){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:l}=i;a.bind(l),s=l,this._textureUniforms[n]=a}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||o)&&eA(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new vu({handle:i});break;case 35632:r.fs=new yu({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Yn(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),j.time(up,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),j.timeEnd(up,"linkProgram for ".concat(this._getName()))(),e.debug||j.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=Kx(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=op(e,s,r),r.size>1)for(let o=0;o<r.size;o++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(o,"]")),this._uniformSetters["".concat(i,"[").concat(o,"]")]=op(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const FA=34918,DA=34919,BA=35007,UA=36795,zA=35976,jA=35887,VA=36202;class Ya extends vn{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=X(e),i=Cv(e,ae.TIMER_QUERY);let s=r||i;for(const o of n)switch(o){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:k(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(BA)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?VA:jA)}beginTransformFeedbackQuery(){return this.begin(zA)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,DA);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(UA)}getResult(){return this.gl2.getQueryParameter(this.handle,FA)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Ya.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class kv extends vn{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};De(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,_i(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:o}=this._getBufferParams(n);return r<0?(this.unused[e]=i,j.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ee?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let jo=null;function GA(t){return(!jo||jo.byteLength<t)&&(jo=new ArrayBuffer(t)),jo}function HA(t,e){const n=GA(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function WA(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return e}const YA="elements must be GL.ELEMENT_ARRAY_BUFFER";class Je extends vn{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?X(e)||hv()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Je(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Je.MAX_ATTRIBUTES=Je.MAX_ATTRIBUTES||e.getParameter(34921),Je.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Je._setConstantFloatArray(e,n,r);break;case Int32Array:Je._setConstantIntArray(e,n,r);break;case Uint32Array:Je._setConstantUintArray(e,n,r);break;default:k(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Je.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return k(!e||e.target===34963,YA),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:o,offset:a,normalized:l,integer:u,divisor:c}=r,{gl:f,gl2:h}=this;return e=Number(e),this.bind(()=>{f.bindBuffer(34962,n.handle),u?(k(X(f)),h.vertexAttribIPointer(e,i,s,o,a)):f.vertexAttribPointer(e,i,s,l,o,a),f.enableVertexAttribArray(e),h.vertexAttribDivisor(e,c||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Je.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new ee(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(r,this.bufferValue),o){const a=HA(n.constructor,s);WA({target:a,source:r,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:k(!1)}}static _setConstantIntArray(e,n,r){switch(k(X(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:k(!1)}}static _setConstantUintArray(e,n,r){switch(k(X(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:k(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return k(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const XA="VertexArray: attributes must be Buffers or constants (i.e. typed array)",$A=/^(.+)__LOCATION_([0-9]+)$/,qA=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class ZA{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Je(e),Ev(this,"VertexArray","v6.0",qA),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ee(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ee&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ee&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,j.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const l=this._getAttributeInfo(a||o);if(!l)return s;const u=this.accessors[o]||{},c=nt.resolve(l.accessor,u,r,i),{size:f,type:h}=c;return k(Number.isFinite(f)&&Number.isFinite(h)),{location:o,accessor:c}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=$A.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ee)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ee){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ee){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(XA)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Je.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Je.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,o=s>0;if(e.isInstanced=e.isInstanced||o,r instanceof ee){const a=r;if(o){const l=a.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,l)}else{const l=a.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,l)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return j.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function KA(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=",".concat(o%r===0?" ":"")),i+=Us(t[o],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Us(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return KA(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function cp(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;k(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,l={},u=Object.keys(a).sort();let c=0;for(const m of u)!m.match(s)&&!m.match(o)&&Eu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;for(const m of u)m.match(o)&&Eu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;for(const m of u)l[m]||Eu({table:l,header:e,uniforms:r,uniformName:m,undefinedOnly:i})&&c++;let f=0;const h={};if(!i)for(const m in r){const E=r[m];l[m]||(f++,h[m]={Type:"NOT USED: ".concat(E),[e]:Us(E)})}return{table:l,count:c,unusedTable:h,unusedCount:f}}function Eu(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const o=r[i],a=QA(o);return!s||!a?(e[i]={[n]:a?Us(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function QA(t){return t!=null}function JA(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=fp(e,e.elements,null,n));const i=e.values;for(const s in i){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const l=e.accessors[o.location];l&&(a="".concat(s,": ").concat(eP(o.name,l))),r[a]=fp(e,i[s],l,n)}}return r}function fp(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,l=0,u,c,f;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),u=s.indexOf("nt")!==-1),e instanceof ee){const h=e,{data:m,changed:E}=h.getDebugData();c=E?"*":"",f=m,l=h.byteLength,a=l/m.BYTES_PER_ELEMENT/o;let w;if(n){const S=n.divisor>0;w="".concat(S?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(l," bytes ").concat(Vn(i,s),")")}else u=!0,w="".concat(l," bytes");return{[r]:"".concat(c).concat(Us(f,{size:o,isInteger:u})),"Format ":w}}return f=e,o=e.length,s=String(e.constructor.name).replace("Array",""),u=s.indexOf("nt")!==-1,{[r]:"".concat(Us(f,{size:o,isInteger:u})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function eP(t,e){const{type:n,size:r}=e,i=Rv(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function tP(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=hp(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=hp(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function hp(t){const{type:e,size:n}=t.accessor,r=Rv(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const dp=_n()&&typeof document<"u";let nP=0;class rP{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=S=>yv(S),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:l=null,glOptions:u={},debug:c=!1,createFramebuffer:f=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:m=!0,stats:E=lr.get("animation-loop-".concat(nP++))}=e;let{useDevicePixels:w=!0}=e;"useDevicePixelRatio"in e&&(j.deprecated("useDevicePixelRatio","useDevicePixels")(),w=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:o,onError:a,gl:l,glOptions:u,debug:c,createFramebuffer:f},this.gl=l,this.needsRedraw=null,this.timeline=null,this.stats=E,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:m,useDevicePixels:w}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return k(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Ya.isSupported(this.gl,["timers"])?new Ya(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return j.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=dp?new Promise((e,n)=>{if(dp&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):ux(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):lx(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?gh(this.props.gl,e):this.onCreateContext(e),!El(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");qS(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&ex(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new be(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const to="vs",yh="fs";function ot(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const wu={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function iP(t){const e={};for(const n in t){const r=t[n],i=sP(r);e[n]=i}return e}function sP(t){let e=gp(t);return e==="object"?t?"type"in t?Object.assign({},t,wu[t.type]):"value"in t?(e=gp(t.value),Object.assign({type:e},t,wu[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},wu[e])}function gp(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const oP="vs",aP="fs";class pp{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:l=[],defines:u={},inject:c={},vertexShader:f,fragmentShader:h}=e;ot(typeof n=="string"),this.name=n,this.vs=r||f,this.fs=i||h,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(l),this.defines=u,this.injections=lP(c),o&&(this.uniforms=iP(o))}getModuleSource(e){let n;switch(e){case oP:n=this.vs||"";break;case aP:n=this.fs||"";break;default:ot(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&ot(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function lP(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function uP(t){return cP(Fv(t))}function cP(t){const e={},n={};return Nv({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Nv(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Nv({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function Fv(t,e){return t.map(n=>(n instanceof pp||(ot(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),ot(n.name,"shader module has no name"),n=new pp(n),n.dependencies=Fv(n.dependencies)),n))}function fP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const hP=7936,dP=7937,gP=7938,pP=35724,Eh={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ir={};Object.keys(Eh).forEach(t=>{ir[t]=t});function mP(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function _P(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||hP),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||dP);return{gpuVendor:vP(n,r),vendor:n,renderer:r,version:t.getParameter(gP),shadingLanguageVersion:t.getParameter(pP)}}function vP(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const Tu={};function mp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=Eh[e];if(ot(r,e),!fP(n))return!0;if(e in Tu)return Tu[e];const i=r[0],s=n.behavior||"enable",o="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),Tu[e]=l,l}function yP(t,e){const n=Eh[e];ot(n,e);const r=mP(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return ot(i===!1||i===!0),i}function Vo(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>yP(t,n))}function EP(t){switch(_P(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function wP(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Vo(t,ir.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Vo(t,ir.GLSL_DERIVATIVES)&&mp(t,ir.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Vo(t,ir.GLSL_FRAG_DATA)&&mp(t,ir.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Vo(t,ir.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const TP=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,bP=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,SP={[to]:TP,[yh]:bP},ca="__LUMA_INJECT_DECLARATIONS__",_p=/void\s+main\s*\([^)]*\)\s*\{\n?/,vp=/}\n?[^{}]*$/,bu=[];function yp(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===to;for(const s in n){const o=n[s];o.sort((l,u)=>l.order-u.order),bu.length=o.length;for(let l=0,u=o.length;l<u;++l)bu[l]=o[l].injection;const a="".concat(bu.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(ca,a));break;case"vs:#main-start":i&&(t=t.replace(_p,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(vp,l=>a+l));break;case"fs:#decl":i||(t=t.replace(ca,a));break;case"fs:#main-start":i||(t=t.replace(_p,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(vp,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(ca,""),r&&(t=t.replace(/\}\s*$/,s=>s+SP[e])),t}function Gc(t){const e={};return ot(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function vi(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Dv=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],xP=[...Dv,[vi("attribute"),"in $1"],[vi("varying"),"out $1"]],AP=[...Dv,[vi("varying"),"in $1"]],Bv=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],PP=[...Bv,[vi("in"),"attribute $1"],[vi("out"),"varying $1"]],CP=[...Bv,[vi("in"),"varying $1"]],Hc="gl_FragColor",Wc=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,LP=/void\s+main\s*\([^)]*\)\s*\{\n?/;function MP(t,e,n){switch(e){case 300:return n?Xa(t,xP):IP(t);case 100:return n?Xa(t,PP):RP(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Xa(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function IP(t){t=Xa(t,AP);const e=t.match(Wc);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Hc,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(LP,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Hc,"\\b"),"g"),n)}return t}function RP(t){t=Xa(t,CP);const e=t.match(Wc);if(e){const n=e[1];t=t.replace(Wc,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Hc)}return t}const OP=`

`.concat(ca,`

`),Uv={[to]:"vertex",[yh]:"fragment"},kP=`precision highp float;

`;function NP(t,e){const{vs:n,fs:r}=e,i=uP(e.modules||[]);return{gl:t,vs:Ep(t,Object.assign({},e,{source:n,type:to,modules:i})),fs:Ep(t,Object.assign({},e,{source:r,type:yh,modules:i})),getUniforms:FP(i)}}function Ep(t,e){let{id:n,source:r,type:i,modules:s,defines:o={},hookFunctions:a=[],inject:l={},transpileToGLSL100:u=!1,prologue:c=!0,log:f}=e;ot(typeof r=="string","shader source must be a string");const h=i===to,m=r.split(`
`);let E=100,w="",S=r;m[0].indexOf("#version ")===0?(E=300,w=m[0],S=m.slice(1).join(`
`)):w="#version ".concat(E);const _={};s.forEach(L=>{Object.assign(_,L.getDefines())}),Object.assign(_,o);let p=c?"".concat(w,`
`).concat(BP({id:n,source:r,type:i}),`
`).concat(DP({type:i}),`
`).concat(EP(t),`
`).concat(wP(t),`
`).concat(UP(_),`
`).concat(h?"":kP,`
`):"".concat(w,`
`);const v=jP(a),b={},x={},P={};for(const L in l){const M=typeof l[L]=="string"?{injection:l[L],order:0}:l[L],C=L.match(/^(v|f)s:(#)?([\w-]+)$/);if(C){const O=C[2],U=C[3];O?U==="decl"?x[L]=[M]:P[L]=[M]:b[L]=[M]}else P[L]=[M]}for(const L of s){f&&L.checkDeprecations(S,f);const M=L.getModuleSource(i,E);p+=M;const C=L.injections[i];for(const O in C){const U=O.match(/^(v|f)s:#([\w-]+)$/);if(U){const G=U[2]==="decl"?x:P;G[O]=G[O]||[],G[O].push(C[O])}else b[O]=b[O]||[],b[O].push(C[O])}}return p+=OP,p=yp(p,i,x),p+=zP(v[i],b),p+=S,p=yp(p,i,P),p=MP(p,u?100:E,h),p}function FP(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function DP(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(Uv[e].toUpperCase(),`
`)}function BP(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(Uv[r],`

`):""}function UP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function zP(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function jP(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),o=n.replace(/\(.+/,"");e[i][o]=Object.assign(r,{signature:s})}),e}const VP="void main() {gl_FragColor = vec4(0);}",zv=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,GP=`#version 300 es
`.concat(zv);function jv(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const o=s.split(";")[0];return{qualifier:r,type:i,name:o}}function Vv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?GP:e>300?"#version ".concat(e,`
`).concat(zv):VP;const s=YP(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function HP(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ot(!1),null}}function WP(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ot(!1),null}}function YP(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return ot(!1),null}}const XP=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,$P={name:"fp32",vs:XP,fs:null};function wp(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const it={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function qP(t,{precision:e=it.precision}={}){return t=ZP(t),"".concat(parseFloat(t.toPrecision(e)))}function yi(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rn(t,e,n){return QP(t,r=>Math.max(e,Math.min(n,r)))}function $a(t,e,n){return yi(t)?t.map((r,i)=>$a(r,e[i],n)):n*e+(1-n)*t}function zs(t,e,n){const r=it.EPSILON;n&&(it.EPSILON=n);try{if(t===e)return!0;if(yi(t)&&yi(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!zs(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=it.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{it.EPSILON=r}}function ZP(t){return Math.round(t/it.EPSILON)*it.EPSILON}function KP(t){return t.clone?t.clone():new Array(t.length)}function QP(t,e,n){if(yi(t)){const r=t;n=n||KP(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function JP(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class Gv extends JP(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:yi(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(it)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+qP(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!zs(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(it.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function e2(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function tt(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Su(t,e,n=""){if(it.debug&&!e2(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class t2 extends Gv{get x(){return this[0]}set x(e){this[0]=tt(e)}get y(){return this[1]}set y(e){this[1]=tt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return tt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return tt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return wp(e>=0&&e<this.ELEMENTS,"index is out of range"),tt(this[e])}setComponent(e,n){return wp(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var fa=1e-6,Ei=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function n2(){var t=new Ei(2);return Ei!=Float32Array&&(t[0]=0,t[1]=0),t}function Tp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function r2(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Hv(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function i2(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=n2();return function(e,n,r,i,s,o){var a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function s2(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function Wv(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function o2(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function a2(){var t=new Ei(3);return Ei!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function l2(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u2(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function c2(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function f2(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function Yv(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function h2(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function d2(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],u=e[2],c=i*u-s*l,f=s*a-r*u,h=r*l-i*a,m=i*h-s*f,E=s*c-r*h,w=r*f-i*c,S=o*2;return c*=S,f*=S,h*=S,m*=2,E*=2,w*=2,t[0]=a+c+m,t[1]=l+f+E,t[2]=u+h+w,t}function g2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function p2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function m2(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function _2(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt(n*n+r*r+i*i),u=Math.sqrt(s*s+o*o+a*a),c=l*u,f=c&&c2(t,e)/c;return Math.acos(Math.min(Math.max(f,-1),1))}var v2=l2;(function(){var t=a2();return function(e,n,r,i,s,o){var a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const xu=[0,0,0];let Go;class $t extends t2{static get ZERO(){return Go||(Go=new $t(0,0,0),Object.freeze(Go)),Go}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&yi(e)?this.copy(e):(it.debug&&(tt(e),tt(n),tt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return it.debug&&(tt(e.x),tt(e.y),tt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=tt(e)}angle(e){return _2(this,e)}cross(e){return f2(this,this,e),this.check()}rotateX({radians:e,origin:n=xu}){return g2(this,this,n,e),this.check()}rotateY({radians:e,origin:n=xu}){return p2(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=xu}){return m2(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Yv(this,this,e),this.check()}transformAsVector(e){return Wv(this,this,e),this.check()}transformByMatrix3(e){return h2(this,this,e),this.check()}transformByMatrix2(e){return o2(this,this,e),this.check()}transformByQuaternion(e){return d2(this,this,e),this.check()}}class y2 extends Gv{toString(){let e="[";if(it.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=tt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function E2(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function w2(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Yc(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],f=e[9],h=e[10],m=e[11],E=e[12],w=e[13],S=e[14],_=e[15],p=n*a-r*o,v=n*l-i*o,b=n*u-s*o,x=r*l-i*a,P=r*u-s*a,L=i*u-s*l,M=c*w-f*E,C=c*S-h*E,O=c*_-m*E,U=f*S-h*w,H=f*_-m*w,G=h*_-m*S,q=p*G-v*H+b*U+x*O-P*C+L*M;return q?(q=1/q,t[0]=(a*G-l*H+u*U)*q,t[1]=(i*H-r*G-s*U)*q,t[2]=(w*L-S*P+_*x)*q,t[3]=(h*P-f*L-m*x)*q,t[4]=(l*O-o*G-u*C)*q,t[5]=(n*G-i*O+s*C)*q,t[6]=(S*b-E*L-_*v)*q,t[7]=(c*L-h*b+m*v)*q,t[8]=(o*H-a*O+u*M)*q,t[9]=(r*O-n*H-s*M)*q,t[10]=(E*P-w*b+_*p)*q,t[11]=(f*b-c*P-m*p)*q,t[12]=(a*C-o*U-l*M)*q,t[13]=(n*U-r*C+i*M)*q,t[14]=(w*v-E*x-S*p)*q,t[15]=(c*x-f*v+h*p)*q,t):null}function T2(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11],m=t[12],E=t[13],w=t[14],S=t[15],_=e*o-n*s,p=e*a-r*s,v=e*l-i*s,b=n*a-r*o,x=n*l-i*o,P=r*l-i*a,L=u*E-c*m,M=u*w-f*m,C=u*S-h*m,O=c*w-f*E,U=c*S-h*E,H=f*S-h*w;return _*H-p*U+v*O+b*C-x*M+P*L}function fr(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],f=e[8],h=e[9],m=e[10],E=e[11],w=e[12],S=e[13],_=e[14],p=e[15],v=n[0],b=n[1],x=n[2],P=n[3];return t[0]=v*r+b*a+x*f+P*w,t[1]=v*i+b*l+x*h+P*S,t[2]=v*s+b*u+x*m+P*_,t[3]=v*o+b*c+x*E+P*p,v=n[4],b=n[5],x=n[6],P=n[7],t[4]=v*r+b*a+x*f+P*w,t[5]=v*i+b*l+x*h+P*S,t[6]=v*s+b*u+x*m+P*_,t[7]=v*o+b*c+x*E+P*p,v=n[8],b=n[9],x=n[10],P=n[11],t[8]=v*r+b*a+x*f+P*w,t[9]=v*i+b*l+x*h+P*S,t[10]=v*s+b*u+x*m+P*_,t[11]=v*o+b*c+x*E+P*p,v=n[12],b=n[13],x=n[14],P=n[15],t[12]=v*r+b*a+x*f+P*w,t[13]=v*i+b*l+x*h+P*S,t[14]=v*s+b*u+x*m+P*_,t[15]=v*o+b*c+x*E+P*p,t}function qa(t,e,n){var r=n[0],i=n[1],s=n[2],o,a,l,u,c,f,h,m,E,w,S,_;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],f=e[5],h=e[6],m=e[7],E=e[8],w=e[9],S=e[10],_=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=f,t[6]=h,t[7]=m,t[8]=E,t[9]=w,t[10]=S,t[11]=_,t[12]=o*r+c*i+E*s+e[12],t[13]=a*r+f*i+w*s+e[13],t[14]=l*r+h*i+S*s+e[14],t[15]=u*r+m*i+_*s+e[15]),t}function wh(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function b2(t,e,n,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),l,u,c,f,h,m,E,w,S,_,p,v,b,x,P,L,M,C,O,U,H,G,q,Tt;return a<fa?null:(a=1/a,i*=a,s*=a,o*=a,l=Math.sin(n),u=Math.cos(n),c=1-u,f=e[0],h=e[1],m=e[2],E=e[3],w=e[4],S=e[5],_=e[6],p=e[7],v=e[8],b=e[9],x=e[10],P=e[11],L=i*i*c+u,M=s*i*c+o*l,C=o*i*c-s*l,O=i*s*c-o*l,U=s*s*c+u,H=o*s*c+i*l,G=i*o*c+s*l,q=s*o*c-i*l,Tt=o*o*c+u,t[0]=f*L+w*M+v*C,t[1]=h*L+S*M+b*C,t[2]=m*L+_*M+x*C,t[3]=E*L+p*M+P*C,t[4]=f*O+w*U+v*H,t[5]=h*O+S*U+b*H,t[6]=m*O+_*U+x*H,t[7]=E*O+p*U+P*H,t[8]=f*G+w*q+v*Tt,t[9]=h*G+S*q+b*Tt,t[10]=m*G+_*q+x*Tt,t[11]=E*G+p*q+P*Tt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Xv(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+u*r,t[5]=o*i+c*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=u*i-s*r,t[9]=c*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function S2(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-u*r,t[1]=o*i-c*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+u*i,t[9]=o*r+c*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function $v(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+u*r,t[1]=o*i+c*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=u*i-s*r,t[5]=c*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function x2(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,u=n*o,c=r*o,f=r*a,h=i*o,m=i*a,E=i*l,w=s*o,S=s*a,_=s*l;return t[0]=1-f-E,t[1]=c+_,t[2]=h-S,t[3]=0,t[4]=c-_,t[5]=1-u-E,t[6]=m+w,t[7]=0,t[8]=h+S,t[9]=m-w,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A2(t,e,n,r,i,s,o){var a=1/(n-e),l=1/(i-r),u=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*u,t[15]=0,t}function P2(t,e,n,r,i){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}var C2=P2;function L2(t,e,n,r,i,s,o){var a=1/(e-n),l=1/(r-i),u=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*u,t[15]=1,t}var M2=L2;function I2(t,e,n,r){var i,s,o,a,l,u,c,f,h,m,E=e[0],w=e[1],S=e[2],_=r[0],p=r[1],v=r[2],b=n[0],x=n[1],P=n[2];return Math.abs(E-b)<fa&&Math.abs(w-x)<fa&&Math.abs(S-P)<fa?E2(t):(c=E-b,f=w-x,h=S-P,m=1/Math.hypot(c,f,h),c*=m,f*=m,h*=m,i=p*h-v*f,s=v*c-_*h,o=_*f-p*c,m=Math.hypot(i,s,o),m?(m=1/m,i*=m,s*=m,o*=m):(i=0,s=0,o=0),a=f*o-h*s,l=h*i-c*o,u=c*s-f*i,m=Math.hypot(a,l,u),m?(m=1/m,a*=m,l*=m,u*=m):(a=0,l=0,u=0),t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=s,t[5]=l,t[6]=f,t[7]=0,t[8]=o,t[9]=u,t[10]=h,t[11]=0,t[12]=-(i*E+s*w+o*S),t[13]=-(a*E+l*w+u*S),t[14]=-(c*E+f*w+h*S),t[15]=1,t)}function R2(){var t=new Ei(4);return Ei!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function O2(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function no(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){var t=R2();return function(e,n,r,i,s,o){var a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var Xc;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(Xc||(Xc={}));const k2=45*Math.PI/180,N2=1,Au=.1,Pu=500,F2=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class qt extends y2{static get IDENTITY(){return B2()}static get ZERO(){return D2()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Xc}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,u,c,f,h,m,E,w,S){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=u,this[9]=c,this[10]=f,this[11]=h,this[12]=m,this[13]=E,this[14]=w,this[15]=S,this.check()}setRowMajor(e,n,r,i,s,o,a,l,u,c,f,h,m,E,w,S){return this[0]=e,this[1]=s,this[2]=u,this[3]=m,this[4]=n,this[5]=o,this[6]=c,this[7]=E,this[8]=r,this[9]=a,this[10]=f,this[11]=w,this[12]=i,this[13]=l,this[14]=h,this[15]=S,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(F2)}fromObject(e){return this.check()}fromQuaternion(e){return x2(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=Au,far:a=Pu}=e;return a===1/0?U2(this,n,r,i,s,o):A2(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return I2(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=Au,far:a=Pu}=e;return M2(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=k2,aspect:r=N2,focalDistance:i=1,near:s=Au,far:o=Pu}=e;bp(n);const a=n/2,l=i*Math.tan(a),u=l*r;return this.ortho({left:-u,right:u,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return bp(n),C2(this,n,r,i,s),this.check()}determinant(){return T2(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return w2(this,this),this.check()}invert(){return Yc(this,this),this.check()}multiplyLeft(e){return fr(this,e,this),this.check()}multiplyRight(e){return fr(this,this,e),this.check()}rotateX(e){return Xv(this,this,e),this.check()}rotateY(e){return S2(this,this,e),this.check()}rotateZ(e){return $v(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return b2(this,this,e,n),this.check()}scale(e){return wh(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return qa(this,this,e),this.check()}transform(e,n){return e.length===4?(n=no(n||[-0,-0,-0,-0],e,this),Su(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=i2(n||[-0,-0],e,this);break;case 3:i=Yv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Su(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=s2(n||[-0,-0],e,this);break;case 3:r=Wv(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Su(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let Ho,Wo;function D2(){return Ho||(Ho=new qt([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Ho)),Ho}function B2(){return Wo||(Wo=new qt,Object.freeze(Wo)),Wo}function bp(t){if(t>Math.PI*2)throw Error("expected radians")}function U2(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),u=(i+r)/(i-r),c=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=c,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}const z2=new Uint8Array([0,255,255,255]),j2={pickingSelectedColor:null,pickingHighlightColor:z2,pickingActive:!1,pickingAttribute:!1};function V2(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j2;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const G2=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,H2=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,W2={name:"picking",vs:G2,fs:H2,getUniforms:V2},Y2=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,X2={name:"transform",vs:Y2,fs:null};class ro{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new ro(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:l=!1}=e,u=this._getModuleList(e.modules),c=this._getHash(n),f=this._getHash(r),h=u.map(v=>this._getHash(v.name)).sort(),m=o.map(v=>this._getHash(v)),E=Object.keys(i).sort(),w=Object.keys(s).sort(),S=[],_=[];for(const v of E)S.push(this._getHash(v)),S.push(this._getHash(i[v]));for(const v of w)_.push(this._getHash(v)),_.push(this._getHash(s[v]));const p="".concat(c,"/").concat(f,"D").concat(S.join("/"),"M").concat(h.join("/"),"I").concat(_.join("/"),"V").concat(m.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(l?"T":"");if(!this._programCache[p]){const v=NP(this.gl,{vs:n,fs:r,modules:u,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:l});this._programCache[p]=new Ov(this.gl,{hash:p,vs:v.vs,fs:v.fs,varyings:o,bufferMode:a}),this._getUniforms[p]=v.getUniforms||(b=>{}),this._useCounts[p]=0}return this._useCounts[p]++,this._programCache[p]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,n}}const $2={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function q2(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=Z2(s,n);if(s==="indices")i=o;else if(o.constant)r[a]=o.value;else{const l=o.value,u={...o};delete u.value,r[a]=[new ee(t,l),u],K2(s,u)}}if(i){const s=i.value||i;k(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ee(t,{data:s,target:34963}),o]}return r}function Z2(t,e){const{attributeMap:n=$2}=e||{};return n&&n[t]||t}function K2(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}k(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Nr=2,Q2=1e4,J2="Model needs drawMode and vertexCount",Sp=()=>{},eC={};class Th{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Yn("model")}=n;k(El(e)),this.id=r,this.gl=e,this.id=n.id||Yn("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||ro.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},k(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),J2)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:o,inject:a,varyings:l,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return k(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return k(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=q2(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_i(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return _h(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:l=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let u;j.priority>=Nr&&(u=this._logDrawCallStart(Nr));const c=this.vertexArray.getDrawParams(),{isIndexed:f=c.isIndexed,indexType:h=c.indexType,indexOffset:m=c.indexOffset,vertexArrayInstanced:E=c.isInstanced}=this.props;E&&!this.isInstanced&&j.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:w,instanceCount:S}=this,{onBeforeRender:_=Sp,onAfterRender:p=Sp}=this.props;_(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(eC,e,{logPriority:u,uniforms:null,framebuffer:r,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:l,transformFeedback:o,isIndexed:f,indexType:h,isInstanced:w,instanceCount:S,offset:f?m:0}));return p(),j.priority>=Nr&&this._logDrawCallEnd(u,l,r),v}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{35977:n})),i.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return j.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:o,defines:a,varyings:l,bufferMode:u,transpileToGLSL100:c}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}k(n instanceof Ov,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new ZA(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ee&&n.delete()}}_setAnimationProps(e){this.animated&&k(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_i(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new kv(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Q2;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),j.group(Nr,">>> DRAWING MODEL ".concat(this.id),{collapsed:j.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=JA({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:l}=cp({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:u,count:c}=cp({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});c>0&&j.log("MISSING UNIFORMS",Object.keys(u))(),l>0&&j.log("UNUSED UNIFORMS",Object.keys(a))();const f=tP(this.vertexArray.configuration);j.table(e,s)(),j.table(e,o)(),j.table(e+1,f)(),i&&i.log({logLevel:Nr,message:"Rendered to ".concat(i.id)}),j.groupEnd(Nr)()}}class tC{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ee?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&k(X(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:l,accessor:u}=o;r[i]=this._createNewBuffer(i,{byteLength:a,usage:l,accessor:u})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new kv(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],k(r[s]instanceof ee)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ee(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const nC="transform_uSampler_",Za="transform_uSize_",xp="transform_position";function rC(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,o=Object.keys(n).length,a=null;const l={};let u=e,c={};if(o>0||r){const f=u.split(`
`),h=f.slice();if(f.forEach((m,E,w)=>{if(o>0){const S=lC(m,n);if(S){const{updatedLine:_,inject:p}=S;h[E]=_,c=Gc([c,p]),Object.assign(l,S.samplerTextureMap),o--}}r&&!a&&(a=aC(m,r))}),r){k(i);const m="".concat(Za).concat(r),E="uniform vec2 ".concat(m,`;
`),w="     vec2 ".concat(xp," = transform_getPos(").concat(m,`);
     gl_Position = vec4(`).concat(xp,`, 0, 1.);
`);c=Gc([c,{"vs:#decl":E,"vs:#main-start":w}])}u=h.join(`
`)}return{vs:u,targetTextureType:a,inject:c,samplerTextureMap:l}}function iC(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,o;n&&({width:s,height:o}=r,i["".concat(Za).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),i["".concat(Za).concat(a)]=[s,o];return i}function sC(t){return jv(t,["attribute","in"])}function oC(t){const e="".concat(nC).concat(t),n="".concat(Za).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function aC(t,e){const n=jv(t,["varying","out"]);return n&&n.name===e?n.type:null}function lC(t,e){const n={},r=sC(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:l,uniformDeclerations:u}=oC(s),c=HP(i),f="  ".concat(i," ").concat(s," = transform_getInput(").concat(a,", ").concat(l,").").concat(c,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":u,"vs:#main-start":f},samplerTextureMap:n}}return null}const uC={10241:9728,10240:9728,10242:33071,10243:33071},cC="transform_output";class fC{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),l=Object.assign({},e.parameters);let u=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const f in this.samplerTextureMap){const h=this.samplerTextureMap[f];a[f]=r[h]}this._setSourceTextureParameters();const c=iC({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,c)}return this.hasTargetTexture&&(u=!1,l.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:a,discard:u,parameters:l}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=Tl(n);if(!e)return r;const i=r.constructor,s=WP(this.targetTextureType),o=new i(r.length*s/4);let a=0;for(let l=0;l<r.length;l+=4)for(let u=0;u<s;u++)o[a++]=r[l+u];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof lt)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ee(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:l}=e;l?(l.update({attachments:{36064:s},resizeAttachments:!1}),l.resize({width:o,height:a})):e.framebuffer=new be(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{36064:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(uC)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=Ux(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:l}=rC({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),u=Gc([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=l;const c=e._fs||Vv({version:Iv(i),input:this.targetTextureVarying,inputType:o,output:cC}),f=this.hasSourceTextures||this.targetTextureVarying?[X2].concat(e.modules||[]):e.modules;return{vs:i,fs:c,modules:f,uniforms:s,inject:u}}}class bh{static isSupported(e){return X(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();k(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Th(n,Object.assign({},e,{fs:e.fs||Vv({version:Iv(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){hC(n)&&(this.bufferTransform=new tC(e,n)),dC(n)&&(this.textureTransform=new fC(e,n)),k(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function hC(t){return!!(!_i(t.feedbackBuffers)||!_i(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function dC(t){return!!(!_i(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const Ap={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class qv{static get DRAW_MODE(){return Ap}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Yn("geometry"),drawMode:r=Ap.TRIANGLES,attributes:i={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,k(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(k(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:o,size:a,constant:l}=s;!l&&o&&a>=1&&(r=Math.min(r,o.length/a))}return k(Number.isFinite(r)),r}}let gC=1,pC=1;class Zv{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=gC++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=pC++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const mC=[255,255,255],_C=1;let vC=0;class yC{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","ambient");const{color:n=mC}=e,{intensity:r=_C}=e;this.id=e.id||"ambient-".concat(vC++),this.color=n,this.intensity=r}}const EC=[255,255,255],wC=1,TC=[0,0,-1];let bC=0;class Pp{constructor(e={}){d(this,"id",void 0),d(this,"color",void 0),d(this,"intensity",void 0),d(this,"type","directional"),d(this,"direction",void 0),d(this,"shadow",void 0);const{color:n=EC}=e,{intensity:r=wC}=e,{direction:i=TC}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(bC++),this.color=n,this.intensity=r,this.type="directional",this.direction=new $t(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class SC{constructor(e,n={id:"pass"}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Sh extends SC{constructor(...e){super(...e),d(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return gn(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:l=!0}=e;e.pass=e.pass||"unknown";const u=this.gl;l&&AC(u,n),a&&(this._lastRenderIndex=-1);const c=[];for(const f of i){const h=s&&s[f.id];o==null||o(f);const m=this._getDrawLayerParams(f,e),E=f.subViewports||[f];for(const w of E){const S=this._drawLayersInViewport(u,{target:n,moduleParameters:r,viewport:w,view:h,pass:e.pass,layers:e.layers},m);c.push(S)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},u=!1){const c=[],f=Kv(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},m={};for(let E=0;E<n.length;E++){const w=n[E],S=this._shouldDrawLayer(w,h,s,m),_={shouldDrawLayer:S};S&&!u&&(_.layerRenderIndex=f(w,S),_.moduleParameters=this._getModuleParameters(w,a,r,l),_.layerParameters=this.getLayerParameters(w,E,e)),c[E]=_}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const u=xC(e,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;Rt(e,{scissorTest:!0,scissor:u},()=>_h(e,f))}const c={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};gn(e,{viewport:u});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:m,layerRenderIndex:E,moduleParameters:w,layerParameters:S}=l[f];if(m&&h.props.pickable&&c.pickableCount++,h.isComposite)c.compositeCount++;else if(m){c.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,E),w.viewport=o;try{h._drawLayer({moduleParameters:w,uniforms:{layerIndex:E},parameters:S})}catch(_){h.raiseError(_,"drawing ".concat(h," to ").concat(i))}}}return c}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:mi(this.gl)});if(n)for(const l of n){var a;Object.assign(o,(a=l.getModuleParameters)===null||a===void 0?void 0:a.call(l,e))}return Object.assign(o,this.getModuleParameters(e,n),i)}}function Kv(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let u;if(l&&!(l in e)&&r(i.parent,!1),l in n){const c=n[l]=n[l]||Kv(e[l],e);u=c(i,s),n[a]=c}else Number.isFinite(o)?(u=o+(e[l]||0),n[a]=null):u=t;return s&&u>=t&&(t=u+1),e[a]=u,u};return r}function xC(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||mi(t),o=i?n.height:t.drawingBufferHeight,a=r;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function AC(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;gn(t,{viewport:[0,0,n,r]}),t.clear(16640)}class PC extends Sh{constructor(e,n){super(e,n),d(this,"shadowMap",void 0),d(this,"depthBuffer",void 0),d(this,"fbo",void 0),this.shadowMap=new lt(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Kr(e,{format:33189,width:1,height:1}),this.fbo=new be(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Rt(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=mi(this.gl),s=r.width*i,o=r.height*i;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const Qv="#define SMOOTH_EDGE_RADIUS 0.5",CC=`
`.concat(Qv,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),LC=`
`.concat(Qv,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),MC={name:"geometry",vs:CC,fs:LC},IC=Object.keys(Q).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Q[t],";")).join(""),RC=Object.keys(Ht).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Ht[t],";")).join(""),OC=Object.keys(Wa).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Wa[t],";")).join(""),kC="".concat(IC,`
`).concat(RC,`
`).concat(OC,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function NC(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function io(t){let e={},n;return r=>{for(const i in r)if(!NC(r[i],e[i])){n=t(r),e=r;break}return n}}const Cp=[0,0,0,0],FC=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],Jv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],DC=[0,0,0],ey=[0,0,0],BC=io(jC);function ty(t,e,n=ey){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Q.LNGLAT_OFFSETS||e===Q.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Ht.WEB_MERCATOR:(e===Q.LNGLAT||e===Q.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Ht.WEB_MERCATOR_AUTO_OFFSET:e===Q.LNGLAT?r=i:e===Q.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Ht.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Ht.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function UC(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=Cp,l=Cp,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:f,offsetMode:h}=ty(t,e,n);return h&&(l=t.projectPosition(c||f),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=no([],l,o),s=r||s,o=fr([],i,s),o=fr([],o,FC)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:f,geospatialOrigin:c}}function zC({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Q.DEFAULT,coordinateOrigin:i=ey,autoWrapLongitude:s=!1}){r===Q.DEFAULT&&(r=t.isGeospatial?Q.LNGLAT:Q.CARTESIAN);const o=BC({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||Jv,o}function jC({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:u}=UC(t,n,r),c=t.getDistanceScales(),f=[t.width*e,t.height*e],h=no([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,m={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:DC,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:Jv,project_uCameraPosition:a};if(u){const E=t.getDistanceScales(u);switch(n){case Q.METER_OFFSETS:m.project_uCommonUnitsPerWorldUnit=E.unitsPerMeter,m.project_uCommonUnitsPerWorldUnit2=E.unitsPerMeter2;break;case Q.LNGLAT:case Q.LNGLAT_OFFSETS:t._pseudoMeters||(m.project_uCommonUnitsPerMeter=E.unitsPerMeter),m.project_uCommonUnitsPerWorldUnit=E.unitsPerDegree,m.project_uCommonUnitsPerWorldUnit2=E.unitsPerDegree2;break;case Q.CARTESIAN:m.project_uCommonUnitsPerWorldUnit=[1,1,E.unitsPerMeter[2]],m.project_uCommonUnitsPerWorldUnit2=[0,0,E.unitsPerMeter2[2]];break}}return m}const VC={};function GC(t=VC){return"viewport"in t?zC(t):{}}const xh={name:"project",dependencies:[$P,MC],vs:kC,getUniforms:GC};function HC(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function si(t,e){const n=no([],e,t);return O2(n,n,1/n[3]),n}function Lp(t,e){const n=t%e;return n<0?e+n:n}function $c(t,e,n){return t<e?e:t>n?n:t}function WC(t){return Math.log(t)*Math.LOG2E}const Ah=Math.log2||WC;function pn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Lt=Math.PI,ny=Lt/4,yt=Lt/180,qc=180/Lt,wi=512,Ka=4003e4,Yo=85.051129,YC=1.5;function XC(t){return Ah(t)}function js(t){const[e,n]=t;pn(Number.isFinite(e)),pn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*yt,i=n*yt,s=wi*(r+Lt)/(2*Lt),o=wi*(Lt+Math.log(Math.tan(ny+i*.5)))/(2*Lt);return[s,o]}function Ti(t){const[e,n]=t,r=e/wi*(2*Lt)-Lt,i=2*(Math.atan(Math.exp(n/wi*(2*Lt)-Lt))-ny);return[r*qc,i*qc]}function $C(t){const{latitude:e}=t;pn(Number.isFinite(e));const n=Math.cos(e*yt);return XC(Ka*n)-9}function ha(t){const e=Math.cos(t*yt);return wi/Ka/e}function Zc(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;pn(Number.isFinite(e)&&Number.isFinite(n));const i=wi,s=Math.cos(e*yt),o=i/360,a=o/s,l=i/Ka/s,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const c=yt*Math.tan(e*yt)/s,f=o*c/2,h=i/Ka*c,m=h/a*l;u.unitsPerDegree2=[0,f,h],u.unitsPerMeter2=[m,0,m]}return u}function ry(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=Zc({longitude:n,latitude:r,highPrecision:!0}),c=js(t);c[0]+=s*(l[0]+u[0]*o),c[1]+=o*(l[1]+u[1]*o);const f=Ti(c),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function qC(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=HC();qa(a,a,[0,0,-i]),Xv(a,a,-n*yt),$v(a,a,r*yt);const l=s/e;return wh(a,a,[l,l,l]),o&&qa(a,a,u2([],o)),a}function ZC(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=t;let{fovy:c=Qa(YC)}=t;r!==void 0&&(c=Qa(r));const f=c*yt,h=i*yt,m=iy(c);let E=m;o&&(E+=o[2]*a/Math.cos(h)/n);const w=f*(.5+(s?s[1]:0)/n),S=Math.sin(w)*E/Math.sin($c(Math.PI/2-h-w,.01,Math.PI-.01)),_=Math.sin(h)*S+E,p=E*10,v=Math.min(_*u,p);return{fov:f,aspect:e/n,focalDistance:m,near:l,far:v}}function Qa(t){return 2*Math.atan(.5/t)*qc}function iy(t){return .5/Math.tan(.5*t*yt)}function sy(t,e){const[n,r,i=0]=t;return pn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),si(e,[n,r,i,1])}function Ph(t,e,n=0){const[r,i,s]=t;if(pn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return si(e,[r,i,s,1]);const o=si(e,[r,i,0,1]),a=si(e,[r,i,1,1]),l=o[2],u=a[2],c=l===u?0:((n||0)-l)/(u-l);return Hv([],o,a,c)}function KC(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[u,c]]=r,f=QC(t.padding),h=js([a,$c(c,-Yo,Yo)]),m=js([u,$c(l,-Yo,Yo)]),E=[Math.max(Math.abs(m[0]-h[0]),i),Math.max(Math.abs(m[1]-h[1]),i)],w=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];pn(w[0]>0&&w[1]>0);const S=w[0]/E[0],_=w[1]/E[1],p=(f.right-f.left)/2/S,v=(f.top-f.bottom)/2/_,b=[(m[0]+h[0])/2+p,(m[1]+h[1])/2+v],x=Ti(b),P=Math.min(s,Ah(Math.abs(Math.min(S,_))));return pn(Number.isFinite(P)),{longitude:x[0],latitude:x[1],zoom:P}}function QC(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(pn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Mp=Math.PI/180;function JC(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,u;const c=t.fovy?.5*t.fovy*Mp:Math.atan(.5/t.altitude),f=(90-t.pitch)*Mp;return c>f-.01?(l=Ip(t,0,e),u=Ip(t,n,e)):(l=i([0,0],s),u=i([n,0],s)),[o,a,u,l]}function Ip(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=si(r,[e,0,1,1]),s=si(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=Hv([],i,s,a),u=Ti(l);return u.push(n),u}const Rp=512;function eL(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=Lp(i+180,360)-180),(a<-180||a>180)&&(a=Lp(a+180,360)-180);const l=Ah(n/Rp);if(o<=l)o=l,s=0;else{const u=n/2/Math.pow(2,o),c=Ti([0,u])[1];if(s<c)s=c;else{const f=Ti([0,Rp-u])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const tL=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,nL=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,rL=io(lL),iL=io(uL),sL=[0,0,0,1],oL=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function aL(t,e){const[n,r,i]=t,s=Ph([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function lL({viewport:t,center:e}){return new qt(t.viewProjectionMatrix).invert().transform(e)}function uL({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>aL(o,r));for(const o of e){const a=o.clone().translate(new $t(t.center).negate()),l=s.map(c=>a.transform(c)),u=new qt().ortho({left:Math.min(...l.map(c=>c[0])),right:Math.max(...l.map(c=>c[0])),bottom:Math.min(...l.map(c=>c[1])),top:Math.max(...l.map(c=>c[1])),near:Math.min(...l.map(c=>-c[2])),far:Math.max(...l.map(c=>-c[2]))});n.push(u.multiplyRight(o))}return n}function cL(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||sL,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=rL({viewport:t.viewport,center:e.project_uCenter}),s=[],o=iL({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],u=l.clone().translate(new $t(t.viewport.center).negate());e.project_uCoordinateSystem===Q.LNGLAT&&e.project_uProjectionMode===Ht.WEB_MERCATOR?(o[a]=u,s[a]=i):(o[a]=l.clone().multiplyRight(oL),s[a]=u.transform(i))}for(let a=0;a<o.length;a++)r["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],r["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:r["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return r}const Cu={name:"shadow",dependencies:[xh],vs:tL,fs:nL,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?cL(t,e):{}},fL={color:[255,255,255],intensity:1},Op=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],hL=[0,0,0,200/255];class oy{constructor(e={}){d(this,"id","lighting-effect"),d(this,"props",void 0),d(this,"shadowColor",hL),d(this,"shadow",void 0),d(this,"ambientLight",void 0),d(this,"directionalLights",void 0),d(this,"pointLights",void 0),d(this,"shadowPasses",[]),d(this,"shadowMaps",[]),d(this,"dummyShadowMap",null),d(this,"programManager",void 0),d(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=ro.getDefaultProgramManager(e),Cu&&this.programManager.addDefaultModule(Cu)),this.dummyShadowMap||(this.dummyShadowMap=new lt(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Cu),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new qt().lookAt({eye:new $t(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new PC(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new yC(fL),this.directionalLights.push(new Pp(Op[0]),new Pp(Op[1])))}}class dL{constructor(e={}){d(this,"_pool",[]),d(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const u=i||e&&e.constructor||Float32Array,c=n*r+s;if(ArrayBuffer.isView(e)){if(c<=e.length)return e;if(c*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new u(e.buffer,0,c)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(u,c,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(u=>u.byteLength>=a);if(l>=0){const u=new e(o.splice(l,1)[0],0,s);return r&&u.fill(0),u}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Vs=new dL;function ss(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function gL(t){return[t[12],t[13],t[14]]}function pL(t){return{left:Fr(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Fr(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Fr(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Fr(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Fr(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Fr(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const kp=new $t;function Fr(t,e,n,r){kp.set(t,e,n);const i=kp.len();return{distance:r/i,normal:new $t(-t/i,-e/i,-n/i)}}function mL(t){return t-Math.fround(t)}let Qi;function Lu(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Qi=Vs.allocate(Qi,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const u=t[o++];Qi[a+l]=u,Qi[a+l+n]=mL(u)}a+=n*2}return Qi.subarray(0,s*n*2)}function _L(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const vL=Math.PI/180,yL=ss(),Np=[0,0,0],EL={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function wL({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,u=n?new qt().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new qt().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:c=0,right:f=0,top:h=0,bottom:m=0}=s,E=Rn((c+t-f)/2,0,t)-t/2,w=Rn((h+e-m)/2,0,e)-e/2;u[8]-=E*2/t,u[9]+=w*2/e}return u}class Ci{constructor(e={}){d(this,"id",void 0),d(this,"x",void 0),d(this,"y",void 0),d(this,"width",void 0),d(this,"height",void 0),d(this,"padding",void 0),d(this,"isGeospatial",void 0),d(this,"zoom",void 0),d(this,"focalDistance",void 0),d(this,"position",void 0),d(this,"modelMatrix",void 0),d(this,"distanceScales",void 0),d(this,"scale",void 0),d(this,"center",void 0),d(this,"cameraPosition",void 0),d(this,"projectionMatrix",void 0),d(this,"viewMatrix",void 0),d(this,"viewMatrixUncentered",void 0),d(this,"viewMatrixInverse",void 0),d(this,"viewProjectionMatrix",void 0),d(this,"pixelProjectionMatrix",void 0),d(this,"pixelUnprojectionMatrix",void 0),d(this,"resolution",void 0),d(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||EL,this.focalDistance=e.focalDistance||1,this.position=e.position||Np,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Ht.WEB_MERCATOR:Ht.WEB_MERCATOR_AUTO_OFFSET:Ht.IDENTITY}equals(e){return e instanceof Ci?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&zs(e.projectionMatrix,this.projectionMatrix)&&zs(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=sy(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],u=Ph([i,a,o],this.pixelUnprojectionMatrix,l),[c,f,h]=this.unprojectPosition(u);return Number.isFinite(o)?[c,f,h]:Number.isFinite(r)?[c,f,r]:[c,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=js(e);return n[1]=Rn(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Ti(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?Zc({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,pL(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=$C({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Zc({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=Np;if(s&&(a=o?new qt(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new $t(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=yL,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:u=null,focalDistance:c=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new qt().multiplyRight(n).translate(new $t(this.center).negate()),this.projectionMatrix=r||wL({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*vL,focalDistance:c,padding:u,near:a,far:l});const f=ss();fr(f,f,this.projectionMatrix),fr(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=Yc([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=gL(this.viewMatrixInverse);const h=ss(),m=ss();wh(h,h,[this.width/2,-this.height/2,1]),qa(h,h,[1,-1,0]),fr(m,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=m,this.pixelUnprojectionMatrix=Yc(ss(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||K.warn("Pixel project matrix not invertible")()}}d(Ci,"displayName","Viewport");class vr extends Ci{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:u,farZ:c,orthographic:f=!1,projectionMatrix:h,repeat:m=!1,worldOffset:E=0,position:w,padding:S,legacyMeterSizes:_=!1}=e;let{width:p,height:v,altitude:b=1.5}=e;const x=Math.pow(2,i);p=p||1,v=v||1;let P,L=null;if(h)b=h[5]/2,P=Qa(b);else{e.fovy?(P=e.fovy,b=iy(P)):P=Qa(b);let C;if(S){const{top:O=0,bottom:U=0}=S;C=[0,Rn((O+v-U)/2,0,v)-v/2]}L=ZC({width:p,height:v,scale:x,center:w&&[0,0,w[2]*ha(n)],offset:C,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(u)&&(L.near=u),Number.isFinite(c)&&(L.far=c)}let M=qC({height:v,pitch:s,bearing:o,scale:x,altitude:b});E&&(M=new qt().translate([512*E,0,0]).multiplyLeft(M)),super({...e,width:p,height:v,viewMatrix:M,longitude:r,latitude:n,zoom:i,...L,fovy:P,focalDistance:b}),d(this,"longitude",void 0),d(this,"latitude",void 0),d(this,"pitch",void 0),d(this,"bearing",void 0),d(this,"altitude",void 0),d(this,"fovy",void 0),d(this,"orthographic",void 0),d(this,"_subViewports",void 0),d(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=b,this.fovy=P,this.orthographic=f,this._subViewports=m?[]:null,this._pseudoMeters=_,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new vr({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*ha(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/ha(r);return[n,r,i]}addMetersToLngLat(e,n){return ry(e,n)}panByPosition(e,n){const r=Ph(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Tp([],i,r2([],r)),o=Tp([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=JC(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=KC({width:r,height:i,bounds:e,...n});return new vr({width:r,height:i,longitude:s,latitude:o,zoom:a})}}d(vr,"displayName","WebMercatorViewport");const Fp=[0,0,0];function Mu(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof vr){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function TL(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===Q.DEFAULT&&(i=e.isGeospatial?Q.LNGLAT:Q.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function ay(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=no([],[o,a,l,1],n)),r){case Q.LNGLAT:return Mu([o,a,l],e,s);case Q.LNGLAT_OFFSETS:return Mu([o+i[0],a+i[1],l+(i[2]||0)],e,s);case Q.METER_OFFSETS:return Mu(ry(i,[o,a,l]),e,s);case Q.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function bL(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=TL(e),{autoOffset:l=!0}=e,{geospatialOrigin:u=Fp,shaderCoordinateOrigin:c=Fp,offsetMode:f=!1}=l?ty(n,r,i):{},h=ay(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const m=n.projectPosition(u||c);v2(h,h,m)}return h}const Dp={blendFunc:[1,0,32771,0],blendEquation:32774};class ly extends Sh{constructor(...e){super(...e),d(this,"pickZ",void 0),d(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:u,height:c},cullRect:f,effects:h,pass:m="picking",pickZ:E,moduleParameters:w}){const S=this.gl;this.pickZ=E;const _=this._resetColorEncoder(E),p=Rt(S,{scissorTest:!0,scissor:[a,l,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...Dp,blend:!E},()=>super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(b=>b.useInPicking),pass:m,isPicking:!0,moduleParameters:w}));return this._colorEncoderState=null,{decodePickingColor:_&&xL.bind(null,_),stats:p}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:o}=e.props;return this._colorEncoderState?s&&o.includes("draw")&&(Object.assign(i,Dp),i.blend=!0,i.blendColor=SL(this._colorEncoderState,e,r)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function SL(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(K.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function xL(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Br={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Ja=Symbol.for("component"),Gn=Symbol.for("propTypes"),Iu=Symbol.for("deprecatedProps"),oi=Symbol.for("asyncPropDefaults"),yr=Symbol.for("asyncPropOriginal"),On=Symbol.for("asyncPropResolved");function bi(t,e=()=>!0){return Array.isArray(t)?uy(t,e,[]):e(t)?[t]:[]}function uy(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?uy(i,e,n):e(i)&&n.push(i)}return n}function AL({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class PL{constructor(e,n,r){d(this,"id",void 0),d(this,"context",void 0),d(this,"isLoaded",void 0),d(this,"persistent",void 0),d(this,"_loadCount",0),d(this,"_subscribers",new Set),d(this,"_data",void 0),d(this,"_loader",void 0),d(this,"_error",void 0),d(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Va(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class CL{constructor({gl:e,protocol:n}){d(this,"protocol",void 0),d(this,"_context",void 0),d(this,"_resources",void 0),d(this,"_consumers",void 0),d(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new PL(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},l=a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(o[n]=a,a.onChange=i,a.resourceId=r.id,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const LL=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,cy={name:"project32",dependencies:[xh],vs:LL},fy={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...W2},ML=[xh],IL=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function RL(t){const e=ro.getDefaultProgramManager(t);for(const n of ML)e.addDefaultModule(n);for(const n of IL)e.addShaderHook(n);return e}const OL="layerManager.setLayers",kL="layerManager.activateViewport";class NL{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){d(this,"layers",void 0),d(this,"context",void 0),d(this,"resourceManager",void 0),d(this,"_lastRenderedLayers",[]),d(this,"_needsRedraw",!1),d(this,"_needsUpdate",!1),d(this,"_nextLayers",null),d(this,"_debug",!1),d(this,"activateViewport",o=>{Ne(kL,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new CL({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&RL(e),stats:r||new ph({id:"deck.gl"}),viewport:i||new Ci({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new Zv,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ne(OL,this,n,e),this._lastRenderedLayers=e;const r=bi(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?K.warn("Multiple old layers with same id ".concat(o.id))():r[o.id]=o;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&K.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Br.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Br.MATCHED,n!==e&&(e.lifecycle=Br.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Br.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Br.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Wt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Wt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Wt(t[s],e[s],n-1))return!1;return!0}return!1}class FL{constructor(e){d(this,"width",void 0),d(this,"height",void 0),d(this,"views",void 0),d(this,"viewState",void 0),d(this,"controllers",void 0),d(this,"timeline",void 0),d(this,"_viewports",void 0),d(this,"_viewportMap",void 0),d(this,"_isUpdating",void 0),d(this,"_needsRedraw",void 0),d(this,"_needsUpdate",void 0),d(this,"_eventManager",void 0),d(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=bi(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Wt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):K.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))===null||o===void 0?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const u=!!s.controller;u&&!l&&(r=!0),(r||!u)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const DL=/([0-9]+\.?[0-9]*)(%|px)/;function bn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=DL.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Sn(t,e){return t.relative?Math.round(t.position*e):t.position}function ve(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class BL{constructor(e){d(this,"id",void 0),d(this,"viewportInstance",void 0),d(this,"_x",void 0),d(this,"_y",void 0),d(this,"_width",void 0),d(this,"_height",void 0),d(this,"_padding",void 0),d(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:l}=e||{};ve(!l||l instanceof Ci),this.viewportInstance=l,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=bn(r),this._y=bn(i),this._width=bn(s),this._height=bn(o),this._padding=a&&{left:bn(a.left||0),right:bn(a.right||0),top:bn(a.top||0),bottom:bn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Wt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Sn(this._x,e),y:Sn(this._y,n),width:Sn(this._width,e),height:Sn(this._height,n)};return this._padding&&(r.padding={left:Sn(this._padding.left,e),top:Sn(this._padding.top,n),right:Sn(this._padding.right,e),bottom:Sn(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class so{constructor(e){d(this,"_inProgress",void 0),d(this,"_handle",void 0),d(this,"_timeline",void 0),d(this,"time",void 0),d(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Bp=()=>{},Kc={BREAK:1,SNAP_TO_END:2,IGNORE:3},UL=t=>t,zL=Kc.BREAK;class jL{constructor(e){d(this,"getControllerState",void 0),d(this,"props",void 0),d(this,"propsInTransition",void 0),d(this,"transition",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,u=l(r/a),c=i.interpolateProps(s,o,u);this.propsInTransition=this.getControllerState({...this.props,...c}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new so(e.timeline),this.onViewStateChange=e.onViewStateChange||Bp,this.onStateChange=e.onStateChange||Bp}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===Kc.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===Kc.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||UL,interpolator:s,interruption:n.transitionInterruption||zL,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class VL{constructor(e){d(this,"_propsToCompare",void 0),d(this,"_propsToExtract",void 0),d(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!zs(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];ve(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const GL=["longitude","latitude","zoom","bearing","pitch"],HL=["longitude","latitude","zoom"];class hy extends VL{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:GL,required:HL},super(r.transitionProps),d(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=$a(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,$a(e.around,n.around,r)))}return i}}const xn={transitionDuration:0},WL=300,Xo=t=>1-(1-t)*(1-t),Dr={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},er={};class YL{constructor(e){d(this,"props",void 0),d(this,"state",{}),d(this,"transitionManager",void 0),d(this,"eventManager",void 0),d(this,"onViewStateChange",void 0),d(this,"onStateChange",void 0),d(this,"makeViewport",void 0),d(this,"_controllerState",void 0),d(this,"_events",{}),d(this,"_interactionState",{isDragging:!1}),d(this,"_customEvents",[]),d(this,"_eventStartBlocked",null),d(this,"_panMove",!1),d(this,"invertPan",!1),d(this,"dragMode","rotate"),d(this,"inertia",0),d(this,"scrollZoom",!0),d(this,"dragPan",!0),d(this,"dragRotate",!0),d(this,"doubleClickZoom",!0),d(this,"touchZoom",!0),d(this,"touchRotate",!1),d(this,"keyboard",!0),this.transitionManager=new jL({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?WL:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:u=!0}=e,c=!!this.onViewStateChange;this.toggleEvents(Dr.WHEEL,c&&r),this.toggleEvents(Dr.PAN,c),this.toggleEvents(Dr.PINCH,c&&(a||l)),this.toggleEvents(Dr.TRIPLE_PAN,c&&l),this.toggleEvents(Dr.DOUBLE_TAP,c&&o),this.toggleEvents(Dr.KEYBOARD,c&&u),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,xn,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,xn,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Xo},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,xn,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Xo},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,xn,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,xn,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Xo},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return er._startPinchRotation=e.rotation,er._lastPinchEvent=e,this.updateViewport(r,xn,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:er._startPinchRotation-r})}return this.updateViewport(n,xn,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),er._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=er;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Xo},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return er._startPinchRotation=null,er._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const u={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),u.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),u.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),u.isRotating=!0):(l=a.moveLeft(i),u.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),u.isRotating=!0):(l=a.moveRight(i),u.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),u.isRotating=!0):(l=a.moveUp(i),u.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),u.isRotating=!0):(l=a.moveDown(i),u.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),u),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?xn:e?{...n,transitionInterpolator:new hy({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class XL{constructor(e,n){d(this,"_viewportProps",void 0),d(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const Up=5,$L=1.2;class qL extends XL{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:u=1.5,position:c=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:m=60,minPitch:E=0,startPanLngLat:w,startZoomLngLat:S,startRotatePos:_,startBearing:p,startPitch:v,startZoom:b,normalize:x=!0}=e;ve(Number.isFinite(s)),ve(Number.isFinite(i)),ve(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:u,maxZoom:f,minZoom:h,maxPitch:m,minPitch:E,normalize:x,position:c},{startPanLngLat:w,startZoomLngLat:S,startRotatePos:_,startBearing:p,startPitch:v,startZoom:b}),d(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Rn(l,a,o);const u=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...u.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Rn(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Rn(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,eL(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:u,height:c}=this.getViewportProps(),f=s/u;let h=0;o>0?Math.abs(c-l)>Up&&(h=o/(l-c)*$L):o<0&&l>Up&&(h=1-a/l),h=Rn(h,-1,1);const{minPitch:m,maxPitch:E}=this.getViewportProps(),w=i+180*f;let S=r;return h>0?S=r+h*(E-r):h<0&&(S=r-h*(m-r)),{pitch:S,bearing:w}}}class ZL extends YL{constructor(...e){super(...e),d(this,"ControllerState",qL),d(this,"transition",{transitionDuration:300,transitionInterpolator:new hy({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),d(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Ch extends BL{get ViewportType(){return vr}get ControllerType(){return ZL}}d(Ch,"displayName","MapView");const KL=new oy;function QL(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class JL{constructor(){d(this,"effects",void 0),d(this,"_resolvedEffects",[]),d(this,"_defaultEffects",[]),d(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>QL(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Wt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof oy)||this._resolvedEffects.push(KL),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class eM extends Sh{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const tM="deckRenderer.renderLayers";class nM{constructor(e){d(this,"gl",void 0),d(this,"layerFilter",void 0),d(this,"drawPickingColors",void 0),d(this,"drawLayersPass",void 0),d(this,"pickLayersPass",void 0),d(this,"renderCount",void 0),d(this,"_needsRedraw",void 0),d(this,"renderBuffers",void 0),d(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new eM(e),this.pickLayersPass=new ly(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||be.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ne(tM,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new be(this.gl),new be(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const o=s.postRender(this.gl,i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const rM={pickedColor:null,pickedObjectIndex:-1};function iM({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:u}=s;let c=i*i,f=-1,h=0;for(let m=0;m<u;m++){const E=m+a-r,w=E*E;if(w>c)h+=4*l;else for(let S=0;S<l;S++){if(t[h+3]-1>=0){const p=S+o-n,v=p*p+w;v<=c&&(c=v,f=h)}h+=4}}if(f>=0){const m=t.slice(f,f+4),E=e(m);if(E){const w=Math.floor(f/4/l),S=f/4-w*l;return{...E,pickedColor:m,pickedX:o+S,pickedY:a+w}}K.error("Picked non-existent layer. Is picking buffer corrupt?")()}return rM}function sM({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):K.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function dy({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=aM((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function oM(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,m=o?o.props.id:null;if(m!==h||a!==f){if(m!==h){const E=i.find(w=>w.props.id===h);E&&l.unshift(E)}n.layerId=m,n.index=a,n.info=null}}const u=dy(t),c=new Map;return c.set(null,u),l.forEach(f=>{let h={...u};f===o&&(h.color=s,h.index=a,h.picked=!0),h=gy({layer:f,info:h,mode:r});const m=h.layer;f===o&&r==="hover"&&(n.info=h),c.set(m.id,h),r==="hover"&&m.updateAutoHighlight(h)}),c}function gy({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function aM(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class lM{constructor(e){d(this,"gl",void 0),d(this,"pickingFBO",void 0),d(this,"depthFBO",void 0),d(this,"pickLayersPass",void 0),d(this,"layerFilter",void 0),d(this,"lastPickedInfo",void 0),d(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new ly(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,u=a&&i.find(h=>h.id===a)||i[0],c=u&&u.unproject([e-u.x,n-u.y]);return{...s,...{x:e,y:n,viewport:u,coordinate:c,layer:l}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new be(r),be.isSupported(r,{colorBufferFloat:!0}))){const i=new be(r);i.attach({36064:new lt(r,{format:X(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:u,onViewportActive:c,effects:f}){const h=this._getPickable(e),m=mi(this.gl);if(!h)return{result:[],emptyInfo:dy({viewports:r,x:i,y:s,pixelRatio:m})};this._resizeBuffer();const E=pu(this.gl,[i,s],!0),w=[E.x+Math.floor(E.width/2),E.y+Math.floor(E.height/2)],S=Math.round(o*m),{width:_,height:p}=this.pickingFBO,v=this._getPickingRect({deviceX:w[0],deviceY:w[1],deviceRadius:S,deviceWidth:_,deviceHeight:p}),b={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let x;const P=[],L=new Set;for(let M=0;M<a;M++){let C;if(v){const U=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:v,cullRect:b,effects:f,pass:"picking:".concat(l)});C=iM({...U,deviceX:w[0],deviceY:w[1],deviceRadius:S,deviceRect:v})}else C={pickedColor:null,pickedObjectIndex:-1};let O;if(C.pickedLayer&&u&&this.depthFBO){const{pickedColors:U}=this._drawAndSample({layers:[C.pickedLayer],views:n,viewports:r,onViewportActive:c,deviceRect:{x:C.pickedX,y:C.pickedY,width:1,height:1},cullRect:b,effects:f,pass:"picking:".concat(l,":z")},!0);U[3]&&(O=U[0])}C.pickedLayer&&M+1<a&&(L.add(C.pickedLayer),C.pickedLayer.disablePickingIndex(C.pickedObjectIndex)),x=oM({pickInfo:C,lastPickedInfo:this.lastPickedInfo,mode:l,layers:h,viewports:r,x:i,y:s,z:O,pixelRatio:m});for(const U of x.values())U.layer&&P.push(U);if(!C.pickedColor)break}for(const M of L)M.restorePickingColors();return{result:P,emptyInfo:x.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:u=null,onViewportActive:c,effects:f}){const h=this._getPickable(e);if(!h)return[];this._resizeBuffer();const m=mi(this.gl),E=pu(this.gl,[i,s],!0),w=E.x,S=E.y+E.height,_=pu(this.gl,[i+o,s+a],!0),p=_.x+_.width,v=_.y,b={x:w,y:v,width:p-w,height:S-v},x=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:c,deviceRect:b,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:"picking:".concat(l)}),P=sM(x),L=new Map,M=Number.isFinite(u);for(let C=0;C<P.length&&!(M&&u&&L.size>=u);C++){const O=P[C];let U={color:O.pickedColor,layer:null,index:O.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:m};U=gy({layer:O.pickedLayer,info:U,mode:l}),L.has(U.object)||L.set(U.object,U)}return Array.from(L.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},u=!1){const c=u?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:c,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:u,preRenderStats:{}};for(const p of a)p.useInPicking&&(f.preRenderStats[p.id]=p.preRender(this.gl,f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:m,y:E,width:w,height:S}=s,_=new(u?Float32Array:Uint8Array)(w*S*4);return Tl(c,{sourceX:m,sourceY:E,sourceWidth:w,sourceHeight:S,target:_}),{pickedColors:_,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,u=Math.min(s,n+r+1)-a;return l<=0||u<=0?null:{x:o,y:a,width:l,height:u}}}const uM={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class cM{constructor(e){d(this,"el",null),d(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,uM),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}}var py={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,u=Math.abs,c=Date.now;function f(g,y,T){return setTimeout(v(g,T),y)}function h(g,y,T){return Array.isArray(g)?(m(g,T[y],T),!0):!1}function m(g,y,T){var A;if(g)if(g.forEach)g.forEach(y,T);else if(g.length!==i)for(A=0;A<g.length;)y.call(T,g[A],A,g),A++;else for(A in g)g.hasOwnProperty(A)&&y.call(T,g[A],A,g)}function E(g,y,T){var A="DEPRECATED METHOD: "+y+`
`+T+` AT 
`;return function(){var I=new Error("get-stack-trace"),F=I&&I.stack?I.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Y=e.console&&(e.console.warn||e.console.log);return Y&&Y.call(e.console,A,F),g.apply(this,arguments)}}var w;typeof Object.assign!="function"?w=function(y){if(y===i||y===null)throw new TypeError("Cannot convert undefined or null to object");for(var T=Object(y),A=1;A<arguments.length;A++){var I=arguments[A];if(I!==i&&I!==null)for(var F in I)I.hasOwnProperty(F)&&(T[F]=I[F])}return T}:w=Object.assign;var S=E(function(y,T,A){for(var I=Object.keys(T),F=0;F<I.length;)(!A||A&&y[I[F]]===i)&&(y[I[F]]=T[I[F]]),F++;return y},"extend","Use `assign`."),_=E(function(y,T){return S(y,T,!0)},"merge","Use `assign`.");function p(g,y,T){var A=y.prototype,I;I=g.prototype=Object.create(A),I.constructor=g,I._super=A,T&&w(I,T)}function v(g,y){return function(){return g.apply(y,arguments)}}function b(g,y){return typeof g==a?g.apply(y&&y[0]||i,y):g}function x(g,y){return g===i?y:g}function P(g,y,T){m(O(y),function(A){g.addEventListener(A,T,!1)})}function L(g,y,T){m(O(y),function(A){g.removeEventListener(A,T,!1)})}function M(g,y){for(;g;){if(g==y)return!0;g=g.parentNode}return!1}function C(g,y){return g.indexOf(y)>-1}function O(g){return g.trim().split(/\s+/g)}function U(g,y,T){if(g.indexOf&&!T)return g.indexOf(y);for(var A=0;A<g.length;){if(T&&g[A][T]==y||!T&&g[A]===y)return A;A++}return-1}function H(g){return Array.prototype.slice.call(g,0)}function G(g,y,T){for(var A=[],I=[],F=0;F<g.length;){var Y=y?g[F][y]:g[F];U(I,Y)<0&&A.push(g[F]),I[F]=Y,F++}return T&&(y?A=A.sort(function(Pe,Ue){return Pe[y]>Ue[y]}):A=A.sort()),A}function q(g,y){for(var T,A,I=y[0].toUpperCase()+y.slice(1),F=0;F<s.length;){if(T=s[F],A=T?T+I:y,A in g)return A;F++}return i}var Tt=1;function Mi(){return Tt++}function Ar(g){var y=g.ownerDocument||g;return y.defaultView||y.parentWindow||e}var D=/mobile|tablet|ip(ad|hone|od)|android/i,V="ontouchstart"in e,W=q(e,"PointerEvent")!==i,ue=V&&D.test(navigator.userAgent),oe="touch",Pr="pen",bt="mouse",Ii="kinect",Zt=25,me=1,Zn=2,_e=4,We=8,lo=1,Ri=2,Oi=4,ki=8,Ni=16,kt=Ri|Oi,Kn=ki|Ni,Uh=kt|Kn,zh=["x","y"],uo=["clientX","clientY"];function ft(g,y){var T=this;this.manager=g,this.callback=y,this.element=g.element,this.target=g.options.inputTarget,this.domHandler=function(A){b(g.options.enable,[g])&&T.handler(A)},this.init()}ft.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(Ar(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(Ar(this.element),this.evWin,this.domHandler)}};function By(g){var y,T=g.options.inputClass;return T?y=T:W?y=Al:ue?y=ho:V?y=Pl:y=fo,new y(g,Uy)}function Uy(g,y,T){var A=T.pointers.length,I=T.changedPointers.length,F=y&me&&A-I===0,Y=y&(_e|We)&&A-I===0;T.isFirst=!!F,T.isFinal=!!Y,F&&(g.session={}),T.eventType=y,zy(g,T),g.emit("hammer.input",T),g.recognize(T),g.session.prevInput=T}function zy(g,y){var T=g.session,A=y.pointers,I=A.length;T.firstInput||(T.firstInput=jh(y)),I>1&&!T.firstMultiple?T.firstMultiple=jh(y):I===1&&(T.firstMultiple=!1);var F=T.firstInput,Y=T.firstMultiple,Se=Y?Y.center:F.center,Pe=y.center=Vh(A);y.timeStamp=c(),y.deltaTime=y.timeStamp-F.timeStamp,y.angle=xl(Se,Pe),y.distance=co(Se,Pe),jy(T,y),y.offsetDirection=Hh(y.deltaX,y.deltaY);var Ue=Gh(y.deltaTime,y.deltaX,y.deltaY);y.overallVelocityX=Ue.x,y.overallVelocityY=Ue.y,y.overallVelocity=u(Ue.x)>u(Ue.y)?Ue.x:Ue.y,y.scale=Y?Hy(Y.pointers,A):1,y.rotation=Y?Gy(Y.pointers,A):0,y.maxPointers=T.prevInput?y.pointers.length>T.prevInput.maxPointers?y.pointers.length:T.prevInput.maxPointers:y.pointers.length,Vy(T,y);var Ft=g.element;M(y.srcEvent.target,Ft)&&(Ft=y.srcEvent.target),y.target=Ft}function jy(g,y){var T=y.center,A=g.offsetDelta||{},I=g.prevDelta||{},F=g.prevInput||{};(y.eventType===me||F.eventType===_e)&&(I=g.prevDelta={x:F.deltaX||0,y:F.deltaY||0},A=g.offsetDelta={x:T.x,y:T.y}),y.deltaX=I.x+(T.x-A.x),y.deltaY=I.y+(T.y-A.y)}function Vy(g,y){var T=g.lastInterval||y,A=y.timeStamp-T.timeStamp,I,F,Y,Se;if(y.eventType!=We&&(A>Zt||T.velocity===i)){var Pe=y.deltaX-T.deltaX,Ue=y.deltaY-T.deltaY,Ft=Gh(A,Pe,Ue);F=Ft.x,Y=Ft.y,I=u(Ft.x)>u(Ft.y)?Ft.x:Ft.y,Se=Hh(Pe,Ue),g.lastInterval=y}else I=T.velocity,F=T.velocityX,Y=T.velocityY,Se=T.direction;y.velocity=I,y.velocityX=F,y.velocityY=Y,y.direction=Se}function jh(g){for(var y=[],T=0;T<g.pointers.length;)y[T]={clientX:l(g.pointers[T].clientX),clientY:l(g.pointers[T].clientY)},T++;return{timeStamp:c(),pointers:y,center:Vh(y),deltaX:g.deltaX,deltaY:g.deltaY}}function Vh(g){var y=g.length;if(y===1)return{x:l(g[0].clientX),y:l(g[0].clientY)};for(var T=0,A=0,I=0;I<y;)T+=g[I].clientX,A+=g[I].clientY,I++;return{x:l(T/y),y:l(A/y)}}function Gh(g,y,T){return{x:y/g||0,y:T/g||0}}function Hh(g,y){return g===y?lo:u(g)>=u(y)?g<0?Ri:Oi:y<0?ki:Ni}function co(g,y,T){T||(T=zh);var A=y[T[0]]-g[T[0]],I=y[T[1]]-g[T[1]];return Math.sqrt(A*A+I*I)}function xl(g,y,T){T||(T=zh);var A=y[T[0]]-g[T[0]],I=y[T[1]]-g[T[1]];return Math.atan2(I,A)*180/Math.PI}function Gy(g,y){return xl(y[1],y[0],uo)+xl(g[1],g[0],uo)}function Hy(g,y){return co(y[0],y[1],uo)/co(g[0],g[1],uo)}var Wy={mousedown:me,mousemove:Zn,mouseup:_e},Yy="mousedown",Xy="mousemove mouseup";function fo(){this.evEl=Yy,this.evWin=Xy,this.pressed=!1,ft.apply(this,arguments)}p(fo,ft,{handler:function(y){var T=Wy[y.type];T&me&&y.button===0&&(this.pressed=!0),T&Zn&&y.which!==1&&(T=_e),this.pressed&&(T&_e&&(this.pressed=!1),this.callback(this.manager,T,{pointers:[y],changedPointers:[y],pointerType:bt,srcEvent:y}))}});var $y={pointerdown:me,pointermove:Zn,pointerup:_e,pointercancel:We,pointerout:We},qy={2:oe,3:Pr,4:bt,5:Ii},Wh="pointerdown",Yh="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Wh="MSPointerDown",Yh="MSPointerMove MSPointerUp MSPointerCancel");function Al(){this.evEl=Wh,this.evWin=Yh,ft.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}p(Al,ft,{handler:function(y){var T=this.store,A=!1,I=y.type.toLowerCase().replace("ms",""),F=$y[I],Y=qy[y.pointerType]||y.pointerType,Se=Y==oe,Pe=U(T,y.pointerId,"pointerId");F&me&&(y.button===0||Se)?Pe<0&&(T.push(y),Pe=T.length-1):F&(_e|We)&&(A=!0),!(Pe<0)&&(T[Pe]=y,this.callback(this.manager,F,{pointers:T,changedPointers:[y],pointerType:Y,srcEvent:y}),A&&T.splice(Pe,1))}});var Zy={touchstart:me,touchmove:Zn,touchend:_e,touchcancel:We},Ky="touchstart",Qy="touchstart touchmove touchend touchcancel";function Xh(){this.evTarget=Ky,this.evWin=Qy,this.started=!1,ft.apply(this,arguments)}p(Xh,ft,{handler:function(y){var T=Zy[y.type];if(T===me&&(this.started=!0),!!this.started){var A=Jy.call(this,y,T);T&(_e|We)&&A[0].length-A[1].length===0&&(this.started=!1),this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:oe,srcEvent:y})}}});function Jy(g,y){var T=H(g.touches),A=H(g.changedTouches);return y&(_e|We)&&(T=G(T.concat(A),"identifier",!0)),[T,A]}var e1={touchstart:me,touchmove:Zn,touchend:_e,touchcancel:We},t1="touchstart touchmove touchend touchcancel";function ho(){this.evTarget=t1,this.targetIds={},ft.apply(this,arguments)}p(ho,ft,{handler:function(y){var T=e1[y.type],A=n1.call(this,y,T);A&&this.callback(this.manager,T,{pointers:A[0],changedPointers:A[1],pointerType:oe,srcEvent:y})}});function n1(g,y){var T=H(g.touches),A=this.targetIds;if(y&(me|Zn)&&T.length===1)return A[T[0].identifier]=!0,[T,T];var I,F,Y=H(g.changedTouches),Se=[],Pe=this.target;if(F=T.filter(function(Ue){return M(Ue.target,Pe)}),y===me)for(I=0;I<F.length;)A[F[I].identifier]=!0,I++;for(I=0;I<Y.length;)A[Y[I].identifier]&&Se.push(Y[I]),y&(_e|We)&&delete A[Y[I].identifier],I++;if(Se.length)return[G(F.concat(Se),"identifier",!0),Se]}var r1=2500,$h=25;function Pl(){ft.apply(this,arguments);var g=v(this.handler,this);this.touch=new ho(this.manager,g),this.mouse=new fo(this.manager,g),this.primaryTouch=null,this.lastTouches=[]}p(Pl,ft,{handler:function(y,T,A){var I=A.pointerType==oe,F=A.pointerType==bt;if(!(F&&A.sourceCapabilities&&A.sourceCapabilities.firesTouchEvents)){if(I)i1.call(this,T,A);else if(F&&s1.call(this,A))return;this.callback(y,T,A)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function i1(g,y){g&me?(this.primaryTouch=y.changedPointers[0].identifier,qh.call(this,y)):g&(_e|We)&&qh.call(this,y)}function qh(g){var y=g.changedPointers[0];if(y.identifier===this.primaryTouch){var T={x:y.clientX,y:y.clientY};this.lastTouches.push(T);var A=this.lastTouches,I=function(){var F=A.indexOf(T);F>-1&&A.splice(F,1)};setTimeout(I,r1)}}function s1(g){for(var y=g.srcEvent.clientX,T=g.srcEvent.clientY,A=0;A<this.lastTouches.length;A++){var I=this.lastTouches[A],F=Math.abs(y-I.x),Y=Math.abs(T-I.y);if(F<=$h&&Y<=$h)return!0}return!1}var Zh=q(o.style,"touchAction"),Kh=Zh!==i,Qh="compute",Jh="auto",Cl="manipulation",Qn="none",Fi="pan-x",Di="pan-y",go=a1();function Ll(g,y){this.manager=g,this.set(y)}Ll.prototype={set:function(g){g==Qh&&(g=this.compute()),Kh&&this.manager.element.style&&go[g]&&(this.manager.element.style[Zh]=g),this.actions=g.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var g=[];return m(this.manager.recognizers,function(y){b(y.options.enable,[y])&&(g=g.concat(y.getTouchAction()))}),o1(g.join(" "))},preventDefaults:function(g){var y=g.srcEvent,T=g.offsetDirection;if(this.manager.session.prevented){y.preventDefault();return}var A=this.actions,I=C(A,Qn)&&!go[Qn],F=C(A,Di)&&!go[Di],Y=C(A,Fi)&&!go[Fi];if(I){var Se=g.pointers.length===1,Pe=g.distance<2,Ue=g.deltaTime<250;if(Se&&Pe&&Ue)return}if(!(Y&&F)&&(I||F&&T&kt||Y&&T&Kn))return this.preventSrc(y)},preventSrc:function(g){this.manager.session.prevented=!0,g.preventDefault()}};function o1(g){if(C(g,Qn))return Qn;var y=C(g,Fi),T=C(g,Di);return y&&T?Qn:y||T?y?Fi:Di:C(g,Cl)?Cl:Jh}function a1(){if(!Kh)return!1;var g={},y=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(T){g[T]=y?e.CSS.supports("touch-action",T):!0}),g}var po=1,ht=2,Cr=4,yn=8,Kt=yn,Bi=16,Nt=32;function Qt(g){this.options=w({},this.defaults,g||{}),this.id=Mi(),this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=po,this.simultaneous={},this.requireFail=[]}Qt.prototype={defaults:{},set:function(g){return w(this.options,g),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(g){if(h(g,"recognizeWith",this))return this;var y=this.simultaneous;return g=mo(g,this),y[g.id]||(y[g.id]=g,g.recognizeWith(this)),this},dropRecognizeWith:function(g){return h(g,"dropRecognizeWith",this)?this:(g=mo(g,this),delete this.simultaneous[g.id],this)},requireFailure:function(g){if(h(g,"requireFailure",this))return this;var y=this.requireFail;return g=mo(g,this),U(y,g)===-1&&(y.push(g),g.requireFailure(this)),this},dropRequireFailure:function(g){if(h(g,"dropRequireFailure",this))return this;g=mo(g,this);var y=U(this.requireFail,g);return y>-1&&this.requireFail.splice(y,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(g){return!!this.simultaneous[g.id]},emit:function(g){var y=this,T=this.state;function A(I){y.manager.emit(I,g)}T<yn&&A(y.options.event+ed(T)),A(y.options.event),g.additionalEvent&&A(g.additionalEvent),T>=yn&&A(y.options.event+ed(T))},tryEmit:function(g){if(this.canEmit())return this.emit(g);this.state=Nt},canEmit:function(){for(var g=0;g<this.requireFail.length;){if(!(this.requireFail[g].state&(Nt|po)))return!1;g++}return!0},recognize:function(g){var y=w({},g);if(!b(this.options.enable,[this,y])){this.reset(),this.state=Nt;return}this.state&(Kt|Bi|Nt)&&(this.state=po),this.state=this.process(y),this.state&(ht|Cr|yn|Bi)&&this.tryEmit(y)},process:function(g){},getTouchAction:function(){},reset:function(){}};function ed(g){return g&Bi?"cancel":g&yn?"end":g&Cr?"move":g&ht?"start":""}function td(g){return g==Ni?"down":g==ki?"up":g==Ri?"left":g==Oi?"right":""}function mo(g,y){var T=y.manager;return T?T.get(g):g}function St(){Qt.apply(this,arguments)}p(St,Qt,{defaults:{pointers:1},attrTest:function(g){var y=this.options.pointers;return y===0||g.pointers.length===y},process:function(g){var y=this.state,T=g.eventType,A=y&(ht|Cr),I=this.attrTest(g);return A&&(T&We||!I)?y|Bi:A||I?T&_e?y|yn:y&ht?y|Cr:ht:Nt}});function _o(){St.apply(this,arguments),this.pX=null,this.pY=null}p(_o,St,{defaults:{event:"pan",threshold:10,pointers:1,direction:Uh},getTouchAction:function(){var g=this.options.direction,y=[];return g&kt&&y.push(Di),g&Kn&&y.push(Fi),y},directionTest:function(g){var y=this.options,T=!0,A=g.distance,I=g.direction,F=g.deltaX,Y=g.deltaY;return I&y.direction||(y.direction&kt?(I=F===0?lo:F<0?Ri:Oi,T=F!=this.pX,A=Math.abs(g.deltaX)):(I=Y===0?lo:Y<0?ki:Ni,T=Y!=this.pY,A=Math.abs(g.deltaY))),g.direction=I,T&&A>y.threshold&&I&y.direction},attrTest:function(g){return St.prototype.attrTest.call(this,g)&&(this.state&ht||!(this.state&ht)&&this.directionTest(g))},emit:function(g){this.pX=g.deltaX,this.pY=g.deltaY;var y=td(g.direction);y&&(g.additionalEvent=this.options.event+y),this._super.emit.call(this,g)}});function Ml(){St.apply(this,arguments)}p(Ml,St,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.scale-1)>this.options.threshold||this.state&ht)},emit:function(g){if(g.scale!==1){var y=g.scale<1?"in":"out";g.additionalEvent=this.options.event+y}this._super.emit.call(this,g)}});function Il(){Qt.apply(this,arguments),this._timer=null,this._input=null}p(Il,Qt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Jh]},process:function(g){var y=this.options,T=g.pointers.length===y.pointers,A=g.distance<y.threshold,I=g.deltaTime>y.time;if(this._input=g,!A||!T||g.eventType&(_e|We)&&!I)this.reset();else if(g.eventType&me)this.reset(),this._timer=f(function(){this.state=Kt,this.tryEmit()},y.time,this);else if(g.eventType&_e)return Kt;return Nt},reset:function(){clearTimeout(this._timer)},emit:function(g){this.state===Kt&&(g&&g.eventType&_e?this.manager.emit(this.options.event+"up",g):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}});function Rl(){St.apply(this,arguments)}p(Rl,St,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Qn]},attrTest:function(g){return this._super.attrTest.call(this,g)&&(Math.abs(g.rotation)>this.options.threshold||this.state&ht)}});function Ol(){St.apply(this,arguments)}p(Ol,St,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:kt|Kn,pointers:1},getTouchAction:function(){return _o.prototype.getTouchAction.call(this)},attrTest:function(g){var y=this.options.direction,T;return y&(kt|Kn)?T=g.overallVelocity:y&kt?T=g.overallVelocityX:y&Kn&&(T=g.overallVelocityY),this._super.attrTest.call(this,g)&&y&g.offsetDirection&&g.distance>this.options.threshold&&g.maxPointers==this.options.pointers&&u(T)>this.options.velocity&&g.eventType&_e},emit:function(g){var y=td(g.offsetDirection);y&&this.manager.emit(this.options.event+y,g),this.manager.emit(this.options.event,g)}});function vo(){Qt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}p(vo,Qt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Cl]},process:function(g){var y=this.options,T=g.pointers.length===y.pointers,A=g.distance<y.threshold,I=g.deltaTime<y.time;if(this.reset(),g.eventType&me&&this.count===0)return this.failTimeout();if(A&&I&&T){if(g.eventType!=_e)return this.failTimeout();var F=this.pTime?g.timeStamp-this.pTime<y.interval:!0,Y=!this.pCenter||co(this.pCenter,g.center)<y.posThreshold;this.pTime=g.timeStamp,this.pCenter=g.center,!Y||!F?this.count=1:this.count+=1,this._input=g;var Se=this.count%y.taps;if(Se===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=Kt,this.tryEmit()},y.interval,this),ht):Kt}return Nt},failTimeout:function(){return this._timer=f(function(){this.state=Nt},this.options.interval,this),Nt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Kt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Jt(g,y){return y=y||{},y.recognizers=x(y.recognizers,Jt.defaults.preset),new kl(g,y)}Jt.VERSION="2.0.7",Jt.defaults={domEvents:!1,touchAction:Qh,enable:!0,inputTarget:null,inputClass:null,preset:[[Rl,{enable:!1}],[Ml,{enable:!1},["rotate"]],[Ol,{direction:kt}],[_o,{direction:kt},["swipe"]],[vo],[vo,{event:"doubletap",taps:2},["tap"]],[Il]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var l1=1,nd=2;function kl(g,y){this.options=w({},Jt.defaults,y||{}),this.options.inputTarget=this.options.inputTarget||g,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=g,this.input=By(this),this.touchAction=new Ll(this,this.options.touchAction),rd(this,!0),m(this.options.recognizers,function(T){var A=this.add(new T[0](T[1]));T[2]&&A.recognizeWith(T[2]),T[3]&&A.requireFailure(T[3])},this)}kl.prototype={set:function(g){return w(this.options,g),g.touchAction&&this.touchAction.update(),g.inputTarget&&(this.input.destroy(),this.input.target=g.inputTarget,this.input.init()),this},stop:function(g){this.session.stopped=g?nd:l1},recognize:function(g){var y=this.session;if(!y.stopped){this.touchAction.preventDefaults(g);var T,A=this.recognizers,I=y.curRecognizer;(!I||I&&I.state&Kt)&&(I=y.curRecognizer=null);for(var F=0;F<A.length;)T=A[F],y.stopped!==nd&&(!I||T==I||T.canRecognizeWith(I))?T.recognize(g):T.reset(),!I&&T.state&(ht|Cr|yn)&&(I=y.curRecognizer=T),F++}},get:function(g){if(g instanceof Qt)return g;for(var y=this.recognizers,T=0;T<y.length;T++)if(y[T].options.event==g)return y[T];return null},add:function(g){if(h(g,"add",this))return this;var y=this.get(g.options.event);return y&&this.remove(y),this.recognizers.push(g),g.manager=this,this.touchAction.update(),g},remove:function(g){if(h(g,"remove",this))return this;if(g=this.get(g),g){var y=this.recognizers,T=U(y,g);T!==-1&&(y.splice(T,1),this.touchAction.update())}return this},on:function(g,y){if(g!==i&&y!==i){var T=this.handlers;return m(O(g),function(A){T[A]=T[A]||[],T[A].push(y)}),this}},off:function(g,y){if(g!==i){var T=this.handlers;return m(O(g),function(A){y?T[A]&&T[A].splice(U(T[A],y),1):delete T[A]}),this}},emit:function(g,y){this.options.domEvents&&u1(g,y);var T=this.handlers[g]&&this.handlers[g].slice();if(!(!T||!T.length)){y.type=g,y.preventDefault=function(){y.srcEvent.preventDefault()};for(var A=0;A<T.length;)T[A](y),A++}},destroy:function(){this.element&&rd(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function rd(g,y){var T=g.element;if(T.style){var A;m(g.options.cssProps,function(I,F){A=q(T.style,F),y?(g.oldCssProps[A]=T.style[A],T.style[A]=I):T.style[A]=g.oldCssProps[A]||""}),y||(g.oldCssProps={})}}function u1(g,y){var T=n.createEvent("Event");T.initEvent(g,!0,!0),T.gesture=y,y.target.dispatchEvent(T)}w(Jt,{INPUT_START:me,INPUT_MOVE:Zn,INPUT_END:_e,INPUT_CANCEL:We,STATE_POSSIBLE:po,STATE_BEGAN:ht,STATE_CHANGED:Cr,STATE_ENDED:yn,STATE_RECOGNIZED:Kt,STATE_CANCELLED:Bi,STATE_FAILED:Nt,DIRECTION_NONE:lo,DIRECTION_LEFT:Ri,DIRECTION_RIGHT:Oi,DIRECTION_UP:ki,DIRECTION_DOWN:Ni,DIRECTION_HORIZONTAL:kt,DIRECTION_VERTICAL:Kn,DIRECTION_ALL:Uh,Manager:kl,Input:ft,TouchAction:Ll,TouchInput:ho,MouseInput:fo,PointerEventInput:Al,TouchMouseInput:Pl,SingleTouchInput:Xh,Recognizer:Qt,AttrRecognizer:St,Tap:vo,Pan:_o,Swipe:Ol,Pinch:Ml,Rotate:Rl,Press:Il,on:P,off:L,each:m,merge:_,extend:S,assign:w,inherit:p,bindFn:v,prefixed:q});var c1=typeof e<"u"?e:typeof self<"u"?self:{};c1.Hammer=Jt,typeof i=="function"&&i.amd?i(function(){return Jt}):t.exports?t.exports=Jt:e[r]=Jt})(window,document,"Hammer")})(py);var oo=py.exports;const fM=Lm(oo),Ut=f1({__proto__:null,default:fM},[oo]),my=1,_y=2,Qc=4,hM={mousedown:my,mousemove:_y,mouseup:Qc};function dM(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function gM(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(dM(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function pM(t){t.prototype.handler=function(n){let r=hM[n.type];r&my&&n.button>=0&&(this.pressed=!0),r&_y&&n.which===0&&(r=Qc),this.pressed&&(r&Qc&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}gM(oo.PointerEventInput);pM(oo.MouseInput);const mM=oo.Manager;class bl{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const _M=Ut?[[Ut.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ut.Rotate,{enable:!1}],[Ut.Pinch,{enable:!1}],[Ut.Swipe,{enable:!1}],[Ut.Pan,{threshold:0,enable:!1}],[Ut.Press,{enable:!1}],[Ut.Tap,{event:"doubletap",taps:2,enable:!1}],[Ut.Tap,{event:"anytap",enable:!1}],[Ut.Tap,{enable:!1}]]:null,zp={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},vM={doubletap:["tap"]},yM={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Lh={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},EM={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},jp={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},wM=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Qr=typeof window<"u"?window:global;let Jc=!1;try{const t={get passive(){return Jc=!0,!0}};Qr.addEventListener("test",null,t),Qr.removeEventListener("test",null)}catch{Jc=!1}const TM=wM.indexOf("firefox")!==-1,{WHEEL_EVENTS:bM}=Lh,Vp="wheel",Gp=4.000244140625,SM=40,xM=.25;class AM extends bl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Qr.WheelEvent&&(TM&&i.deltaMode===Qr.WheelEvent.DOM_DELTA_PIXEL&&(s/=Qr.devicePixelRatio),i.deltaMode===Qr.WheelEvent.DOM_DELTA_LINE&&(s*=SM)),s!==0&&s%Gp===0&&(s=Math.floor(s/Gp)),i.shiftKey&&s&&(s=s*xM),this.callback({type:Vp,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(bM),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,Jc?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Vp&&(this.options.enable=n)}}const{MOUSE_EVENTS:PM}=Lh,Hp="pointermove",Wp="pointerover",Yp="pointerout",Xp="pointerenter",$p="pointerleave";class CM extends bl{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(PM),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===Hp&&(this.enableMoveEvent=n),e===Wp&&(this.enableOverEvent=n),e===Yp&&(this.enableOutEvent=n),e===Xp&&(this.enableEnterEvent=n),e===$p&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(Wp,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(Yp,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(Xp,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit($p,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(Hp,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:LM}=Lh,qp="keydown",Zp="keyup";class MM extends bl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:qp,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:Zp,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(LM),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===qp&&(this.enableDownEvent=n),e===Zp&&(this.enableUpEvent=n)}}const Kp="contextmenu";class IM extends bl{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Kp,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Kp&&(this.options.enable=n)}}const ef=1,el=2,tf=4,RM={pointerdown:ef,pointermove:el,pointerup:tf,mousedown:ef,mousemove:el,mouseup:tf},OM=1,kM=2,NM=3,FM=0,DM=1,BM=2,UM=1,zM=2,jM=4;function VM(t){const e=RM[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,o=!1,a=!1;return e===tf||e===el&&!Number.isFinite(n)?(s=i===OM,o=i===kM,a=i===NM):e===el?(s=!!(n&UM),o=!!(n&jM),a=!!(n&zM)):e===ef&&(s=r===FM,o=r===DM,a=r===BM),{leftButton:s,middleButton:o,rightButton:a}}function GM(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Ru={srcElement:"root",priority:0};class HM{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Ru;typeof r=="string"||r&&r.addEventListener?l={...Ru,srcElement:r}:r&&(l={...Ru,...r});let u=a.get(l.srcElement);u||(u=[],a.set(l.srcElement,u));const c={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(c.once=!0),s&&(c.passive=!0),o.push(c),this._active=this._active||!c.passive;let f=u.length-1;for(;f>=0&&!(u[f].priority>=c.priority);)f--;u.splice(f+1,0,c)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:u,handler:c,once:f}=r[l];if(c({...e,type:u,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:u,handler:c}=a[l];this.remove(u,c)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...VM(e),...GM(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const WM={events:null,recognizers:null,recognizerOptions:{},Manager:mM,touchAction:"none",tabIndex:0};class YM{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=yM[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...WM,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||_M}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(zp).forEach(i=>{const s=this.manager.get(i);s&&zp[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new AM(e,this._onOtherEvent,{enable:!1}),this.moveInput=new CM(e,this._onOtherEvent,{enable:!1}),this.keyInput=new MM(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new IM(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=vM[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const c in e)this._addEventHandler(c,e[c],r,i,s);return}const{manager:o,events:a}=this,l=jp[e]||e;let u=a.get(l);u||(u=new HM(this),a.set(l,u),u.recognizerName=EM[l]||l,o&&o.on(l,u.handleEvent)),u.add(e,n,r,i,s),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=jp[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function tr(){}const XM=({isDragging:t})=>t?"grabbing":"grab",vy={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:tr,onResize:tr,onViewStateChange:tr,onInteractionStateChange:tr,onBeforeRender:tr,onAfterRender:tr,onLoad:tr,onError:t=>K.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:XM,getTooltip:null,debug:!1,drawPickingColors:!1};class Gs{constructor(e){d(this,"props",void 0),d(this,"width",0),d(this,"height",0),d(this,"userData",{}),d(this,"canvas",null),d(this,"viewManager",null),d(this,"layerManager",null),d(this,"effectManager",null),d(this,"deckRenderer",null),d(this,"deckPicker",null),d(this,"eventManager",null),d(this,"tooltip",null),d(this,"metrics",void 0),d(this,"animationLoop",void 0),d(this,"stats",void 0),d(this,"viewState",void 0),d(this,"cursorState",void 0),d(this,"_needsRedraw",void 0),d(this,"_pickRequest",void 0),d(this,"_lastPointerDownInfo",null),d(this,"_metricsCounter",void 0),d(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),d(this,"_onEvent",n=>{const r=Ng[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:a}=o,l=a&&(a[r.handler]||a.props[r.handler]),u=this.props[r.handler];let c=!1;l&&(c=l.call(a,o,n)),!c&&u&&u(o,n)}),d(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...vy,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&K.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),hv()==="IE"&&K.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new ph({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Vs.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(s=this.deckRenderer)===null||s===void 0||s.finalize(),this.deckRenderer=null,(o=this.deckPicker)===null||o===void 0||o.finalize(),this.deckPicker=null,(a=this.eventManager)===null||a===void 0||a.destroy(),this.eventManager=null,(l=this.tooltip)===null||l===void 0||l.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var u;(u=this.canvas.parentElement)===null||u===void 0||u.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&K.removed("onLayerHover","onHover")(),"onLayerClick"in e&&K.removed("onLayerClick","onClick")(),e.initialViewState&&!Wt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ve(this.viewManager),this.viewManager.views}getViewports(e){return ve(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){ve(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ve(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var o,a;this.width=i,this.height=s,(o=this.viewManager)===null||o===void 0||o.setProps({width:i,height:s}),(a=this.layerManager)===null||a===void 0||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:o,onError:a,onBeforeRender:l,onAfterRender:u,useDevicePixels:c}=e;return new rP({width:n,height:r,useDevicePixels:c,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:f=>yv({...s,...f,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:f=>this._setGLContext(f.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:l,onAfterRender:u,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new Ch({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,o=!1;for(const a of r){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,gh(e,{enable:!0,copyState:!0})),this.tooltip=new cM(this.canvas),gn(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new Zv;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new YM(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in Ng)this.eventManager.on(i,this._onEvent);this.viewManager=new FL({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new NL(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new JL,this.deckRenderer=new nM(e),this.deckPicker=new lM(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;gn(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),K.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=lr.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}d(Gs,"defaultProps",vy);d(Gs,"VERSION",lS);class Ou{constructor(e,n){d(this,"opts",void 0),d(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const o=n.elementOffset||0;for(let a=0;a<i;++a)s[a]=r[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function $M(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function da(t){return t.stride||t.size*t.bytesPerElement}function yy(t,e){e.offset&&K.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=da(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function qM(t,e){const n=yy(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class ZM{constructor(e,n,r){d(this,"gl",void 0),d(this,"id",void 0),d(this,"size",void 0),d(this,"settings",void 0),d(this,"value",void 0),d(this,"doublePrecision",void 0),d(this,"_buffer",void 0),d(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!i&&n.isIndexed?a=e&&Ox(e,ae.ELEMENT_INDEX_UINT32)?5125:5123:a=i||5126;let l=$M(i||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ee(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*da(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Vs.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=qM(this.getAccessor(),n||{});return r[e]=new Ou(this,s.high),r["".concat(e,"64Low")]=i?new Ou(this,s.low):new Float32Array(this.size),r}if(n){const r=yy(this.getAccessor(),n);return{[e]:new Ou(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let u=0;u<i;u++){const c=n[l++];c<o[u]&&(o[u]=c),c>a[u]&&(a[u]=c)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ee?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const o=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),i.stride=da(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=da(i);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Lu(s,i));const l=s.byteLength+a+i.stride*2;o.byteLength<l&&o.reallocate(l),o.setAccessor(null),o.subData({data:s,offset:a}),i.type=r.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Lu(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Vs.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&i&&o.subData({data:i instanceof Float64Array?Lu(i,this):i,offset:a})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&K.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const Qp=[],Jp=[];function Mh(t,e=0,n=1/0){let r=Qp;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(Jp.length=t.length,r=Jp):r=Qp,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Ey(t){return t&&t[Symbol.asyncIterator]}function KM(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,u=i?i/a:0,c=Math.floor((t.length-u)/l);return(f,{index:h,target:m})=>{if(!s){const _=h*l+u;for(let p=0;p<n;p++)m[p]=t[_+p];return m}const E=s[h],w=s[h+1]||c;let S;if(o){S=new Array(w-E);for(let _=E;_<w;_++){const p=_*l+u;m=new Array(n);for(let v=0;v<n;v++)m[v]=t[p+v];S[_-E]=m}}else if(l===n)S=t.subarray(E*n+u,w*n+u);else{S=new t.constructor((w-E)*n);let _=0;for(let p=E;p<w;p++){const v=p*l+u;for(let b=0;b<n;b++)S[_++]=t[v+b]}}return S}}const QM=[],ga=[[0,1/0]];function JM(t,e){if(t===ga||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}function ku(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let u=a;for(;u<l;){const c=s(u,e);for(let f=0;f<i;f++)n[r+u]=c[f]||0,u++}}function eI({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return ku({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((c,f)=>r(c+a,f)),u=Math.min(i.length,s.length);for(let c=1;c<u;c++){const f=i[c]*n,h=s[c]*n;ku({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&ku({source:[],target:e,start:a,size:n,getData:l}),e}const tI={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function wy(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...tI[n],...e,...t,type:n}}function Ty(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function by(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Sy(t){t.push(t.shift())}function Ih(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*o}function xy({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,l=n.byteOffset,u=n.startIndices,c=i&&u,f=Ih(n,e),h=n.isConstant;if(!c&&r>=f)return;const m=h?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!h){const _=s;s=(p,v)=>n.normalizeConstant(_(p,v))}const E=h?(_,p)=>s(m,p):(_,p)=>s(m.subarray(_,_+a),p),w=t.getData({length:r}),S=new Float32Array(f);eI({source:w,target:S,sourceStartIndices:i,targetStartIndices:u,size:a,getData:E}),t.byteLength<S.byteLength+l&&t.reallocate(S.byteLength+l),t.subData({data:S,offset:l})}class Rh extends ZM{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:ga}),d(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return wy(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=JM(this.state.updateRanges,[r,i])}else this.state.updateRanges=ga}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=QM}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==ga),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[u,c]of s)o.call(i,this,{data:n,startRow:u,endRow:c,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[u,c]of s){const f=Number.isFinite(u)?this.getVertexOffset(u):0,h=Number.isFinite(c)?this.getVertexOffset(c):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;ve(ArrayBuffer.isView(o.value),"invalid ".concat(i.accessor));const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=KM(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:u,size:c,startIndices:f}=e,{accessor:h,transform:m}=a,E=l.binaryAccessor||(typeof h=="function"?h:s[h]);ve(typeof E=="function",'accessor "'.concat(h,'" is not a function'));let w=e.getVertexOffset(r);const{iterable:S,objectInfo:_}=Mh(n,r,i);for(const p of S){_.index++;let v=E(p,_);if(m&&(v=m.call(this,v)),f){const b=(_.index<f.length-1?f[_.index+1]:o)-f[_.index];if(v&&Array.isArray(v[0])){let x=w;for(const P of v)e._normalizeValue(P,u,x),x+=c}else v&&v.length>c?u.set(v,w):(e._normalizeValue(v,_.target,0),AL({target:u,source:_.target,start:w,count:b}));w+=b*c}else e._normalizeValue(v,u,w),w+=c}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class nI{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","interpolation"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.transition=new so(r),this.attribute=n,this.attributeInTransition=new Rh(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=iI(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ee(e,i),new ee(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;Sy(i);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)xy({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=Ih(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:Ty(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const rI=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function iI(t,e){const n=by(e.size);return new bh(t,{vs:rI,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class sI{constructor({gl:e,attribute:n,timeline:r}){d(this,"gl",void 0),d(this,"type","spring"),d(this,"attributeInTransition",void 0),d(this,"settings",void 0),d(this,"attribute",void 0),d(this,"transition",void 0),d(this,"currentStartIndices",void 0),d(this,"currentLength",void 0),d(this,"texture",void 0),d(this,"framebuffer",void 0),d(this,"transform",void 0),d(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new so(r),this.attribute=n,this.attributeInTransition=new Rh(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=aI(e),this.framebuffer=lI(e,this.texture),this.transform=oI(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ee(e,i),new ee(e,i),new ee(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of i)xy({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=Ih(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:Ty(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Sy(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),Tl(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function oI(t,e,n){const r=by(e.size);return new bh(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function aI(t){return new lt(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function lI(t,e){return new be(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const uI={interpolation:nI,spring:sI};class cI{constructor(e,{id:n,timeline:r}){d(this,"id",void 0),d(this,"isSupported",void 0),d(this,"gl",void 0),d(this,"timeline",void 0),d(this,"transitions",void 0),d(this,"needsRedraw",void 0),d(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=bh.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){K.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const o=uI[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(K.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const em="attributeManager.invalidate",fI="attributeManager.updateStart",hI="attributeManager.updateEnd",dI="attribute.updateStart",gI="attribute.allocate",pI="attribute.updateEnd";class mI{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){d(this,"id",void 0),d(this,"gl",void 0),d(this,"attributes",void 0),d(this,"updateTriggers",void 0),d(this,"needsRedraw",void 0),d(this,"userData",void 0),d(this,"stats",void 0),d(this,"attributeTransitionManager",void 0),d(this,"mergeBoundsMemoized",io(_L)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new cI(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ne(em,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ne(em,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ne(fI,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const c=this.attributes[u],f=c.settings.accessor;c.startIndices=r,c.numInstances=n,s[u]&&K.removed("props.".concat(u),"data.attributes.".concat(u))(),c.setExternalBuffer(o[u])||c.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&c.setConstantValue(s[f])||c.needsUpdate()&&(l=!0,this._updateAttribute({attribute:c,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||c.needsRedraw()}l&&Ne(hI,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new Rh(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ne(dI,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ne(gI,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ne(pI,n,r))}}class _I extends so{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=$a(n,r,o)}}const tm=1e-5;function nm(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function vI(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=nm(t[o],e[o],n[o],r,i);return s}return nm(t,e,n,r,i)}function rm(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class yI extends so{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=vI(s,o,n,r,i);const l=rm(a,n),u=rm(a,o);l<tm&&u<tm&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const EI={interpolation:_I,spring:yI};class wI{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:u=l.settings.fromValue}=l;n=u,this.remove(e)}if(i=wy(i),!i)return;const o=EI[i.type];if(!o){K.error("unsupported transition type '".concat(i.type,"'"))();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function TI(t){const e=t[Gn];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function bI(t,e){const n=Ay({newProps:t,oldProps:e,propTypes:t[Gn],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=xI(t,e);let i=!1;return r||(i=AI(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:PI(t,e),transitionsChanged:SI(t,e)}}function SI(t,e){if(!t.transitions)return!1;const n={},r=t[Gn];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&nf(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function Ay({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const o=nf(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=nf(t[s],e[s],r[s]);if(o)return"".concat(i,".").concat(s," ").concat(o)}}return!1}function nf(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function xI(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function AI(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&im(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&im(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function PI(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function im(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},Ay({oldProps:i,newProps:r,triggerName:n})}const CI="count(): argument not an object",LI="count(): argument not a container";function MI(t){if(!RI(t))throw new Error(CI);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(II(t))return Object.keys(t).length;throw new Error(LI)}function II(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function RI(t){return t!==null&&typeof t=="object"}function OI(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const kI={10241:9987,10240:9729,10242:33071,10243:33071},rf={};function NI(t,e,n,r){if(n instanceof lt)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const s=new lt(e,{...n,parameters:{...kI,...i,...r}});return rf[s.id]=t,s}function FI(t,e){!e||!(e instanceof lt)||rf[e.id]===t&&(e.delete(),delete rf[e.id])}const DI={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||sf(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Wt(t,e,1)}},accessor:{validate(t,e){const n=tl(t);return n==="function"||n===tl(e.value)},equal(t,e,n){return typeof e=="function"?!0:Wt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||sf(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Wt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Wt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:NI(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{FI(n.id,t)}}};function BI(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=UI(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function UI(t,e){switch(tl(e)){case"object":return Ji(t,e);case"array":return Ji(t,{type:"array",value:e,compare:!1});case"boolean":return Ji(t,{type:"boolean",value:e});case"number":return Ji(t,{type:"number",value:e});case"function":return Ji(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Ji(t,e){return"type"in e?{name:t,...DI[e.type],...e}:"value"in e?{name:t,type:tl(e.value),...e}:{name:t,type:"object",value:e}}function sf(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function tl(t){return sf(t)?"array":t===null?"null":typeof t}function zI(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=of(t.constructor,n),i=Object.create(r);i[Ja]=t,i[yr]={},i[On]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const jI="_mergedDefaultProps";function of(t,e){let n=jI;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=Py(t,n);return r||(t[n]=VI(t,e||[]))}function VI(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=of(r),s=Py(t,"defaultProps")||{},o=BI(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[Gn],o.propTypes),u=Object.assign(Object.create(null),i==null?void 0:i[Iu],o.deprecatedProps);for(const c of e){const f=of(c.constructor);f&&(Object.assign(a,f),Object.assign(l,f[Gn]),Object.assign(u,f[Iu]))}return GI(a,t),WI(a,l),HI(a,u),a[Gn]=l,a[Iu]=u,e.length===0&&!Oh(t,"_propTypes")&&(t._propTypes=l),a}function GI(t,e){const n=XI(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function HI(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])Oh(this,s)||(this[s]=r);K.deprecated(i,e[n].join("/"))()}})}function WI(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=YI(o))}t[oi]=n,t[yr]={},Object.defineProperties(t,r)}function YI(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Ey(e)?this[yr][t]=e:this[On][t]=e},get(){if(this[On]){if(t in this[On])return this[On][t]||this[oi][t];if(t in this[yr]){const e=this[Ja]&&this[Ja].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[oi][t]}}return this[oi][t]}}}function Oh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Py(t,e){return Oh(t,e)&&t[e]}function XI(t){const e=t.componentName;return e||K.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let $I=0;class kh{constructor(...e){d(this,"id",void 0),d(this,"props",void 0),d(this,"count",void 0),this.props=zI(this,e),this.id=this.props.id,this.count=$I++}clone(e){const{props:n}=this,r={};for(const i in n[oi])i in n[On]?r[i]=n[On][i]:i in n[yr]&&(r[i]=n[yr][i]);return new this.constructor({...n,...r,...e})}}d(kh,"componentName","Component");d(kh,"defaultProps",{});const qI=Object.freeze({});class ZI{constructor(e){d(this,"component",void 0),d(this,"onAsyncPropUpdated",void 0),d(this,"asyncProps",void 0),d(this,"oldProps",void 0),d(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||qI}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Ja]||this.component;const n=e[On]||{},r=e[yr]||e,i=e[oi]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(Ey(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Gn];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class KI extends ZI{constructor({attributeManager:e,layer:n}){super(n),d(this,"attributeManager",void 0),d(this,"needsRedraw",void 0),d(this,"needsUpdate",void 0),d(this,"subLayers",void 0),d(this,"usesPickingColorCache",void 0),d(this,"hasPickingBuffer",void 0),d(this,"changeFlags",void 0),d(this,"viewport",void 0),d(this,"uniformTransitions",void 0),d(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const QI="layer.changeFlag",JI="layer.initialize",e3="layer.update",t3="layer.finalize",n3="layer.matched",sm=2**24-1,r3=Object.freeze([]),i3=io(({oldViewport:t,viewport:e})=>t.equals(e));let zt=new Uint8ClampedArray(0);const s3={data:{type:"data",value:r3,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var a;i={...i,fetch:{...(a=i)===null||a===void 0?void 0:a.fetch,signal:s}}}let l=o.contains(t);return!l&&!i&&(o.add({resourceId:t,data:Va(t,r),persistent:!1}),l=!0),l?o.subscribe({resourceId:t,onChange:u=>{var c;return(c=n.internalState)===null||c===void 0?void 0:c.reloadAsyncProp(e,u)},consumerId:n.id,requestId:e}):Va(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Q.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class ao extends kh{constructor(...e){super(...e),d(this,"internalState",null),d(this,"lifecycle",Br.NO_STATE),d(this,"context",void 0),d(this,"state",void 0),d(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){ve(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=ay(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=sy(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return ve(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ve(this.internalState);const r=this.internalState.viewport||this.context.viewport;return bL(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Q.DEFAULT||e===Q.LNGLAT||e===Q.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ve(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:MI(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=OI(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,u=a||l;u&&(o&&u.constant&&(u.constant=!1,n.invalidate(u.id)),!u.value&&!o&&(u.constant=!0,u.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!i3({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(zt.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>sm&&K.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),zt=Vs.allocate(zt,n,{size:3,copy:!0,maxCount:Math.max(n,sm)});const i=Math.floor(zt.length/3),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),zt[o*3+0]=s[0],zt[o*3+1]=s[1],zt[o*3+2]=s[2]}e.value=zt.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let u=0;u<n.length;u++){const c=s.getVertexOffset(u);a[c]===l[0]&&a[c+1]===l[1]&&a[c+2]===l[2]&&this._disablePickingIndex(u)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==zt.buffer&&(r.value=zt.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ve(!this.internalState),ve(Number.isFinite(this.props.coordinateSystem)),Ne(JI,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new KI({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(K.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new wI(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ne(n3,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ne(e3,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const c of this.props.extensions)c.updateState.call(this,a,c);const u=this.getModels()[0]!==l[0];this._postUpdate(a,u)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ne(t3,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,l=a&&a(n)||[0,0];gn(s.gl,{polygonOffset:l}),Rt(s.gl,r,()=>{const u={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const c of this.props.extensions)c.draw.call(this,u,c);this.draw(u)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ne(QI,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=bI(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){TI(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new mI(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const u={};o||(u.pickingSelectedColor=null),Array.isArray(l)&&(u.pickingHighlightColor=l),(n||a!==i.highlightedObjectIndex)&&(u.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(u)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}d(ao,"defaultProps",s3);d(ao,"layerName","Layer");const o3="compositeLayer.renderLayers";class Cy extends ao{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:m,positionFormat:E,modelMatrix:w,extensions:S,fetch:_,operation:p,_subLayerProps:v}=this.props,b={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:l,autoHighlight:u,highlightColor:c,coordinateSystem:f,coordinateOrigin:h,wrapLongitude:m,positionFormat:E,modelMatrix:w,extensions:S,fetch:_,operation:p},x=v&&e.id&&v[e.id],P=x&&x.updateTriggers,L=e.id||"sublayer";if(x){const M=this.props[Gn],C=e.type?e.type._propTypes:{};for(const O in x){const U=C[O]||M[O];U&&U.type==="accessor"&&(x[O]=this.getSubLayerAccessor(x[O]))}}Object.assign(b,e,x),b.id="".concat(this.props.id,"-").concat(L),b.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...P};for(const M of S){const C=M.getSubLayerProps.call(this,M);C&&Object.assign(b,C,{updateTriggers:Object.assign(b.updateTriggers,C.updateTriggers)})}return b}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=bi(s,Boolean),this.internalState.subLayers=r}Ne(o3,this,i,r);for(const s of r)s.parent=this}}d(Cy,"layerName","CompositeLayer");const a3=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,l3=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,u3=1024,c3=4,om=()=>{},am={10241:9987,10240:9729,10242:33071,10243:33071};function f3(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function h3(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{data:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{data:t.canvas,width:s,height:o})}function Hs(t){return t&&(t.id||t.url)}function d3(t,e,n,r){const i=t.width,s=t.height,o=new lt(t.gl,{width:e,height:n,parameters:r});return Lx(t,o,{targetY:0,width:i,height:s}),t.delete(),o}function lm(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=Hs(i);t[o]={...i,x:s,y:n}}}function g3({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const u=t[l],c=Hs(u);if(!n[c]){const{height:f,width:h}=u;r+h+e>o&&(lm(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:u,xOffset:r}),r=r+h+e,s=Math.max(s,f)}}return a.length>0&&lm(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:f3(s+i+e)}}function p3(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Mh(t);for(const o of i){s.index++;const a=e(o,s),l=Hs(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class m3{constructor(e,{onUpdate:n=om,onError:r=om}){d(this,"gl",void 0),d(this,"onUpdate",void 0),d(this,"onError",void 0),d(this,"_loadOptions",null),d(this,"_texture",null),d(this,"_externalTexture",null),d(this,"_mapping",{}),d(this,"_textureParameters",null),d(this,"_pendingCount",0),d(this,"_autoPacking",!1),d(this,"_xOffset",0),d(this,"_yOffset",0),d(this,"_rowHeight",0),d(this,"_buffer",c3),d(this,"_canvasWidth",u3),d(this,"_canvasHeight",0),d(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Hs(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(p3(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=g3({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=new lt(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||am})),this._texture.height!==this._canvasHeight&&(this._texture=d3(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||am)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Va(r.url,this._loadOptions).then(i=>{const s=Hs(r),o=this._mapping[s],{x:a,y:l,width:u,height:c}=o,{data:f,width:h,height:m}=h3(n,i,u,c);this._texture.setSubImageData({data:f,x:a+(u-h)/2,y:l+(c-m)/2,width:h,height:m}),o.width=h,o.height=m,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const Ly=[0,0,0,255],_3={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:Ly},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class ai extends ao{constructor(...e){super(...e),d(this,"state",void 0)}getShaders(){return super.getShaders({vs:a3,fs:l3,modules:[cy,fy]})}initializeState(){this.state={iconManager:new m3(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Ly},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:u,textureParameters:c}=n,{iconManager:f}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(f.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:c}),h?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(l,u),i.extensionsChanged){var m;const{gl:E}=this.context;(m=this.state.model)===null||m===void 0||m.delete(),this.state.model=this._getModel(E),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,u=l.getTexture();u&&this.state.model.setUniforms(e).setUniforms({iconsTexture:u,iconsTextureDim:[u.width,u.height],sizeUnits:Wa[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Th(e,{...this.getShaders(),id:this.props.id,geometry:new qv({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):K.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}d(ai,"defaultProps",_3);d(ai,"layerName","IconLayer");const v3=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Nu=192/256,um=[],y3={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class Nh extends ai{constructor(...e){super(...e),d(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:v3}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&K.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,Nu*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Nu,outlineBuffer:o,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state;a.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Nu}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):um}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):um}}d(Nh,"defaultProps",y3);d(Nh,"layerName","MultiIconLayer");const vs=1e20;class E3{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const l=this.size=e+n*4,u=this._createCanvas(l),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font=`${a} ${o} ${e}px ${s}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),l=0,u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),c=Math.min(this.size-this.buffer,a+Math.ceil(i)),f=u+2*this.buffer,h=c+2*this.buffer,m=Math.max(f*h,0),E=new Uint8ClampedArray(m),w={data:E,width:f,height:h,glyphWidth:u,glyphHeight:c,glyphTop:a,glyphLeft:l,glyphAdvance:n};if(u===0||c===0)return w;const{ctx:S,buffer:_,gridInner:p,gridOuter:v}=this;S.clearRect(_,_,u,c),S.fillText(e,_,_+a);const b=S.getImageData(_,_,u,c);v.fill(vs,0,m),p.fill(0,0,m);for(let x=0;x<c;x++)for(let P=0;P<u;P++){const L=b.data[4*(x*u+P)+3]/255;if(L===0)continue;const M=(x+_)*f+P+_;if(L===1)v[M]=0,p[M]=vs;else{const C=.5-L;v[M]=C>0?C*C:0,p[M]=C<0?C*C:0}}cm(v,0,0,f,h,f,this.f,this.v,this.z),cm(p,_,_,u,c,f,this.f,this.v,this.z);for(let x=0;x<m;x++){const P=Math.sqrt(v[x])-Math.sqrt(p[x]);E[x]=Math.round(255-255*(P/this.radius+this.cutoff))}return w}}function cm(t,e,n,r,i,s,o,a,l){for(let u=e;u<e+r;u++)fm(t,n*s+u,s,i,o,a,l);for(let u=n;u<n+i;u++)fm(t,u*s+e,1,r,o,a,l)}function fm(t,e,n,r,i,s,o){s[0]=0,o[0]=-vs,o[1]=vs,i[0]=t[e];for(let a=1,l=0,u=0;a<r;a++){i[a]=t[e+a*n];const c=a*a;do{const f=s[l];u=(i[a]-i[f]+c-f*f)/(a-f)/2}while(u<=o[l]&&--l>-1);l++,s[l]=a,o[l]=u,o[l+1]=vs}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const u=s[l],c=a-u;t[e+a*n]=i[u]+c*c}}const w3=32,T3=[];function b3(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function S3({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,u=o;const c=n+r*2;for(const f of t)if(!s[f]){const h=e(f);u+h+r*2>i&&(u=0,l++),s[f]={x:u+r,y:a+l*c+r,width:h,height:c,layoutWidth:h,layoutHeight:n},u+=h+r*2}return{mapping:s,xOffset:u,yOffset:a+l*c,canvasHeight:b3(a+(l+1)*c)}}function My(t,e,n,r){let i=0;for(let o=e;o<n;o++){var s;const a=t[o];i+=((s=r[a])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function Iy(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const u=My(t,l,l+1,i);a+u>r&&(o<l&&s.push(l),o=l,a=0),a+=u}return a}function x3(t,e,n,r,i,s){let o=e,a=e,l=e,u=0;for(let c=e;c<n;c++)if((t[c]===" "||t[c+1]===" "||c+1===n)&&(l=c+1),l>a){let f=My(t,a,l,i);u+f>r&&(o<a&&(s.push(a),o=a,u=0),f>r&&(f=Iy(t,a,l,r,i,s),o=s[s.length-1])),a=l,u+=f}return u}function A3(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?Iy(t,i,s,n,r,o):x3(t,i,s,n,r,o),o}function P3(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const u=t[l],c=r[u];c?(a||(a=c.layoutHeight),i[l]=o+c.layoutWidth/2,o+=c.layoutWidth):(K.warn("Missing character: ".concat(u," (").concat(u.codePointAt(0),")"))(),i[l]=o,o+=w3)}s[0]=o,s[1]=a}function C3(t,e,n,r,i){const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),u=new Array(o),c=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],h=[0,0];let m=0,E=0,w=0;for(let _=0;_<=o;_++){const p=s[_];if((p===`
`||_===o)&&(w=_),w>E){const v=c?A3(s,n,r,i,E,w):T3;for(let b=0;b<=v.length;b++){const x=b===0?E:v[b-1],P=b<v.length?v[b]:w;P3(s,x,P,i,a,h);for(let L=x;L<P;L++){var S;const M=s[L],C=((S=i[M])===null||S===void 0?void 0:S.layoutOffsetY)||0;l[L]=m+h[1]/2+C,u[L]=h[0]}m=m+h[1]*e,f[0]=Math.max(f[0],h[0])}E=w}p===`
`&&(a[E]=0,l[E]=0,u[E]=0,E++)}return f[1]=m,{x:a,y:l,rowWidth:u,size:f}}function L3({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,u=i[e]||Math.ceil((t.length-l)/a),c=s&&new Set,f=new Array(e);let h=t;if(a>1||l>0){const m=t.constructor;h=new m(u);for(let E=0;E<u;E++)h[E]=t[E*a+l]}for(let m=0;m<e;m++){const E=i[m],w=i[m+1]||u,S=h.subarray(E,w);f[m]=String.fromCodePoint.apply(null,S),c&&S.forEach(c.add,c)}if(c)for(const m of c)s.add(String.fromCodePoint(m));return{texts:f,characterCount:u}}class Ry{constructor(e=5){d(this,"limit",void 0),d(this,"_cache",{}),d(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function M3(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const li={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:M3(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},hm=1024,dm=.9,gm=1.2,Oy=3;let nl=new Ry(Oy);function I3(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=nl.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function R3(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function pm(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function O3(t){K.assert(Number.isFinite(t)&&t>=Oy,"Invalid cache limit"),nl=new Ry(t)}class k3{constructor(){d(this,"props",{...li}),d(this,"_key",void 0),d(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*gm+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=I3(this._key,this.props.characterSet),r=nl.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,nl.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:l,cutoff:u}=this.props;let c=n&&n.data;c||(c=document.createElement("canvas"),c.width=hm);const f=c.getContext("2d",{willReadFrequently:!0});pm(f,r,s,i);const{mapping:h,canvasHeight:m,xOffset:E,yOffset:w}=S3({getFontWidth:S=>f.measureText(S).width,fontHeight:s*gm,buffer:o,characterSet:e,maxCanvasWidth:hm,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(c.height!==m){const S=f.getImageData(0,0,c.width,c.height);c.height=m,f.putImageData(S,0,0)}if(pm(f,r,s,i),a){const S=new E3({fontSize:s,buffer:o,radius:l,cutoff:u,fontFamily:r,fontWeight:"".concat(i)});for(const _ of e){const{data:p,width:v,height:b,glyphTop:x}=S.draw(_);h[_].width=v,h[_].layoutOffsetY=s*dm-x;const P=f.createImageData(v,b);R3(p,P),f.putImageData(P,h[_].x,h[_].y)}}else for(const S of e)f.fillText(S,h[S].x,h[S].y+o+s*dm);return{xOffset:E,yOffset:w,mapping:h,data:c,width:c.width,height:c.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const N3=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,F3=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,D3={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Fh extends ao{constructor(...e){super(...e),d(this,"state",void 0)}getShaders(){return super.getShaders({vs:N3,fs:F3,modules:[cy,fy]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!a,padding:l,sizeUnits:Wa[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Th(e,{...this.getShaders(),id:this.props.id,geometry:new qv({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}d(Fh,"defaultProps",D3);d(Fh,"layerName","TextBackgroundLayer");const mm={start:1,middle:0,end:-1},_m={top:1,center:0,bottom:-1},Fu=[0,0,0,255],B3=1,U3={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Fu},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:li.characterSet},fontFamily:li.fontFamily,fontWeight:li.fontWeight,lineHeight:B3,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Fu},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Fu},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Dh extends Cy{constructor(...e){super(...e),d(this,"state",void 0),d(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:o}=this.state.fontAtlasManager.props;i/=o,s/=o;const{getTextAnchor:a,getAlignmentBaseline:l}=this.props,u=mm[typeof a=="function"?a(n,r):a],c=_m[typeof l=="function"?l(n,r):l];return[(u-1)*i/2,(c-1)*s/2,i,s]}),d(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:o,y:a,rowWidth:l,size:[u,c]}=this.transformParagraph(n,r),f=mm[typeof i=="function"?i(n,r):i],h=_m[typeof s=="function"?s(n,r):s],m=o.length,E=new Array(m*2);let w=0;for(let S=0;S<m;S++){const _=(1-f)*(u-l[S])/2;E[w++]=(f-1)*u/2+_+o[S],E[w++]=(h-1)*c/2+a[S]}return E})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new k3},this.props.maxWidth>0&&K.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const l=r==="auto"&&new Set;if(i&&o){const{texts:u,characterCount:c}=L3({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:o,characterSet:l});a=c,s=(f,{index:h})=>u[h]}else{const{iterable:u,objectInfo:c}=Mh(n);o=[0],a=0;for(const f of u){c.index++;const h=Array.from(s(f,c)||"");l&&h.forEach(l.add,l),a+=h.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:l||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:l}=this.props,u=s(e,n)||"";return C3(u,a,o,l*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:u,getPosition:c,getColor:f,getSize:h,getAngle:m,getPixelOffset:E,getBackgroundColor:w,getBorderColor:S,getBorderWidth:_,backgroundPadding:p,background:v,billboard:b,fontSettings:x,outlineWidth:P,outlineColor:L,sizeScale:M,sizeUnits:C,sizeMinPixels:O,sizeMaxPixels:U,transitions:H,updateTriggers:G}=this.props,q=this.getSubLayerClass("characters",Nh),Tt=this.getSubLayerClass("background",Fh);return[v&&new Tt({getFillColor:w,getLineColor:S,getLineWidth:_,padding:p,getPosition:c,getSize:h,getAngle:m,getPixelOffset:E,billboard:b,sizeScale:M,sizeUnits:C,sizeMinPixels:O,sizeMaxPixels:U,transitions:H&&{getPosition:H.getPosition,getAngle:H.getAngle,getSize:H.getSize,getFillColor:H.getBackgroundColor,getLineColor:H.getBorderColor,getLineWidth:H.getBorderWidth,getPixelOffset:H.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:G.getPosition,getAngle:G.getAngle,getSize:G.getSize,getFillColor:G.getBackgroundColor,getLineColor:G.getBorderColor,getLineWidth:G.getBorderWidth,getPixelOffset:G.getPixelOffset,getBoundingRect:{getText:G.getText,getTextAnchor:G.getTextAnchor,getAlignmentBaseline:G.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:u,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new q({sdf:x.sdf,smoothing:Number.isFinite(x.smoothing)?x.smoothing:li.smoothing,outlineWidth:P/(x.radius||li.radius),outlineColor:L,iconAtlas:s,iconMapping:o,getPosition:c,getColor:f,getSize:h,getAngle:m,getPixelOffset:E,billboard:b,sizeScale:M*i,sizeUnits:C,sizeMinPixels:O*i,sizeMaxPixels:U*i,transitions:H&&{getPosition:H.getPosition,getAngle:H.getAngle,getColor:H.getColor,getSize:H.getSize,getPixelOffset:H.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:G.getText,getPosition:G.getPosition,getAngle:G.getAngle,getColor:G.getColor,getSize:G.getSize,getPixelOffset:G.getPixelOffset,getIconOffsets:{getTextAnchor:G.getTextAnchor,getAlignmentBaseline:G.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:u,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){O3(e)}}d(Dh,"defaultProps",U3);d(Dh,"layerName","TextLayer");const Du=512,z3=Math.PI/180;function ky({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n==null?void 0:n.props._customRender,i=n==null?void 0:n.props.onLoad,s=Fy({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),r==null||r("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:Ws(t)}),n!=null&&n.isInitialized?vm(n,t):s.onLoad=()=>{i==null||i(),vm(o,t)}),n?(o=n,n.setProps(s),n.userData.isExternal=!0):(o=new Gs(s),t.on("remove",()=>{Ny(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&Y3(o,t)}),o}function vm(t,e){const n=()=>{t.isInitialized?X3(t,e):e.off("move",n)};e.on("move",n)}function Ny(t){var e;(e=t.__deck)===null||e===void 0||e.finalize(),t.__deck=null}function Fy(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new Ch({id:"mapbox"})]}}function j3(t,e){t.userData.mapboxLayers.add(e),Bh(t)}function V3(t,e){t.userData.mapboxLayers.delete(e),Bh(t)}function G3(t,e){Bh(t)}function H3(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=Dy(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Ws(t){var e;const{lng:n,lat:r}=t.getCenter(),i={longitude:(n+540)%360-180,latitude:r,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(e=t.getTerrain)!==null&&e!==void 0&&e.call(t)&&W3(t,i),i}function W3(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:o}=e,a=n.x*Du,l=(1-n.y)*Du,u=n.z*Du,c=js([i,s]),f=a-c[0],h=l-c[1],m=Math.sqrt(f*f+h*h),E=o*z3,w=1.5*r,S=E<.001?w*Math.cos(E)/u:w*Math.sin(E)/m;e.zoom=Math.log2(S);const _=w*Math.cos(E)/S,p=u-_;e.position=[0,0,p/ha(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function Dy(t,e,n=!0){return new vr({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...Ws(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function Y3(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,c=>c.id),o=bi(t.props.layers,Boolean).some(c=>c&&!i.includes(c.id));let a=t.getViewports();const l=a.findIndex(c=>c.id==="mapbox"),u=a.length>1||l<0;(o||u)&&(l>=0&&(a=a.slice(),a[l]=Dy(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:c=>(!t.props.layerFilter||t.props.layerFilter(c))&&(c.viewport.id!=="mapbox"||!i.includes(c.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function X3(t,e){t.setProps({viewState:Ws(e)}),t.needsRedraw({clearRedrawFlags:!0})}function Bh(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class $3{constructor(e){if(d(this,"id",void 0),d(this,"type",void 0),d(this,"renderingMode",void 0),d(this,"map",void 0),d(this,"deck",void 0),d(this,"props",void 0),!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=ky({map:e,gl:n,deck:this.props.deck}),j3(this.deck,this)}onRemove(){this.deck&&V3(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&G3(this.deck)}render(){H3(this.deck,this.map,this)}}const Bu="__UNDEFINED__";function $o(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=bi(r,Boolean);if(n!==r){const a=bi(n,Boolean),l=new Set(a.map(u=>u.id));for(const u of i)l.delete(u.id);for(const u of l)t.getLayer(u)&&t.removeLayer(u)}for(const a of i){const l=t.getLayer(a.id);l?l.implementation.setProps(a.props):t.addLayer(new $3({id:a.id,deck:e}),a.props.beforeId)}const s=t.style._order,o={};for(const a of i){let{beforeId:l}=a.props;(!l||!s.includes(l))&&(l=Bu),o[l]=o[l]||[],o[l].push(a.id)}for(const a in o){const l=o[a];let u=a===Bu?s.length:s.indexOf(a),c=a===Bu?void 0:a;for(let f=l.length-1;f>=0;f--){const h=l[f],m=s.indexOf(h);m!==u-1&&(t.moveLayer(h,c),m>u&&u++),u--,c=h}}}class q3{constructor(e){d(this,"_props",void 0),d(this,"_deck",void 0),d(this,"_map",void 0),d(this,"_container",void 0),d(this,"_interleaved",void 0),d(this,"_lastMouseDownPoint",void 0),d(this,"_handleStyleChange",()=>{$o(this._map,this._deck,this._props.layers,this._props.layers)}),d(this,"_updateContainerSize",()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:"".concat(i,"px"),height:"".concat(s,"px")})}}),d(this,"_updateViewState",()=>{const i=this._deck;i&&(i.setProps({viewState:Ws(this._map)}),i.isInitialized&&i.redraw())}),d(this,"_handleMouseEvent",i=>{const s=this._deck;if(!s||!s.isInitialized)return;const o={type:i.type,offsetCenter:i.point,srcEvent:i},a=this._lastMouseDownPoint;switch(!i.point&&a&&(o.deltaX=i.originalEvent.clientX-a.clientX,o.deltaY=i.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":s._onPointerDown(o),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":o.type="panstart",s._onEvent(o);break;case"drag":o.type="panmove",s._onEvent(o);break;case"dragend":o.type="panend",s._onEvent(o);break;case"click":o.tapCount=1,s._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,s._onEvent(o);break;case"mousemove":o.type="pointermove",s._onPointerMove(o);break;case"mouseout":o.type="pointerleave",s._onPointerMove(o);break;default:return}});const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&$o(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?Fy(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,pointerEvents:"none"}),this._container=n,this._deck=new Gs({...this._props,parent:n,viewState:Ws(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){return this._deck=ky({map:e,gl:e.painter.context.gl,deck:new Gs({...this._props,gl:e.painter.context.gl})}),e.on("styledata",this._handleStyleChange),$o(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)===null||n===void 0||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),$o(e,this._deck,this._props.layers,[]),Ny(e)}getDefaultPosition(){return"top-left"}pickObject(e){return ve(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return ve(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return ve(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}const Z3="modulepreload",K3=function(t){return"/"+t},ym={},Q3=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=K3(s),s in ym)return;ym[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=i.length-1;c>=0;c--){const f=i[c];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":Z3,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((c,f)=>{u.addEventListener("load",c),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},J3=N.createContext(null);function eR(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function sn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!sn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!sn(t[i],e[i]))return!1;return!0}return!1}function tR(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function Em(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();sn(n,r)||e.setProjection(n)}function wm(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Tm(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const nR=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function bm(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of nR)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const Sm={version:8,sources:{},layers:[]},xm={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Uu={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Am={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},rR=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],iR=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Si{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[Am[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[xm[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Uu[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Si.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=Sm}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||sR()||null,container:e,style:bm(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=c=>{this._inRender=!0,a.call(o,c),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=c=>{l.call(o._renderTaskQueue,c),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const u=o.fire;o.fire=this._fireEvent.bind(this,u),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),Em(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const c in xm)o.on(c,this._onPointerEvent);for(const c in Uu)o.on(c,this._onCameraEvent);for(const c in Am)o.on(c,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Si.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=tR(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const u=Tm(i,{...wm(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),u&&n){const c=this._deferredEvents;c.move=!0,c.zoom||(c.zoom=s!==i.zoom),c.rotate||(c.rotate=a!==i.bearing),c.pitch||(c.pitch=o!==i.pitch)}return l||Tm(r.transform,e),u}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of rR)if(s in e&&!sn(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=Sm,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(bm(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!sn(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!sn(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!sn(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of iR){const l=(r=e[a])!==null&&r!==void 0?r:!0,u=(i=n[a])!==null&&i!==void 0?i:!0;sn(l,u)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in Uu&&(typeof n=="object"&&(n.viewState=wm(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{Em(this._renderTransform,n),e.transform=n}}}Si.savedMaps=[];function sR(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const oR=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function aR(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of lR(e))!(r in n)&&!oR.includes(r)&&(n[r]=e[r].bind(e));return n}function lR(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const uR=typeof document<"u"?N.useLayoutEffect:N.useEffect,cR=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function fR(t,e){for(const r of cR)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const Sl=N.createContext(null);function hR(t,e,n){const r=N.useContext(J3),[i,s]=N.useState(null),o=N.useRef(),{current:a}=N.useRef({mapLib:null,map:null});N.useEffect(()=>{const c=t.mapLib;let f=!0,h;return Promise.resolve(c||n).then(m=>{if(!f)return;if(!m)throw new Error("Invalid mapLib");const E="Map"in m?m:m.default;if(!E.Map)throw new Error("Invalid mapLib");if(fR(E,t),!E.supported||E.supported(t))t.reuseMaps&&(h=Si.reuse(t,o.current)),h||(h=new Si(E.Map,t,o.current)),a.map=aR(h),a.mapLib=E,s(h),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(m=>{const{onError:E}=t;E?E({type:"error",target:null,originalEvent:null,error:m}):console.error(m)}),()=>{f=!1,h&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),uR(()=>{i&&i.setProps(t)}),N.useImperativeHandle(e,()=>a.map,[i]);const l=N.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),u={height:"100%"};return N.createElement("div",{id:t.id,ref:o,style:l},i&&N.createElement(Sl.Provider,{value:a},N.createElement("div",{"mapboxgl-children":"",style:u},t.children)))}const dR=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function xr(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!dR.test(r)?n[r]=`${i}px`:n[r]=i}}function gR(t,e){const{map:n,mapLib:r}=N.useContext(Sl),i=N.useRef({props:t});i.current.props=t;const s=N.useMemo(()=>{let w=!1;N.Children.forEach(t.children,p=>{p&&(w=!0)});const S={...t,element:w?document.createElement("div"):null},_=new r.Marker(S);return _.setLngLat([t.longitude,t.latitude]),_.getElement().addEventListener("click",p=>{var v,b;(b=(v=i.current.props).onClick)===null||b===void 0||b.call(v,{type:"click",target:_,originalEvent:p})}),_.on("dragstart",p=>{var v,b;const x=p;x.lngLat=s.getLngLat(),(b=(v=i.current.props).onDragStart)===null||b===void 0||b.call(v,x)}),_.on("drag",p=>{var v,b;const x=p;x.lngLat=s.getLngLat(),(b=(v=i.current.props).onDrag)===null||b===void 0||b.call(v,x)}),_.on("dragend",p=>{var v,b;const x=p;x.lngLat=s.getLngLat(),(b=(v=i.current.props).onDragEnd)===null||b===void 0||b.call(v,x)}),_},[]);N.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:u,draggable:c=!1,popup:f=null,rotation:h=0,rotationAlignment:m="auto",pitchAlignment:E="auto"}=t;return N.useEffect(()=>{xr(s.getElement(),u)},[u]),N.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!eR(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==c&&s.setDraggable(c),s.getRotation()!==h&&s.setRotation(h),s.getRotationAlignment()!==m&&s.setRotationAlignment(m),s.getPitchAlignment()!==E&&s.setPitchAlignment(E),s.getPopup()!==f&&s.setPopup(f),nh.createPortal(t.children,s.getElement())}N.memo(N.forwardRef(gR));function Pm(t){return new Set(t?t.trim().split(/\s+/):[])}function pR(t,e){const{map:n,mapLib:r}=N.useContext(Sl),i=N.useMemo(()=>document.createElement("div"),[]),s=N.useRef({props:t});s.current.props=t;const o=N.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",u=>{var c,f;(f=(c=s.current.props).onOpen)===null||f===void 0||f.call(c,u)}),l},[]);if(N.useEffect(()=>{const a=l=>{var u,c;(c=(u=s.current.props).onClose)===null||c===void 0||c.call(u,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),N.useEffect(()=>{xr(o.getElement(),t.style)},[t.style]),N.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!sn(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=Pm(o.options.className),l=Pm(t.className);for(const u of a)l.has(u)||o.removeClassName(u);for(const u of l)a.has(u)||o.addClassName(u);o.options.className=t.className}return nh.createPortal(t.children,i)}N.memo(N.forwardRef(pR));function Li(t,e,n,r){const i=N.useContext(Sl),s=N.useMemo(()=>t(i),[]);return N.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:u}=i;return u.hasControl(s)||(u.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),u.hasControl(s)&&u.removeControl(s)}},[]),s}function mR(t){const e=Li(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return N.useEffect(()=>{xr(e._container,t.style)},[t.style]),null}const _R=N.memo(mR);function vR(t){const e=Li(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return N.useEffect(()=>{xr(e._controlContainer,t.style)},[t.style]),null}N.memo(vR);function yR(t,e){const n=N.useRef({props:t}),r=Li(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,u;(u=(l=n.current.props).onGeolocate)===null||u===void 0||u.call(l,a)}),s.on("error",a=>{var l,u;(u=(l=n.current.props).onError)===null||u===void 0||u.call(l,a)}),s.on("outofmaxbounds",a=>{var l,u;(u=(l=n.current.props).onOutOfMaxBounds)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationStart)===null||u===void 0||u.call(l,a)}),s.on("trackuserlocationend",a=>{var l,u;(u=(l=n.current.props).onTrackUserLocationEnd)===null||u===void 0||u.call(l,a)}),s},{position:t.position});return n.current.props=t,N.useImperativeHandle(e,()=>r,[]),N.useEffect(()=>{xr(r._container,t.style)},[t.style]),null}N.memo(N.forwardRef(yR));function ER(t){const e=Li(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return N.useEffect(()=>{xr(e._container,t.style)},[t.style]),null}const wR=N.memo(ER);function TR(t){const e=Li(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=N.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),N.useEffect(()=>{xr(e._container,i)},[i]),null}const bR=N.memo(TR),SR=Q3(()=>import("./maplibre-gl-2fd569d8.js").then(t=>t.m),[]),xR=(()=>N.forwardRef(function(e,n){return hR(e,n,SR)}))(),AR=_R,PR=wR,CR=bR;function LR(t){return N.useEffect(()=>{let e="";return e=new WebSocket("ws://localhost:8765"),e.onopen=()=>{console.log("Websocket OPEN"),t.setWebSocket(!0),e.send=()=>{}},e.onmessage=n=>{const r=JSON.parse(n.data);t.setPlanes(r.planes),r.adsb&&t.setReceiver(r.adsb.connection),r.virtual_points&&t.setVirtualPoints(r.virtual_points)},e.onerror=n=>{console.log("error:"),console.log(n)},e.onclose=n=>{console.log("Websocket closed"),console.log(n),t.setWebSocket(!1),t.setReceiver(!1)},()=>{console.log("component unmounted, closing WebSocket"),e&&e.close()}},[]),null}const MR=({webSocket:t,receiver:e})=>z.jsxs("div",{className:"status-text",children:[z.jsxs("p",{children:["Websocket: ",t?"CONNECTED":"DISCONNECTED"]}),z.jsxs("p",{children:["Receiver: ",e?"CONNECTED":"NO CONNECTION"]})]});const Cm=(t,e)=>Number(t.toFixed(e)),IR=({obj:t,type:e})=>{let n="";return e=="plane"?n=z.jsxs("div",{className:"list-container",children:[z.jsxs("ul",{className:"list-items",children:[z.jsx("li",{children:z.jsx("strong",{children:"ID:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Flight:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Latitude:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Longitude:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Altitude:"})}),z.jsx("li",{children:z.jsx("strong",{children:"V/S:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Heading:"})})]}),z.jsxs("ul",{className:"list-items",children:[z.jsx("li",{children:t.id}),z.jsx("li",{children:t.flight}),z.jsx("li",{children:Cm(t.coordinates[0],3)}),z.jsx("li",{children:Cm(t.coordinates[1],3)}),z.jsx("li",{children:t.altitude}),z.jsx("li",{children:t.velocity[2]}),z.jsx("li",{children:t.heading})]})]}):e=="virtualPoint"&&(console.log("virtualpoint"),n=z.jsxs("div",{className:"list-container",children:[z.jsxs("ul",{className:"list-items-virtualpoint",children:[z.jsx("li",{children:z.jsx("strong",{children:"ID:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Lat:"})}),z.jsx("li",{children:z.jsx("strong",{children:"Lon:"})})]}),z.jsxs("ul",{className:"list-items",children:[z.jsx("li",{children:t.id}),z.jsx("li",{children:t.position[0]}),z.jsx("li",{children:t.position[1]})]})]})),n};const RR=({iconInfo:t,setIconInfo:e,planes:n,virtualPoints:r})=>{const[i,s]=N.useState(!1),[o,a]=N.useState("");let l=N.useRef();return N.useEffect(()=>{const u=c=>{l.current&&!l.current.contains(c.target)&&(s(!1),e(!1))};return Object.keys(t).length!==0&&(document.addEventListener("click",u),s(!0)),()=>{document.removeEventListener("click",u)}},[t]),N.useEffect(()=>{if(i){let u="",c="";t.hasOwnProperty("flight")&&n?(u=n.find(f=>f.id===t.id),c="plane"):t.hasOwnProperty("position")&&r&&(u=r.find(f=>f.id===t.id),c="virtualPoint"),a(u?z.jsx(IR,{obj:u,type:c}):z.jsx("div",{children:z.jsx("h2",{children:"No data"})}))}},[t,n]),z.jsx("div",{children:i&&z.jsx(z.Fragment,{children:z.jsx("div",{className:"content",ref:l,children:o})})})};function OR(t){return Li(()=>new q3(t)).setProps(t),null}function kR(){const[t,e]=N.useState({longitude:23.7601,latitude:61.498,zoom:11,dragRotate:!1,touchRotate:!1,keyboard:!1}),[n,r]=N.useState(50),[i,s]=N.useState(15),[o,a]=N.useState([0,-30]),[l,u]=N.useState(!1),[c,f]=N.useState(!1),[h,m]=N.useState([]),[E,w]=N.useState([]),[S,_]=N.useState([]),[p,v]=N.useState({}),b=new ai({id:"plane-layer",data:h,pickable:!0,onClick:C=>{v(C.object)},iconAtlas:"airplane.svg",iconMapping:{marker:{x:0,y:0,width:800,height:800,mask:!0}},getIcon:C=>"marker",getPosition:C=>[C.coordinates[1],C.coordinates[0]],getAngle:C=>C.heading,getSize:C=>n,getColor:C=>[255,255,0],updateTriggers:{getSize:n}}),x=new Dh({id:"plane-id-layer",data:h,pickable:!0,background:!0,getPosition:C=>[C.coordinates[1],C.coordinates[0]],getPixelOffset:o,getText:C=>C.id,getSize:C=>i,updateTriggers:{getSize:i,getTextOffset:o}}),P=new ai({id:"receiver-point",data:S,pickable:!0,onClick:C=>{v(C.object)},iconAtlas:"receiver.svg",iconMapping:{marker:{x:0,y:0,width:800,height:800,mask:!0}},getIcon:C=>"marker",getPosition:C=>[C.coordinates[1],C.coordinates[0]],getSize:C=>n,getColor:C=>[0,0,0],updateTriggers:{getSize:n}}),L=new ai({id:"virtual-point-layer",data:E,pickable:!0,onClick:C=>{v(C.object)},iconAtlas:"virtualPoint.svg",iconMapping:{marker:{x:0,y:0,width:800,height:800,mask:!0}},getIcon:C=>"marker",getPosition:C=>[C.position[1],C.position[0]],getSize:C=>n,getColor:C=>[0,0,0],updateTriggers:{getSize:n}}),M=C=>{C>=9?(r(48),s(14),a([0,-28])):C>=8&&C<9?(r(45),s(14),a([0,-27])):C>=7&&C<8?(r(40),s(12),a([0,-23])):C>=6&&C<7?(r(30),s(10),a([0,-16])):C>=5&&C<6?(r(25),s(0)):C<5&&(r(20),s(0))};return z.jsxs(z.Fragment,{children:[z.jsx(LR,{setWebSocket:u,setReceiver:f,setPlanes:m,planes:h,setVirtualPoints:w,virtualPoints:E}),z.jsxs(xR,{initialViewState:t,onMove:C=>e(C.viewState),onZoom:()=>{M(t.zoom)},mapStyle:"style.json",RTLTextPlugin:null,style:{position:"absolute",top:0,bottom:0,left:0,width:"100%"},children:[z.jsx(PR,{position:"top-right",showCompass:!1}),z.jsx(CR,{position:"bottom-right"}),z.jsx(AR,{customAttribution:"© OpenMapTiles © OpenStreetMap contributors",position:"bottom-left"}),z.jsx(OR,{layers:[b,x,L,P]})]}),z.jsx(NR,{webSocket:l,receiver:c}),z.jsx(FR,{iconInfo:p,setIconInfo:v,planes:h,virtualPoints:E})]})}const NR=ff.memo(MR),FR=ff.memo(RR);zu.createRoot(document.getElementById("root")).render(z.jsx(ff.StrictMode,{children:z.jsx(kR,{})}));export{DR as c,Lm as g};
